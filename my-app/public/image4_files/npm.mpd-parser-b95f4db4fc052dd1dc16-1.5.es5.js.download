/*! For license information please see npm.mpd-parser-b95f4db4fc052dd1dc16-1.5.es5.js.LICENSE.txt */
"use strict";(self["webpackChunkFutureLearn"]=self["webpackChunkFutureLearn"]||[]).push([["npm.mpd-parser"],{hIRe:(t,e,r)=>{r.d(e,{LG:()=>Mt,Qc:()=>Nt,jp:()=>N,mm:()=>B});var n=r("Y+wj");var i=r("vgmO");var a=r.n(i);var u=r("aZTK");var s=r("/9/d");var o=r("IQtQ");var c=function(t){return!!t&&"object"===typeof t};var f=function t(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.reduce((function(e,r){if("object"!==typeof r)return e;Object.keys(r).forEach((function(n){if(Array.isArray(e[n])&&Array.isArray(r[n]))e[n]=e[n].concat(r[n]);else if(c(e[n])&&c(r[n]))e[n]=t(e[n],r[n]);else e[n]=r[n]}));return e}),{})};var v=function(t){return Object.keys(t).map((function(e){return t[e]}))};var d=function(t,e){var r=[];for(var n=t;n<e;n++)r.push(n);return r};var l=function(t){return t.reduce((function(t,e){return t.concat(e)}),[])};var m=function(t){if(!t.length)return[];var e=[];for(var r=0;r<t.length;r++)e.push(t[r]);return e};var p=function(t,e){return t.reduce((function(t,r,n){if(r[e])t.push(n);return t}),[])};var g=function(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r;return-1};var b=function(t,e){return v(t.reduce((function(t,r){r.forEach((function(r){t[e(r)]=r}));return t}),{}))};var h={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};var S=function(t){var e=t.baseUrl,r=void 0===e?"":e,i=t.source,u=void 0===i?"":i,s=t.range,o=void 0===s?"":s,c=t.indexRange,f=void 0===c?"":c;var v={uri:u,resolvedUri:(0,n.Z)(r||"",u)};if(o||f){var d=o?o:f;var l=d.split("-");var m=a().BigInt?a().BigInt(l[0]):parseInt(l[0],10);var p=a().BigInt?a().BigInt(l[1]):parseInt(l[1],10);if(m<Number.MAX_SAFE_INTEGER&&"bigint"===typeof m)m=Number(m);if(p<Number.MAX_SAFE_INTEGER&&"bigint"===typeof p)p=Number(p);var g;if("bigint"===typeof p||"bigint"===typeof m)g=a().BigInt(p)-a().BigInt(m)+a().BigInt(1);else g=p-m+1;if("bigint"===typeof g&&g<Number.MAX_SAFE_INTEGER)g=Number(g);v.byterange={length:g,offset:m}}return v};var y=function(t){var e;if("bigint"===typeof t.offset||"bigint"===typeof t.length)e=a().BigInt(t.offset)+a().BigInt(t.length)-a().BigInt(1);else e=t.offset+t.length-1;return t.offset+"-"+e};var I=function(t){if(t&&"number"!==typeof t)t=parseInt(t,10);if(isNaN(t))return null;return t};var E={static:function(t){var e=t.duration,r=t.timescale,n=void 0===r?1:r,i=t.sourceDuration,a=t.periodDuration;var u=I(t.endNumber);var s=e/n;if("number"===typeof u)return{start:0,end:u};if("number"===typeof a)return{start:0,end:a/s};return{start:0,end:i/s}},dynamic:function(t){var e=t.NOW,r=t.clientOffset,n=t.availabilityStartTime,i=t.timescale,a=void 0===i?1:i,u=t.duration,s=t.periodStart,o=void 0===s?0:s,c=t.minimumUpdatePeriod,f=void 0===c?0:c,v=t.timeShiftBufferDepth,d=void 0===v?1/0:v;var l=I(t.endNumber);var m=(e+r)/1e3;var p=n+o;var g=m+f;var b=g-p;var h=Math.ceil(b*a/u);var S=Math.floor((m-p-d)*a/u);var y=Math.floor((m-p)*a/u);return{start:Math.max(0,S),end:"number"===typeof l?l:Math.min(h,y)}}};var D=function(t){return function(e){var r=t.duration,n=t.timescale,i=void 0===n?1:n,a=t.periodStart,u=t.startNumber,s=void 0===u?1:u;return{number:s+e,duration:r/i,timeline:a,time:e*r}}};var T=function(t){var e=t.type,r=t.duration,n=t.timescale,i=void 0===n?1:n,a=t.periodDuration,u=t.sourceDuration;var s=E[e](t),o=s.start,c=s.end;var f=d(o,c).map(D(t));if("static"===e){var v=f.length-1;var l="number"===typeof a?a:u;f[v].duration=l-r/i*v}return f};var U=function(t){var e=t.baseUrl,r=t.initialization,n=void 0===r?{}:r,i=t.sourceDuration,a=t.indexRange,u=void 0===a?"":a,s=t.periodStart,o=t.presentationTime,c=t.number,f=void 0===c?0:c,v=t.duration;if(!e)throw new Error(h.NO_BASE_URL);var d=S({baseUrl:e,source:n.sourceURL,range:n.range});var l=S({baseUrl:e,source:e,indexRange:u});l.map=d;if(v){var m=T(t);if(m.length){l.duration=m[0].duration;l.timeline=m[0].timeline}}else if(i){l.duration=i;l.timeline=s}l.presentationTime=o||s;l.number=f;return[l]};var N=function(t,e,r){var n=t.sidx.map?t.sidx.map:null;var i=t.sidx.duration;var u=t.timeline||0;var s=t.sidx.byterange;var o=s.offset+s.length;var c=e.timescale;var f=e.references.filter((function(t){return 1!==t.referenceType}));var v=[];var d=t.endList?"static":"dynamic";var l=t.sidx.timeline;var m=l;var p=t.mediaSequence||0;var g;if("bigint"===typeof e.firstOffset)g=a().BigInt(o)+e.firstOffset;else g=o+e.firstOffset;for(var b=0;b<f.length;b++){var h=e.references[b];var S=h.referencedSize;var y=h.subsegmentDuration;var I=void 0;if("bigint"===typeof g)I=g+a().BigInt(S)-a().BigInt(1);else I=g+S-1;var E=g+"-"+I;var D={baseUrl:r,timescale:c,timeline:u,periodStart:l,presentationTime:m,number:p,duration:y,sourceDuration:i,indexRange:E,type:d};var T=U(D)[0];if(n)T.map=n;v.push(T);if("bigint"===typeof g)g+=a().BigInt(S);else g+=S;m+=y/c;p++}t.segments=v;return t};var M=["AUDIO","SUBTITLES"];var O=1/60;var A=function(t){return b(t,(function(t){var e=t.timeline;return e})).sort((function(t,e){return t.timeline>e.timeline?1:-1}))};var R=function(t,e){for(var r=0;r<t.length;r++)if(t[r].attributes.NAME===e)return t[r];return null};var P=function(t){var e=[];(0,u.g)(t,M,(function(t,r,n,i){e=e.concat(t.playlists||[])}));return e};var _=function(t){var e=t.playlist,r=t.mediaSequence;e.mediaSequence=r;e.segments.forEach((function(t,r){t.number=e.mediaSequence+r}))};var L=function(t){var e=t.oldPlaylists,r=t.newPlaylists,n=t.timelineStarts;r.forEach((function(t){t.discontinuitySequence=g(n,(function(e){var r=e.timeline;return r===t.timeline}));var r=R(e,t.attributes.NAME);if(!r)return;if(t.sidx)return;var i=t.segments[0];var a=g(r.segments,(function(t){return Math.abs(t.presentationTime-i.presentationTime)<O}));if(-1===a){_({playlist:t,mediaSequence:r.mediaSequence+r.segments.length});t.segments[0].discontinuity=true;t.discontinuityStarts.unshift(0);if(!r.segments.length&&t.timeline>r.timeline||r.segments.length&&t.timeline>r.segments[r.segments.length-1].timeline)t.discontinuitySequence--;return}var u=r.segments[a];if(u.discontinuity&&!i.discontinuity){i.discontinuity=true;t.discontinuityStarts.unshift(0);t.discontinuitySequence--}_({playlist:t,mediaSequence:r.segments[a].number})}))};var w=function(t){var e=t.oldManifest,r=t.newManifest;var n=e.playlists.concat(P(e));var i=r.playlists.concat(P(r));r.timelineStarts=A([e.timelineStarts,r.timelineStarts]);L({oldPlaylists:n,newPlaylists:i,timelineStarts:r.timelineStarts});return r};var B=function(t){return t&&t.uri+"-"+y(t.byterange)};var x=function(t){var e=v(t.reduce((function(t,e){var r=e.attributes.id+(e.attributes.lang||"");if(!t[r]){t[r]=e;t[r].attributes.timelineStarts=[]}else{if(e.segments){var n;if(e.segments[0])e.segments[0].discontinuity=true;(n=t[r].segments).push.apply(n,e.segments)}if(e.attributes.contentProtection)t[r].attributes.contentProtection=e.attributes.contentProtection}t[r].attributes.timelineStarts.push({start:e.attributes.periodStart,timeline:e.attributes.periodStart});return t}),{}));return e.map((function(t){t.discontinuityStarts=p(t.segments||[],"discontinuity");return t}))};var C=function(t,e){var r=B(t.sidx);var n=r&&e[r]&&e[r].sidx;if(n)N(t,n,t.sidx.resolvedUri);return t};var F=function(t,e){if(void 0===e)e={};if(!Object.keys(e).length)return t;for(var r in t)t[r]=C(t[r],e);return t};var G=function(t,e){var r;var n=t.attributes,i=t.segments,a=t.sidx,u=t.mediaSequence,s=t.discontinuitySequence,o=t.discontinuityStarts;var c={attributes:(r={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},r["PROGRAM-ID"]=1,r),uri:"",endList:"static"===n.type,timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuitySequence:s,discontinuityStarts:o,timelineStarts:n.timelineStarts,mediaSequence:u,segments:i};if(n.contentProtection)c.contentProtection=n.contentProtection;if(a)c.sidx=a;if(e){c.attributes.AUDIO="audio";c.attributes.SUBTITLES="subs"}return c};var q=function(t){var e;var r=t.attributes,n=t.segments,i=t.mediaSequence,a=t.discontinuityStarts,u=t.discontinuitySequence;if("undefined"===typeof n){n=[{uri:r.baseUrl,timeline:r.periodStart,resolvedUri:r.baseUrl||"",duration:r.sourceDuration,number:0}];r.duration=r.sourceDuration}var s=(e={NAME:r.id,BANDWIDTH:r.bandwidth},e["PROGRAM-ID"]=1,e);if(r.codecs)s.CODECS=r.codecs;return{attributes:s,uri:"",endList:"static"===r.type,timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,timelineStarts:r.timelineStarts,discontinuityStarts:a,discontinuitySequence:u,mediaSequence:i,segments:n}};var k=function(t,e,r){if(void 0===e)e={};if(void 0===r)r=false;var n;var i=t.reduce((function(t,i){var a=i.attributes.role&&i.attributes.role.value||"";var u=i.attributes.lang||"";var s=i.attributes.label||"main";if(u&&!i.attributes.label){var o=a?" ("+a+")":"";s=""+i.attributes.lang+o}if(!t[s])t[s]={language:u,autoselect:true,default:"main"===a,playlists:[],uri:""};var c=C(G(i,r),e);t[s].playlists.push(c);if("undefined"===typeof n&&"main"===a){n=i;n.default=true}return t}),{});if(!n){var a=Object.keys(i)[0];i[a].default=true}return i};var H=function(t,e){if(void 0===e)e={};return t.reduce((function(t,r){var n=r.attributes.lang||"text";if(!t[n])t[n]={language:n,default:false,autoselect:false,playlists:[],uri:""};t[n].playlists.push(C(q(r),e));return t}),{})};var j=function(t){return t.reduce((function(t,e){if(!e)return t;e.forEach((function(e){var r=e.channel,n=e.language;t[n]={autoselect:false,default:false,instreamId:r,language:n};if(e.hasOwnProperty("aspectRatio"))t[n].aspectRatio=e.aspectRatio;if(e.hasOwnProperty("easyReader"))t[n].easyReader=e.easyReader;if(e.hasOwnProperty("3D"))t[n]["3D"]=e["3D"]}));return t}),{})};var z=function(t){var e;var r=t.attributes,n=t.segments,i=t.sidx,a=t.discontinuityStarts;var u={attributes:(e={NAME:r.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:r.width,height:r.height},CODECS:r.codecs,BANDWIDTH:r.bandwidth},e["PROGRAM-ID"]=1,e),uri:"",endList:"static"===r.type,timeline:r.periodStart,resolvedUri:"",targetDuration:r.duration,discontinuityStarts:a,timelineStarts:r.timelineStarts,segments:n};if(r.contentProtection)u.contentProtection=r.contentProtection;if(i)u.sidx=i;return u};var V=function(t){var e=t.attributes;return"video/mp4"===e.mimeType||"video/webm"===e.mimeType||"video"===e.contentType};var $=function(t){var e=t.attributes;return"audio/mp4"===e.mimeType||"audio/webm"===e.mimeType||"audio"===e.contentType};var W=function(t){var e=t.attributes;return"text/vtt"===e.mimeType||"text"===e.contentType};var X=function(t,e){t.forEach((function(t){t.mediaSequence=0;t.discontinuitySequence=g(e,(function(e){var r=e.timeline;return r===t.timeline}));if(!t.segments)return;t.segments.forEach((function(t,e){t.number=e}))}))};var Z=function(t){if(!t)return[];return Object.keys(t).reduce((function(e,r){var n=t[r];return e.concat(n.playlists)}),[])};var Y=function(t){var e;var r=t.dashPlaylists,n=t.locations,i=t.sidxMapping,a=void 0===i?{}:i,u=t.previousManifest;if(!r.length)return{};var s=r[0].attributes,o=s.sourceDuration,c=s.type,f=s.suggestedPresentationDelay,v=s.minimumUpdatePeriod;var d=x(r.filter(V)).map(z);var l=x(r.filter($));var m=x(r.filter(W));var p=r.map((function(t){return t.attributes.captionServices})).filter(Boolean);var g={allowCache:true,discontinuityStarts:[],segments:[],endList:true,mediaGroups:(e={AUDIO:{},VIDEO:{}},e["CLOSED-CAPTIONS"]={},e.SUBTITLES={},e),uri:"",duration:o,playlists:F(d,a)};if(v>=0)g.minimumUpdatePeriod=1e3*v;if(n)g.locations=n;if("dynamic"===c)g.suggestedPresentationDelay=f;var b=0===g.playlists.length;var h=l.length?k(l,a,b):null;var S=m.length?H(m,a):null;var y=d.concat(Z(h),Z(S));var I=y.map((function(t){var e=t.timelineStarts;return e}));g.timelineStarts=A(I);X(y,g.timelineStarts);if(h)g.mediaGroups.AUDIO.audio=h;if(S)g.mediaGroups.SUBTITLES.subs=S;if(p.length)g.mediaGroups["CLOSED-CAPTIONS"].cc=j(p);if(u)return w({oldManifest:u,newManifest:g});return g};var Q=function(t,e,r){var n=t.NOW,i=t.clientOffset,a=t.availabilityStartTime,u=t.timescale,s=void 0===u?1:u,o=t.periodStart,c=void 0===o?0:o,f=t.minimumUpdatePeriod,v=void 0===f?0:f;var d=(n+i)/1e3;var l=a+c;var m=d+v;var p=m-l;return Math.ceil((p*s-e)/r)};var K=function(t,e){var r=t.type,n=t.minimumUpdatePeriod,i=void 0===n?0:n,a=t.media,u=void 0===a?"":a,s=t.sourceDuration,o=t.timescale,c=void 0===o?1:o,f=t.startNumber,v=void 0===f?1:f,d=t.periodStart;var l=[];var m=-1;for(var p=0;p<e.length;p++){var g=e[p];var b=g.d;var h=g.r||0;var S=g.t||0;if(m<0)m=S;if(S&&S>m)m=S;var y=void 0;if(h<0){var I=p+1;if(I===e.length)if("dynamic"===r&&i>0&&u.indexOf("$Number$")>0)y=Q(t,m,b);else y=(s*c-m)/b;else y=(e[I].t-m)/b}else y=h+1;var E=v+l.length+y;var D=v+l.length;while(D<E){l.push({number:D,duration:b/c,time:m,timeline:d});m+=b;D++}}return l};var J=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g;var tt=function(t){return function(e,r,n,i){if("$$"===e)return"$";if("undefined"===typeof t[r])return e;var a=""+t[r];if("RepresentationID"===r)return a;if(!n)i=1;else i=parseInt(i,10);if(a.length>=i)return a;return""+new Array(i-a.length+1).join("0")+a}};var et=function(t,e){return t.replace(J,tt(e))};var rt=function(t,e){if(!t.duration&&!e)return[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodStart}];if(t.duration)return T(t);return K(t,e)};var nt=function(t,e){var r={RepresentationID:t.id,Bandwidth:t.bandwidth||0};var i=t.initialization,a=void 0===i?{sourceURL:"",range:""}:i;var u=S({baseUrl:t.baseUrl,source:et(a.sourceURL,r),range:a.range});var s=rt(t,e);return s.map((function(e){r.Number=e.number;r.Time=e.time;var i=et(t.media||"",r);var a=t.timescale||1;var s=t.presentationTimeOffset||0;var o=t.periodStart+(e.time-s)/a;var c={uri:i,timeline:e.timeline,duration:e.duration,resolvedUri:(0,n.Z)(t.baseUrl||"",i),map:u,number:e.number,presentationTime:o};return c}))};var it=function(t,e){var r=t.baseUrl,n=t.initialization,i=void 0===n?{}:n;var a=S({baseUrl:r,source:i.sourceURL,range:i.range});var u=S({baseUrl:r,source:e.media,range:e.mediaRange});u.map=a;return u};var at=function(t,e){var r=t.duration,n=t.segmentUrls,i=void 0===n?[]:n,a=t.periodStart;if(!r&&!e||r&&e)throw new Error(h.SEGMENT_TIME_UNSPECIFIED);var u=i.map((function(e){return it(t,e)}));var s;if(r)s=T(t);if(e)s=K(t,e);var o=s.map((function(e,r){if(u[r]){var n=u[r];var i=t.timescale||1;var s=t.presentationTimeOffset||0;n.timeline=e.timeline;n.duration=e.duration;n.number=e.number;n.presentationTime=a+(e.time-s)/i;return n}})).filter((function(t){return t}));return o};var ut=function(t){var e=t.attributes,r=t.segmentInfo;var n;var i;if(r.template){i=nt;n=f(e,r.template)}else if(r.base){i=U;n=f(e,r.base)}else if(r.list){i=at;n=f(e,r.list)}var a={attributes:e};if(!i)return a;var u=i(n,r.segmentTimeline);if(n.duration){var s=n,o=s.duration,c=s.timescale,v=void 0===c?1:c;n.duration=o/v}else if(u.length)n.duration=u.reduce((function(t,e){return Math.max(t,Math.ceil(e.duration))}),0);else n.duration=0;a.attributes=n;a.segments=u;if(r.base&&n.indexRange){a.sidx=u[0];a.segments=[]}return a};var st=function(t){return t.map(ut)};var ot=function(t,e){return m(t.childNodes).filter((function(t){var r=t.tagName;return r===e}))};var ct=function(t){return t.textContent.trim()};var ft=function(t){var e=365*24*60*60;var r=30*24*60*60;var n=24*60*60;var i=60*60;var a=60;var u=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/;var s=u.exec(t);if(!s)return 0;var o=s.slice(1),c=o[0],f=o[1],v=o[2],d=o[3],l=o[4],m=o[5];return parseFloat(c||0)*e+parseFloat(f||0)*r+parseFloat(v||0)*n+parseFloat(d||0)*i+parseFloat(l||0)*a+parseFloat(m||0)};var vt=function(t){var e=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;if(e.test(t))t+="Z";return Date.parse(t)};var dt={mediaPresentationDuration:function(t){return ft(t)},availabilityStartTime:function(t){return vt(t)/1e3},minimumUpdatePeriod:function(t){return ft(t)},suggestedPresentationDelay:function(t){return ft(t)},type:function(t){return t},timeShiftBufferDepth:function(t){return ft(t)},start:function(t){return ft(t)},width:function(t){return parseInt(t,10)},height:function(t){return parseInt(t,10)},bandwidth:function(t){return parseInt(t,10)},startNumber:function(t){return parseInt(t,10)},timescale:function(t){return parseInt(t,10)},presentationTimeOffset:function(t){return parseInt(t,10)},duration:function(t){var e=parseInt(t,10);if(isNaN(e))return ft(t);return e},d:function(t){return parseInt(t,10)},t:function(t){return parseInt(t,10)},r:function(t){return parseInt(t,10)},DEFAULT:function(t){return t}};var lt=function(t){if(!(t&&t.attributes))return{};return m(t.attributes).reduce((function(t,e){var r=dt[e.name]||dt.DEFAULT;t[e.name]=r(e.value);return t}),{})};var mt={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};var pt=function(t,e){if(!e.length)return t;return l(t.map((function(t){return e.map((function(e){return(0,n.Z)(t,ct(e))}))})))};var gt=function(t){var e=ot(t,"SegmentTemplate")[0];var r=ot(t,"SegmentList")[0];var n=r&&ot(r,"SegmentURL").map((function(t){return f({tag:"SegmentURL"},lt(t))}));var i=ot(t,"SegmentBase")[0];var a=r||e;var u=a&&ot(a,"SegmentTimeline")[0];var s=r||i||e;var o=s&&ot(s,"Initialization")[0];var c=e&&lt(e);if(c&&o)c.initialization=o&&lt(o);else if(c&&c.initialization)c.initialization={sourceURL:c.initialization};var v={template:c,segmentTimeline:u&&ot(u,"S").map((function(t){return lt(t)})),list:r&&f(lt(r),{segmentUrls:n,initialization:lt(o)}),base:i&&f(lt(i),{initialization:lt(o)})};Object.keys(v).forEach((function(t){if(!v[t])delete v[t]}));return v};var bt=function(t,e,r){return function(n){var i=ot(n,"BaseURL");var a=pt(e,i);var u=f(t,lt(n));var s=gt(n);return a.map((function(t){return{segmentInfo:f(r,s),attributes:f(u,{baseUrl:t})}}))}};var ht=function(t){return t.reduce((function(t,e){var r=lt(e);if(r.schemeIdUri)r.schemeIdUri=r.schemeIdUri.toLowerCase();var n=mt[r.schemeIdUri];if(n){t[n]={attributes:r};var i=ot(e,"cenc:pssh")[0];if(i){var a=ct(i);t[n].pssh=a&&(0,s.Z)(a)}}return t}),{})};var St=function(t){if("urn:scte:dash:cc:cea-608:2015"===t.schemeIdUri){var e="string"!==typeof t.value?[]:t.value.split(";");return e.map((function(t){var e;var r;r=t;if(/^CC\d=/.test(t)){var n=t.split("=");e=n[0];r=n[1]}else if(/^CC\d$/.test(t))e=t;return{channel:e,language:r}}))}else if("urn:scte:dash:cc:cea-708:2015"===t.schemeIdUri){var r="string"!==typeof t.value?[]:t.value.split(";");return r.map((function(t){var e={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(t)){var r=t.split("="),n=r[0],i=r[1],a=void 0===i?"":i;e.channel=n;e.language=t;a.split(",").forEach((function(t){var r=t.split(":"),n=r[0],i=r[1];if("lang"===n)e.language=i;else if("er"===n)e.easyReader=Number(i);else if("war"===n)e.aspectRatio=Number(i);else if("3D"===n)e["3D"]=Number(i)}))}else e.language=t;if(e.channel)e.channel="SERVICE"+e.channel;return e}))}};var yt=function(t,e,r){return function(n){var i=lt(n);var a=pt(e,ot(n,"BaseURL"));var u=ot(n,"Role")[0];var s={role:lt(u)};var o=f(t,i,s);var c=ot(n,"Accessibility")[0];var v=St(lt(c));if(v)o=f(o,{captionServices:v});var d=ot(n,"Label")[0];if(d&&d.childNodes.length){var m=d.childNodes[0].nodeValue.trim();o=f(o,{label:m})}var p=ht(ot(n,"ContentProtection"));if(Object.keys(p).length)o=f(o,{contentProtection:p});var g=gt(n);var b=ot(n,"Representation");var h=f(r,g);return l(b.map(bt(o,a,h)))}};var It=function(t,e){return function(r,n){var i=pt(e,ot(r.node,"BaseURL"));var a=f(t,{periodStart:r.attributes.start});if("number"===typeof r.attributes.duration)a.periodDuration=r.attributes.duration;var u=ot(r.node,"AdaptationSet");var s=gt(r.node);return l(u.map(yt(a,i,s)))}};var Et=function(t){var e=t.attributes,r=t.priorPeriodAttributes,n=t.mpdType;if("number"===typeof e.start)return e.start;if(r&&"number"===typeof r.start&&"number"===typeof r.duration)return r.start+r.duration;if(!r&&"static"===n)return 0;return null};var Dt=function(t,e){if(void 0===e)e={};var r=e,n=r.manifestUri,i=void 0===n?"":n,a=r.NOW,u=void 0===a?Date.now():a,s=r.clientOffset,o=void 0===s?0:s;var c=ot(t,"Period");if(!c.length)throw new Error(h.INVALID_NUMBER_OF_PERIOD);var f=ot(t,"Location");var v=lt(t);var d=pt([i],ot(t,"BaseURL"));v.type=v.type||"static";v.sourceDuration=v.mediaPresentationDuration||0;v.NOW=u;v.clientOffset=o;if(f.length)v.locations=f.map(ct);var m=[];c.forEach((function(t,e){var r=lt(t);var n=m[e-1];r.start=Et({attributes:r,priorPeriodAttributes:n?n.attributes:null,mpdType:v.type});m.push({node:t,attributes:r})}));return{locations:v.locations,representationInfo:l(m.map(It(v,d)))}};var Tt=function(t){if(""===t)throw new Error(h.DASH_EMPTY_MANIFEST);var e=new o.DOMParser;var r;var n;try{r=e.parseFromString(t,"application/xml");n=r&&"MPD"===r.documentElement.tagName?r.documentElement:null}catch(i){}if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(h.DASH_INVALID_XML);return n};var Ut=function(t){var e=ot(t,"UTCTiming")[0];if(!e)return null;var r=lt(e);switch(r.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":r.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":r.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":r.method="DIRECT";r.value=Date.parse(r.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(h.UNSUPPORTED_UTC_TIMING_SCHEME)}return r};var Nt=function(t,e){if(void 0===e)e={};var r=Dt(Tt(t),e);var n=st(r.representationInfo);return Y({dashPlaylists:n,locations:r.locations,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest})};var Mt=function(t){return Ut(Tt(t))}}}]);