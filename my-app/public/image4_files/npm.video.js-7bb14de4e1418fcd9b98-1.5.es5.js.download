/*! For license information please see npm.video.js-7bb14de4e1418fcd9b98-1.5.es5.js.LICENSE.txt */
"use strict";(self["webpackChunkFutureLearn"]=self["webpackChunkFutureLearn"]||[]).push([["npm.video.js"],{"8OJ3":(e,t,i)=>{i.d(t,{Z:()=>Sd});var r=i("vgmO");var n=i.n(r);var a=i("7zRj");var s=i.n(a);var o=i("+9dH");var u=i("3zPy");var l=i.n(u);var d=i("Lr5L");var c=i("+5J7");var h=i("jBAH");var f=i.n(h);var p=i("NgPB");var m=i.n(p);var v=i("K4wu");var g=i.n(v);var _=i("hYGZ");var y=i("5hh5");var T=i("Y+wj");var b=i("10ky");var S=i("F6NX");var k=i("i1Oy");var C=i("3mbX");var E=i("hIRe");var w=i("gcCN");var I=i.n(w);var x=i("Mh8q");var P=i("pdG3");var A=i("NsZL");var L="7.20.1";var O={};var D=function(e,t){O[e]=O[e]||[];if(t)O[e]=O[e].concat(t);return O[e]};var M=function(e,t){D(e,t)};var R=function(e,t){var i=D(e).indexOf(t);if(i<=-1)return false;O[e]=O[e].slice();O[e].splice(i,1);return true};var U=function(e,t){D(e,[].concat(t).map((function(t){var i=function i(){R(e,i);return t.apply(void 0,arguments)};return i})))};var B={prefixed:true};var N=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]];var F=N[0];var j;for(var H=0;H<N.length;H++)if(N[H][1]in s()){j=N[H];break}if(j){for(var q=0;q<j.length;q++)B[F[q]]=j[q];B.prefixed=j[0]!==F[0]}var V=[];var W=function(e,t){return function(i,r,a){var s=t.levels[r];var o=new RegExp("^("+s+")$");if("log"!==i)a.unshift(i.toUpperCase()+":");a.unshift(e+":");if(V){V.push([].concat(a));var u=V.length-1e3;V.splice(0,u>0?u:0)}if(!n().console)return;var l=n().console[i];if(!l&&"debug"===i)l=n().console.info||n().console.log;if(!l||!s||!o.test(i))return;l[Array.isArray(a)?"apply":"call"](n().console,a)}};function z(e){var t="info";var i;var r=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];i("log",t,r)};i=W(e,r);r.createLogger=function(t){return z(e+": "+t)};r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:t};r.level=function(e){if("string"===typeof e){if(!r.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');t=e}return t};r.history=function(){return V?[].concat(V):[]};r.history.filter=function(e){return(V||[]).filter((function(t){return new RegExp(".*"+e+".*").test(t[0])}))};r.history.clear=function(){if(V)V.length=0};r.history.disable=function(){if(null!==V){V.length=0;V=null}};r.history.enable=function(){if(null===V)V=[]};r.error=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return i("error",t,r)};r.warn=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return i("warn",t,r)};r.debug=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return i("debug",t,r)};return r}var G=z("VIDEOJS");var K=G.createLogger;var Z=Object.prototype.toString;var Q=function(e){return J(e)?Object.keys(e):[]};function X(e,t){Q(e).forEach((function(i){return t(e[i],i)}))}function Y(e,t,i){if(void 0===i)i=0;return Q(e).reduce((function(i,r){return t(i,e[r],r)}),i)}function $(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];if(Object.assign)return o.Z.apply(void 0,[e].concat(i));i.forEach((function(t){if(!t)return;X(t,(function(t,i){e[i]=t}))}));return e}function J(e){return!!e&&"object"===typeof e}function ee(e){return J(e)&&"[object Object]"===Z.call(e)&&e.constructor===Object}function te(e,t){if(!e||!t)return"";if("function"===typeof n().getComputedStyle){var i;try{i=n().getComputedStyle(e)}catch(r){return""}return i?i.getPropertyValue(t)||i[t]:""}return""}var ie=n().navigator&&n().navigator.userAgent||"";var re=/AppleWebKit\/([\d.]+)/i.exec(ie);var ne=re?parseFloat(re.pop()):null;var ae=/iPod/i.test(ie);var se=function(){var e=ie.match(/OS (\d+)_/i);if(e&&e[1])return e[1];return null}();var oe=/Android/i.test(ie);var ue=function(){var e=ie.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]);var i=e[2]&&parseFloat(e[2]);if(t&&i)return parseFloat(e[1]+"."+e[2]);else if(t)return t;return null}();var le=oe&&ue<5&&ne<537;var de=/Firefox/i.test(ie);var ce=/Edg/i.test(ie);var he=!ce&&(/Chrome/i.test(ie)||/CriOS/i.test(ie));var fe=function(){var e=ie.match(/(Chrome|CriOS)\/(\d+)/);if(e&&e[2])return parseFloat(e[2]);return null}();var pe=function(){var e=/MSIE\s(\d+)\.\d/.exec(ie);var t=e&&parseFloat(e[1]);if(!t&&/Trident\/7.0/i.test(ie)&&/rv:11.0/.test(ie))t=11;return t}();var me=/Safari/i.test(ie)&&!he&&!oe&&!ce;var ve=/Windows/i.test(ie);var ge=Boolean(we()&&("ontouchstart"in n()||n().navigator.maxTouchPoints||n().DocumentTouch&&n().document instanceof n().DocumentTouch));var _e=/iPad/i.test(ie)||me&&ge&&!/iPhone/i.test(ie);var ye=/iPhone/i.test(ie)&&!_e;var Te=ye||_e||ae;var be=(me||Te)&&!he;var Se=Object.freeze({__proto__:null,IS_IPOD:ae,IOS_VERSION:se,IS_ANDROID:oe,ANDROID_VERSION:ue,IS_NATIVE_ANDROID:le,IS_FIREFOX:de,IS_EDGE:ce,IS_CHROME:he,CHROME_VERSION:fe,IE_VERSION:pe,IS_SAFARI:me,IS_WINDOWS:ve,TOUCH_ENABLED:ge,IS_IPAD:_e,IS_IPHONE:ye,IS_IOS:Te,IS_ANY_SAFARI:be});function ke(e){return"string"===typeof e&&Boolean(e.trim())}function Ce(e){if(e.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function Ee(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}function we(){return s()===n().document}function Ie(e){return J(e)&&1===e.nodeType}function xe(){try{return n().parent!==n().self}catch(e){return true}}function Pe(e){return function(t,i){if(!ke(t))return s()[e](null);if(ke(i))i=s().querySelector(i);var r=Ie(i)?i:s();return r[e]&&r[e](t)}}function Ae(e,t,i,r){if(void 0===e)e="div";if(void 0===t)t={};if(void 0===i)i={};var n=s().createElement(e);Object.getOwnPropertyNames(t).forEach((function(e){var i=t[e];if(-1!==e.indexOf("aria-")||"role"===e||"type"===e){G.warn("Setting attributes in the second argument of createEl()\n"+"has been deprecated. Use the third argument instead.\n"+"createEl(type, properties, attributes). Attempting to set "+e+" to "+i+".");n.setAttribute(e,i)}else if("textContent"===e)Le(n,i);else if(n[e]!==i||"tabIndex"===e)n[e]=i}));Object.getOwnPropertyNames(i).forEach((function(e){n.setAttribute(e,i[e])}));if(r)Xe(n,r);return n}function Le(e,t){if("undefined"===typeof e.textContent)e.innerText=t;else e.textContent=t;return e}function Oe(e,t){if(t.firstChild)t.insertBefore(e,t.firstChild);else t.appendChild(e)}function De(e,t){Ce(t);if(e.classList)return e.classList.contains(t);return Ee(t).test(e.className)}function Me(e,t){if(e.classList)e.classList.add(t);else if(!De(e,t))e.className=(e.className+" "+t).trim();return e}function Re(e,t){if(!e){G.warn("removeClass was called with an element that doesn't exist");return null}if(e.classList)e.classList.remove(t);else{Ce(t);e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")}return e}function Ue(e,t,i){var r=De(e,t);if("function"===typeof i)i=i(e,t);if("boolean"!==typeof i)i=!r;if(i===r)return;if(i)Me(e,t);else Re(e,t);return e}function Be(e,t){Object.getOwnPropertyNames(t).forEach((function(i){var r=t[i];if(null===r||"undefined"===typeof r||false===r)e.removeAttribute(i);else e.setAttribute(i,true===r?"":r)}))}function Ne(e){var t={};var i=","+"autoplay,controls,playsinline,loop,muted,default,defaultMuted"+",";if(e&&e.attributes&&e.attributes.length>0){var r=e.attributes;for(var n=r.length-1;n>=0;n--){var a=r[n].name;var s=r[n].value;if("boolean"===typeof e[a]||-1!==i.indexOf(","+a+","))s=null!==s?true:false;t[a]=s}}return t}function Fe(e,t){return e.getAttribute(t)}function je(e,t,i){e.setAttribute(t,i)}function He(e,t){e.removeAttribute(t)}function qe(){s().body.focus();s().onselectstart=function(){return false}}function Ve(){s().onselectstart=function(){return true}}function We(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect();var i={};["bottom","height","left","right","top","width"].forEach((function(e){if(void 0!==t[e])i[e]=t[e]}));if(!i.height)i.height=parseFloat(te(e,"height"));if(!i.width)i.width=parseFloat(te(e,"width"));return i}}function ze(e){if(!e||e&&!e.offsetParent)return{left:0,top:0,width:0,height:0};var t=e.offsetWidth;var i=e.offsetHeight;var r=0;var n=0;while(e.offsetParent&&e!==s()[B.fullscreenElement]){r+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}return{left:r,top:n,width:t,height:i}}function Ge(e,t){var i={x:0,y:0};if(Te){var r=e;while(r&&"html"!==r.nodeName.toLowerCase()){var n=te(r,"transform");if(/^matrix/.test(n)){var a=n.slice(7,-1).split(/,\s/).map(Number);i.x+=a[4];i.y+=a[5]}else if(/^matrix3d/.test(n)){var s=n.slice(9,-1).split(/,\s/).map(Number);i.x+=s[12];i.y+=s[13]}r=r.parentNode}}var o={};var u=ze(t.target);var l=ze(e);var d=l.width;var c=l.height;var h=t.offsetY-(l.top-u.top);var f=t.offsetX-(l.left-u.left);if(t.changedTouches){f=t.changedTouches[0].pageX-l.left;h=t.changedTouches[0].pageY+l.top;if(Te){f-=i.x;h-=i.y}}o.y=1-Math.max(0,Math.min(1,h/c));o.x=Math.max(0,Math.min(1,f/d));return o}function Ke(e){return J(e)&&3===e.nodeType}function Ze(e){while(e.firstChild)e.removeChild(e.firstChild);return e}function Qe(e){if("function"===typeof e)e=e();return(Array.isArray(e)?e:[e]).map((function(e){if("function"===typeof e)e=e();if(Ie(e)||Ke(e))return e;if("string"===typeof e&&/\S/.test(e))return s().createTextNode(e)})).filter((function(e){return e}))}function Xe(e,t){Qe(t).forEach((function(t){return e.appendChild(t)}));return e}function Ye(e,t){return Xe(Ze(e),t)}function $e(e){if(void 0===e.button&&void 0===e.buttons)return true;if(0===e.button&&void 0===e.buttons)return true;if("mouseup"===e.type&&0===e.button&&0===e.buttons)return true;if(0!==e.button||1!==e.buttons)return false;return true}var Je=Pe("querySelector");var et=Pe("querySelectorAll");var tt=Object.freeze({__proto__:null,isReal:we,isEl:Ie,isInFrame:xe,createEl:Ae,textContent:Le,prependTo:Oe,hasClass:De,addClass:Me,removeClass:Re,toggleClass:Ue,setAttributes:Be,getAttributes:Ne,getAttribute:Fe,setAttribute:je,removeAttribute:He,blockTextSelection:qe,unblockTextSelection:Ve,getBoundingClientRect:We,findPosition:ze,getPointerPosition:Ge,isTextNode:Ke,emptyEl:Ze,normalizeContent:Qe,appendContent:Xe,insertContent:Ye,isSingleLeftClick:$e,$:Je,$$:et});var it=false;var rt;var nt=function(){if(false===rt.options.autoSetup)return;var e=Array.prototype.slice.call(s().getElementsByTagName("video"));var t=Array.prototype.slice.call(s().getElementsByTagName("audio"));var i=Array.prototype.slice.call(s().getElementsByTagName("video-js"));var r=e.concat(t,i);if(r&&r.length>0)for(var n=0,a=r.length;n<a;n++){var o=r[n];if(o&&o.getAttribute){if(void 0===o.player){var u=o.getAttribute("data-setup");if(null!==u)rt(o)}}else{at(1);break}}else if(!it)at(1)};function at(e,t){if(!we())return;if(t)rt=t;n().setTimeout(nt,e)}function st(){it=true;n().removeEventListener("load",st)}if(we())if("complete"===s().readyState)st();else n().addEventListener("load",st);var ot=function(e){var t=s().createElement("style");t.className=e;return t};var ut=function(e,t){if(e.styleSheet)e.styleSheet.cssText=t;else e.textContent=t};var lt=3;var dt=lt;function ct(){return dt++}var ht;if(!n().WeakMap)ht=function(){function e(){this.vdata="vdata"+Math.floor(n().performance&&n().performance.now()||Date.now());this.data={}}var t=e.prototype;t.set=function(e,t){var i=e[this.vdata]||ct();if(!e[this.vdata])e[this.vdata]=i;this.data[i]=t;return this};t.get=function(e){var t=e[this.vdata];if(t)return this.data[t];G("We have no data for this element",e);return};t.has=function(e){var t=e[this.vdata];return t in this.data};t["delete"]=function(e){var t=e[this.vdata];if(t){delete this.data[t];delete e[this.vdata]}};return e}();var ft=n().WeakMap?new WeakMap:new ht;function pt(e,t){if(!ft.has(e))return;var i=ft.get(e);if(0===i.handlers[t].length){delete i.handlers[t];if(e.removeEventListener)e.removeEventListener(t,i.dispatcher,false);else if(e.detachEvent)e.detachEvent("on"+t,i.dispatcher)}if(Object.getOwnPropertyNames(i.handlers).length<=0){delete i.handlers;delete i.dispatcher;delete i.disabled}if(0===Object.getOwnPropertyNames(i).length)ft["delete"](e)}function mt(e,t,i,r){i.forEach((function(i){e(t,i,r)}))}function vt(e){if(e.fixed_)return e;function t(){return true}function i(){return false}if(!e||!e.isPropagationStopped||!e.isImmediatePropagationStopped){var r=e||n().event;e={};for(var a in r)if("layerX"!==a&&"layerY"!==a&&"keyLocation"!==a&&"webkitMovementX"!==a&&"webkitMovementY"!==a&&"path"!==a)if(!("returnValue"===a&&r.preventDefault))e[a]=r[a];if(!e.target)e.target=e.srcElement||s();if(!e.relatedTarget)e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement;e.preventDefault=function(){if(r.preventDefault)r.preventDefault();e.returnValue=false;r.returnValue=false;e.defaultPrevented=true};e.defaultPrevented=false;e.stopPropagation=function(){if(r.stopPropagation)r.stopPropagation();e.cancelBubble=true;r.cancelBubble=true;e.isPropagationStopped=t};e.isPropagationStopped=i;e.stopImmediatePropagation=function(){if(r.stopImmediatePropagation)r.stopImmediatePropagation();e.isImmediatePropagationStopped=t;e.stopPropagation()};e.isImmediatePropagationStopped=i;if(null!==e.clientX&&void 0!==e.clientX){var o=s().documentElement;var u=s().body;e.pageX=e.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0);e.pageY=e.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}e.which=e.charCode||e.keyCode;if(null!==e.button&&void 0!==e.button)e.button=1&e.button?0:4&e.button?1:2&e.button?2:0}e.fixed_=true;return e}var gt;var _t=function(){if("boolean"!==typeof gt){gt=false;try{var e=Object.defineProperty({},"passive",{get:function(){gt=true}});n().addEventListener("test",null,e);n().removeEventListener("test",null,e)}catch(t){}}return gt};var yt=["touchstart","touchmove"];function Tt(e,t,i){if(Array.isArray(t))return mt(Tt,e,t,i);if(!ft.has(e))ft.set(e,{});var r=ft.get(e);if(!r.handlers)r.handlers={};if(!r.handlers[t])r.handlers[t]=[];if(!i.guid)i.guid=ct();r.handlers[t].push(i);if(!r.dispatcher){r.disabled=false;r.dispatcher=function(t,i){if(r.disabled)return;t=vt(t);var n=r.handlers[t.type];if(n){var a=n.slice(0);for(var s=0,o=a.length;s<o;s++)if(t.isImmediatePropagationStopped())break;else try{a[s].call(e,t,i)}catch(u){G.error(u)}}}}if(1===r.handlers[t].length)if(e.addEventListener){var n=false;if(_t()&&yt.indexOf(t)>-1)n={passive:true};e.addEventListener(t,r.dispatcher,n)}else if(e.attachEvent)e.attachEvent("on"+t,r.dispatcher)}function bt(e,t,i){if(!ft.has(e))return;var r=ft.get(e);if(!r.handlers)return;if(Array.isArray(t))return mt(bt,e,t,i);var n=function(e,t){r.handlers[t]=[];pt(e,t)};if(void 0===t){for(var a in r.handlers)if(Object.prototype.hasOwnProperty.call(r.handlers||{},a))n(e,a);return}var s=r.handlers[t];if(!s)return;if(!i){n(e,t);return}if(i.guid)for(var o=0;o<s.length;o++)if(s[o].guid===i.guid)s.splice(o--,1);pt(e,t)}function St(e,t,i){var r=ft.has(e)?ft.get(e):{};var n=e.parentNode||e.ownerDocument;if("string"===typeof t)t={type:t,target:e};else if(!t.target)t.target=e;t=vt(t);if(r.dispatcher)r.dispatcher.call(e,t,i);if(n&&!t.isPropagationStopped()&&true===t.bubbles)St.call(null,n,t,i);else if(!n&&!t.defaultPrevented&&t.target&&t.target[t.type]){if(!ft.has(t.target))ft.set(t.target,{});var a=ft.get(t.target);if(t.target[t.type]){a.disabled=true;if("function"===typeof t.target[t.type])t.target[t.type]();a.disabled=false}}return!t.defaultPrevented}function kt(e,t,i){if(Array.isArray(t))return mt(kt,e,t,i);var r=function r(){bt(e,t,r);i.apply(this,arguments)};r.guid=i.guid=i.guid||ct();Tt(e,t,r)}function Ct(e,t,i){var r=function r(){bt(e,t,r);i.apply(this,arguments)};r.guid=i.guid=i.guid||ct();Tt(e,t,r)}var Et=Object.freeze({__proto__:null,fixEvent:vt,on:Tt,off:bt,trigger:St,one:kt,any:Ct});var wt=30;var It=function(e,t,i){if(!t.guid)t.guid=ct();var r=t.bind(e);r.guid=i?i+"_"+t.guid:t.guid;return r};var xt=function(e,t){var i=n().performance.now();var r=function(){var r=n().performance.now();if(r-i>=t){e.apply(void 0,arguments);i=r}};return r};var Pt=function(e,t,i,r){if(void 0===r)r=n();var a;var s=function(){r.clearTimeout(a);a=null};var o=function(){var n=this;var s=arguments;var o=function(){a=null;o=null;if(!i)e.apply(n,s)};if(!a&&i)e.apply(n,s);r.clearTimeout(a);a=r.setTimeout(o,t)};o.cancel=s;return o};var At=function(){};At.prototype.allowedEvents_={};At.prototype.on=function(e,t){var i=this.addEventListener;this.addEventListener=function(){};Tt(this,e,t);this.addEventListener=i};At.prototype.addEventListener=At.prototype.on;At.prototype.off=function(e,t){bt(this,e,t)};At.prototype.removeEventListener=At.prototype.off;At.prototype.one=function(e,t){var i=this.addEventListener;this.addEventListener=function(){};kt(this,e,t);this.addEventListener=i};At.prototype.any=function(e,t){var i=this.addEventListener;this.addEventListener=function(){};Ct(this,e,t);this.addEventListener=i};At.prototype.trigger=function(e){var t=e.type||e;if("string"===typeof e)e={type:t};e=vt(e);if(this.allowedEvents_[t]&&this["on"+t])this["on"+t](e);St(this,e)};At.prototype.dispatchEvent=At.prototype.trigger;var Lt;At.prototype.queueTrigger=function(e){var t=this;if(!Lt)Lt=new Map;var i=e.type||e;var r=Lt.get(this);if(!r){r=new Map;Lt.set(this,r)}var a=r.get(i);r["delete"](i);n().clearTimeout(a);var s=n().setTimeout((function(){if(0===r.size){r=null;Lt["delete"](t)}t.trigger(e)}),0);r.set(i,s)};var Ot=function(e){if("function"===typeof e.name)return e.name();if("string"===typeof e.name)return e.name;if(e.name_)return e.name_;if(e.constructor&&e.constructor.name)return e.constructor.name;return typeof e};var Dt=function(e){return e instanceof At||!!e.eventBusEl_&&["on","one","off","trigger"].every((function(t){return"function"===typeof e[t]}))};var Mt=function(e,t){if(Dt(e))t();else{if(!e.eventedCallbacks)e.eventedCallbacks=[];e.eventedCallbacks.push(t)}};var Rt=function(e){return"string"===typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length};var Ut=function(e,t,i){if(!e||!e.nodeName&&!Dt(e))throw new Error("Invalid target for "+Ot(t)+"#"+i+"; must be a DOM node or evented object.")};var Bt=function(e,t,i){if(!Rt(e))throw new Error("Invalid event type for "+Ot(t)+"#"+i+"; must be a non-empty string or array.")};var Nt=function(e,t,i){if("function"!==typeof e)throw new Error("Invalid listener for "+Ot(t)+"#"+i+"; must be a function.")};var Ft=function(e,t,i){var r=t.length<3||t[0]===e||t[0]===e.eventBusEl_;var n;var a;var s;if(r){n=e.eventBusEl_;if(t.length>=3)t.shift();a=t[0];s=t[1]}else{n=t[0];a=t[1];s=t[2]}Ut(n,e,i);Bt(a,e,i);Nt(s,e,i);s=It(e,s);return{isTargetingSelf:r,target:n,type:a,listener:s}};var jt=function(e,t,i,r){Ut(e,e,t);if(e.nodeName)Et[t](e,i,r);else e[t](i,r)};var Ht={on:function(){var e=this;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var n=Ft(this,i,"on"),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;jt(s,"on",o,u);if(!a){var l=function(){return e.off(s,o,u)};l.guid=u.guid;var d=function(){return e.off("dispose",l)};d.guid=u.guid;jt(this,"on","dispose",l);jt(s,"on","dispose",d)}},one:function(){var e=this;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var n=Ft(this,i,"one"),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)jt(s,"one",o,u);else{var l=function t(){e.off(s,o,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];u.apply(null,r)};l.guid=u.guid;jt(s,"one",o,l)}},any:function(){var e=this;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var n=Ft(this,i,"any"),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)jt(s,"any",o,u);else{var l=function t(){e.off(s,o,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];u.apply(null,r)};l.guid=u.guid;jt(s,"any",o,l)}},off:function(e,t,i){if(!e||Rt(e))bt(this.eventBusEl_,e,t);else{var r=e;var n=t;Ut(r,this,"off");Bt(n,this,"off");Nt(i,this,"off");i=It(this,i);this.off("dispose",i);if(r.nodeName){bt(r,n,i);bt(r,"dispose",i)}else if(Dt(r)){r.off(n,i);r.off("dispose",i)}}},trigger:function(e,t){Ut(this.eventBusEl_,this,"trigger");var i=e&&"string"!==typeof e?e.type:e;if(!Rt(i)){var r="Invalid event type for "+Ot(this)+"#trigger; "+"must be a non-empty string or object with a type key that has a non-empty value.";if(e)(this.log||G).error(r);else throw new Error(r)}return St(this.eventBusEl_,e,t)}};function qt(e,t){if(void 0===t)t={};var i=t,r=i.eventBusKey;if(r){if(!e[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');e.eventBusEl_=e[r]}else e.eventBusEl_=Ae("span",{className:"vjs-event-bus"});$(e,Ht);if(e.eventedCallbacks)e.eventedCallbacks.forEach((function(e){e()}));e.on("dispose",(function(){e.off();[e,e.el_,e.eventBusEl_].forEach((function(e){if(e&&ft.has(e))ft["delete"](e)}));n().setTimeout((function(){e.eventBusEl_=null}),0)}));return e}var Vt={state:{},setState:function(e){var t=this;if("function"===typeof e)e=e();var i;X(e,(function(e,r){if(t.state[r]!==e){i=i||{};i[r]={from:t.state[r],to:e}}t.state[r]=e}));if(i&&Dt(this))this.trigger({changes:i,type:"statechanged"});return i}};function Wt(e,t){$(e,Vt);e.state=$({},e.state,t);if("function"===typeof e.handleStateChanged&&Dt(e))e.on("statechanged",e.handleStateChanged);return e}var zt=function(e){if("string"!==typeof e)return e;return e.replace(/./,(function(e){return e.toLowerCase()}))};var Gt=function(e){if("string"!==typeof e)return e;return e.replace(/./,(function(e){return e.toUpperCase()}))};var Kt=function(e,t){return Gt(e)===Gt(t)};function Zt(){var e={};for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];i.forEach((function(t){if(!t)return;X(t,(function(t,i){if(!ee(t)){e[i]=t;return}if(!ee(e[i]))e[i]={};e[i]=Zt(e[i],t)}))}));return e}var Qt=function(){function e(){this.map_={}}var t=e.prototype;t.has=function(e){return e in this.map_};t["delete"]=function(e){var t=this.has(e);delete this.map_[e];return t};t.set=function(e,t){this.map_[e]=t;return this};t.forEach=function(e,t){for(var i in this.map_)e.call(t,this.map_[i],i,this)};return e}();var Xt=n().Map?n().Map:Qt;var Yt=function(){function e(){this.set_={}}var t=e.prototype;t.has=function(e){return e in this.set_};t["delete"]=function(e){var t=this.has(e);delete this.set_[e];return t};t.add=function(e){this.set_[e]=1;return this};t.forEach=function(e,t){for(var i in this.set_)e.call(t,i,i,this)};return e}();var $t=n().Set?n().Set:Yt;var Jt=function(){function e(e,t,i){var r=this;if(!e&&this.play)this.player_=e=this;else this.player_=e;this.isDisposed_=false;this.parentComponent_=null;this.options_=Zt({},this.options_);t=this.options_=Zt(this.options_,t);this.id_=t.id||t.el&&t.el.id;if(!this.id_){var n=e&&e.id&&e.id()||"no_player";this.id_=n+"_component_"+ct()}this.name_=t.name||null;if(t.el)this.el_=t.el;else if(false!==t.createEl)this.el_=this.createEl();if(t.className&&this.el_)t.className.split(" ").forEach((function(e){return r.addClass(e)}));if(false!==t.evented){qt(this,{eventBusKey:this.el_?"el_":null});this.handleLanguagechange=this.handleLanguagechange.bind(this);this.on(this.player_,"languagechange",this.handleLanguagechange)}Wt(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};this.setTimeoutIds_=new $t;this.setIntervalIds_=new $t;this.rafIds_=new $t;this.namedRafs_=new Xt;this.clearingTimersOnDispose_=false;if(false!==t.initChildren)this.initChildren();this.ready(i);if(false!==t.reportTouchActivity)this.enableTouchActivity()}var t=e.prototype;t.dispose=function(e){if(void 0===e)e={};if(this.isDisposed_)return;if(this.readyQueue_)this.readyQueue_.length=0;this.trigger({type:"dispose",bubbles:false});this.isDisposed_=true;if(this.children_)for(var t=this.children_.length-1;t>=0;t--)if(this.children_[t].dispose)this.children_[t].dispose();this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.parentComponent_=null;if(this.el_){if(this.el_.parentNode)if(e.restoreEl)this.el_.parentNode.replaceChild(e.restoreEl,this.el_);else this.el_.parentNode.removeChild(this.el_);this.el_=null}this.player_=null};t.isDisposed=function(){return Boolean(this.isDisposed_)};t.player=function(){return this.player_};t.options=function(e){if(!e)return this.options_;this.options_=Zt(this.options_,e);return this.options_};t.el=function(){return this.el_};t.createEl=function(e,t,i){return Ae(e,t,i)};t.localize=function(e,t,i){if(void 0===i)i=e;var r=this.player_.language&&this.player_.language();var n=this.player_.languages&&this.player_.languages();var a=n&&n[r];var s=r&&r.split("-")[0];var o=n&&n[s];var u=i;if(a&&a[e])u=a[e];else if(o&&o[e])u=o[e];if(t)u=u.replace(/\{(\d+)\}/g,(function(e,i){var r=t[i-1];var n=r;if("undefined"===typeof r)n=e;return n}));return u};t.handleLanguagechange=function(){};t.contentEl=function(){return this.contentEl_||this.el_};t.id=function(){return this.id_};t.name=function(){return this.name_};t.children=function(){return this.children_};t.getChildById=function(e){return this.childIndex_[e]};t.getChild=function(e){if(!e)return;return this.childNameIndex_[e]};t.getDescendant=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t=t.reduce((function(e,t){return e.concat(t)}),[]);var r=this;for(var n=0;n<t.length;n++){r=r.getChild(t[n]);if(!r||!r.getChild)return}return r};t.addChild=function(t,i,r){if(void 0===i)i={};if(void 0===r)r=this.children_.length;var n;var a;if("string"===typeof t){a=Gt(t);var s=i.componentClass||a;i.name=a;var o=e.getComponent(s);if(!o)throw new Error("Component "+s+" does not exist");if("function"!==typeof o)return null;n=new o(this.player_||this,i)}else n=t;if(n.parentComponent_)n.parentComponent_.removeChild(n);this.children_.splice(r,0,n);n.parentComponent_=this;if("function"===typeof n.id)this.childIndex_[n.id()]=n;a=a||n.name&&Gt(n.name());if(a){this.childNameIndex_[a]=n;this.childNameIndex_[zt(a)]=n}if("function"===typeof n.el&&n.el()){var u=null;if(this.children_[r+1])if(this.children_[r+1].el_)u=this.children_[r+1].el_;else if(Ie(this.children_[r+1]))u=this.children_[r+1];this.contentEl().insertBefore(n.el(),u)}return n};t.removeChild=function(e){if("string"===typeof e)e=this.getChild(e);if(!e||!this.children_)return;var t=false;for(var i=this.children_.length-1;i>=0;i--)if(this.children_[i]===e){t=true;this.children_.splice(i,1);break}if(!t)return;e.parentComponent_=null;this.childIndex_[e.id()]=null;this.childNameIndex_[Gt(e.name())]=null;this.childNameIndex_[zt(e.name())]=null;var r=e.el();if(r&&r.parentNode===this.contentEl())this.contentEl().removeChild(e.el())};t.initChildren=function(){var t=this;var i=this.options_.children;if(i){var r=this.options_;var n=function(e){var i=e.name;var n=e.opts;if(void 0!==r[i])n=r[i];if(false===n)return;if(true===n)n={};n.playerOptions=t.options_.playerOptions;var a=t.addChild(i,n);if(a)t[i]=a};var a;var s=e.getComponent("Tech");if(Array.isArray(i))a=i;else a=Object.keys(i);a.concat(Object.keys(this.options_).filter((function(e){return!a.some((function(t){if("string"===typeof t)return e===t;return e===t.name}))}))).map((function(e){var r;var n;if("string"===typeof e){r=e;n=i[r]||t.options_[r]||{}}else{r=e.name;n=e}return{name:r,opts:n}})).filter((function(t){var i=e.getComponent(t.opts.componentClass||Gt(t.name));return i&&!s.isTech(i)})).forEach(n)}};t.buildCSSClass=function(){return""};t.ready=function(e,t){if(void 0===t)t=false;if(!e)return;if(!this.isReady_){this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(e);return}if(t)e.call(this);else this.setTimeout(e,1)};t.triggerReady=function(){this.isReady_=true;this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[];if(e&&e.length>0)e.forEach((function(e){e.call(this)}),this);this.trigger("ready")}),1)};t.$=function(e,t){return Je(e,t||this.contentEl())};t.$$=function(e,t){return et(e,t||this.contentEl())};t.hasClass=function(e){return De(this.el_,e)};t.addClass=function(e){Me(this.el_,e)};t.removeClass=function(e){Re(this.el_,e)};t.toggleClass=function(e,t){Ue(this.el_,e,t)};t.show=function(){this.removeClass("vjs-hidden")};t.hide=function(){this.addClass("vjs-hidden")};t.lockShowing=function(){this.addClass("vjs-lock-showing")};t.unlockShowing=function(){this.removeClass("vjs-lock-showing")};t.getAttribute=function(e){return Fe(this.el_,e)};t.setAttribute=function(e,t){je(this.el_,e,t)};t.removeAttribute=function(e){He(this.el_,e)};t.width=function(e,t){return this.dimension("width",e,t)};t.height=function(e,t){return this.dimension("height",e,t)};t.dimensions=function(e,t){this.width(e,true);this.height(t)};t.dimension=function(e,t,i){if(void 0!==t){if(null===t||t!==t)t=0;if(-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px"))this.el_.style[e]=t;else if("auto"===t)this.el_.style[e]="";else this.el_.style[e]=t+"px";if(!i)this.trigger("componentresize");return}if(!this.el_)return 0;var r=this.el_.style[e];var n=r.indexOf("px");if(-1!==n)return parseInt(r.slice(0,n),10);return parseInt(this.el_["offset"+Gt(e)],10)};t.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");t=te(this.el_,e);t=parseFloat(t);if(0===t||isNaN(t)){var i="offset"+Gt(e);t=this.el_[i]}return t};t.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}};t.currentWidth=function(){return this.currentDimension("width")};t.currentHeight=function(){return this.currentDimension("height")};t.focus=function(){this.el_.focus()};t.blur=function(){this.el_.blur()};t.handleKeyDown=function(e){if(this.player_){if(!l().isEventKey(e,"Tab"))e.stopPropagation();this.player_.handleKeyDown(e)}};t.handleKeyPress=function(e){this.handleKeyDown(e)};t.emitTapEvents=function(){var e=0;var t=null;var i=10;var r=200;var a;this.on("touchstart",(function(i){if(1===i.touches.length){t={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY};e=n().performance.now();a=true}}));this.on("touchmove",(function(e){if(e.touches.length>1)a=false;else if(t){var r=e.touches[0].pageX-t.pageX;var n=e.touches[0].pageY-t.pageY;var s=Math.sqrt(r*r+n*n);if(s>i)a=false}}));var s=function(){a=false};this.on("touchleave",s);this.on("touchcancel",s);this.on("touchend",(function(i){t=null;if(true===a){var s=n().performance.now()-e;if(s<r){i.preventDefault();this.trigger("tap")}}}))};t.enableTouchActivity=function(){if(!this.player()||!this.player().reportUserActivity)return;var e=It(this.player(),this.player().reportUserActivity);var t;this.on("touchstart",(function(){e();this.clearInterval(t);t=this.setInterval(e,250)}));var i=function(i){e();this.clearInterval(t)};this.on("touchmove",e);this.on("touchend",i);this.on("touchcancel",i)};t.setTimeout=function(e,t){var i=this;var r;e=It(this,e);this.clearTimersOnDispose_();r=n().setTimeout((function(){if(i.setTimeoutIds_.has(r))i.setTimeoutIds_["delete"](r);e()}),t);this.setTimeoutIds_.add(r);return r};t.clearTimeout=function(e){if(this.setTimeoutIds_.has(e)){this.setTimeoutIds_["delete"](e);n().clearTimeout(e)}return e};t.setInterval=function(e,t){e=It(this,e);this.clearTimersOnDispose_();var i=n().setInterval(e,t);this.setIntervalIds_.add(i);return i};t.clearInterval=function(e){if(this.setIntervalIds_.has(e)){this.setIntervalIds_["delete"](e);n().clearInterval(e)}return e};t.requestAnimationFrame=function(e){var t=this;if(!this.supportsRaf_)return this.setTimeout(e,1e3/60);this.clearTimersOnDispose_();var i;e=It(this,e);i=n().requestAnimationFrame((function(){if(t.rafIds_.has(i))t.rafIds_["delete"](i);e()}));this.rafIds_.add(i);return i};t.requestNamedAnimationFrame=function(e,t){var i=this;if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_();t=It(this,t);var r=this.requestAnimationFrame((function(){t();if(i.namedRafs_.has(e))i.namedRafs_["delete"](e)}));this.namedRafs_.set(e,r);return e};t.cancelNamedAnimationFrame=function(e){if(!this.namedRafs_.has(e))return;this.cancelAnimationFrame(this.namedRafs_.get(e));this.namedRafs_["delete"](e)};t.cancelAnimationFrame=function(e){if(!this.supportsRaf_)return this.clearTimeout(e);if(this.rafIds_.has(e)){this.rafIds_["delete"](e);n().cancelAnimationFrame(e)}return e};t.clearTimersOnDispose_=function(){var e=this;if(this.clearingTimersOnDispose_)return;this.clearingTimersOnDispose_=true;this.one("dispose",(function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(t){var i=t[0],r=t[1];e[i].forEach((function(t,i){return e[r](i)}))}));e.clearingTimersOnDispose_=false}))};e.registerComponent=function(t,i){if("string"!==typeof t||!t)throw new Error('Illegal component name, "'+t+'"; must be a non-empty string.');var r=e.getComponent("Tech");var n=r&&r.isTech(i);var a=e===i||e.prototype.isPrototypeOf(i.prototype);if(n||!a){var s;if(n)s="techs must be registered using Tech.registerTech()";else s="must be a Component subclass";throw new Error('Illegal component, "'+t+'"; '+s+".")}t=Gt(t);if(!e.components_)e.components_={};var o=e.getComponent("Player");if("Player"===t&&o&&o.players){var u=o.players;var l=Object.keys(u);if(u&&l.length>0&&l.map((function(e){return u[e]})).every(Boolean))throw new Error("Can not register Player component after player has been created.")}e.components_[t]=i;e.components_[zt(t)]=i;return i};e.getComponent=function(t){if(!t||!e.components_)return;return e.components_[t]};return e}();Jt.prototype.supportsRaf_="function"===typeof n().requestAnimationFrame&&"function"===typeof n().cancelAnimationFrame;Jt.registerComponent("Component",Jt);function ei(e,t,i){if("number"!==typeof t||t<0||t>i)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+i+").")}function ti(e,t,i,r){ei(e,r,i.length-1);return i[r][t]}function ii(e){var t;if(void 0===e||0===e.length)t={length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}};else t={length:e.length,start:ti.bind(null,"start",0,e),end:ti.bind(null,"end",1,e)};if(n().Symbol&&n().Symbol.iterator)t[n().Symbol.iterator]=function(){return(e||[]).values()};return t}function ri(e,t){if(Array.isArray(e))return ii(e);else if(void 0===e||void 0===t)return ii();return ii([[e,t]])}function ni(e,t){var i=0;var r;var n;if(!t)return 0;if(!e||!e.length)e=ri(0,0);for(var a=0;a<e.length;a++){r=e.start(a);n=e.end(a);if(n>t)n=t;i+=n-r}return i/t}function ai(e){if(e instanceof ai)return e;if("number"===typeof e)this.code=e;else if("string"===typeof e)this.message=e;else if(J(e)){if("number"===typeof e.code)this.code=e.code;$(this,e)}if(!this.message)this.message=ai.defaultMessages[this.code]||""}ai.prototype.code=0;ai.prototype.message="";ai.prototype.status=null;ai.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];ai.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var si=0;si<ai.errorTypes.length;si++){ai[ai.errorTypes[si]]=si;ai.prototype[ai.errorTypes[si]]=si}function oi(e){return void 0!==e&&null!==e&&"function"===typeof e.then}function ui(e){if(oi(e))e.then(null,(function(e){}))}var li=function(e){var t=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(t,i,r){if(e[i])t[i]=e[i];return t}),{cues:e.cues&&Array.prototype.map.call(e.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))});return t};var di=function(e){var t=e.$$("track");var i=Array.prototype.map.call(t,(function(e){return e.track}));var r=Array.prototype.map.call(t,(function(e){var t=li(e.track);if(e.src)t.src=e.src;return t}));return r.concat(Array.prototype.filter.call(e.textTracks(),(function(e){return-1===i.indexOf(e)})).map(li))};var ci=function(e,t){e.forEach((function(e){var i=t.addRemoteTextTrack(e).track;if(!e.src&&e.cues)e.cues.forEach((function(e){return i.addCue(e)}))}));return t.textTracks()};var hi={textTracksToJson:di,jsonToTextTracks:ci,trackToJson_:li};var fi="vjs-modal-dialog";var pi=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.handleKeyDown_=function(e){return r.handleKeyDown(e)};r.close_=function(e){return r.close(e)};r.opened_=r.hasBeenOpened_=r.hasBeenFilled_=false;r.closeable(!r.options_.uncloseable);r.content(r.options_.content);r.contentEl_=Ae("div",{className:fi+"-content"},{role:"document"});r.descEl_=Ae("p",{className:fi+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")});Le(r.descEl_,r.description());r.el_.appendChild(r.descEl_);r.el_.appendChild(r.contentEl_);return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})};i.dispose=function(){this.contentEl_=null;this.descEl_=null;this.previouslyActiveEl_=null;e.prototype.dispose.call(this)};i.buildCSSClass=function(){return fi+" vjs-hidden "+e.prototype.buildCSSClass.call(this)};i.label=function(){return this.localize(this.options_.label||"Modal Window")};i.description=function(){var e=this.options_.description||this.localize("This is a modal window.");if(this.closeable())e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.");return e};i.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen");this.opened_=true;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)this.fill();this.wasPlaying_=!e.paused();if(this.options_.pauseOnOpen&&this.wasPlaying_)e.pause();this.on("keydown",this.handleKeyDown_);this.hadControls_=e.controls();e.controls(false);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=true}};i.opened=function(e){if("boolean"===typeof e)this[e?"open":"close"]();return this.opened_};i.close=function(){if(!this.opened_)return;var e=this.player();this.trigger("beforemodalclose");this.opened_=false;if(this.wasPlaying_&&this.options_.pauseOnOpen)e.play();this.off("keydown",this.handleKeyDown_);if(this.hadControls_)e.controls(true);this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();if(this.options_.temporary)this.dispose()};i.closeable=function(e){if("boolean"===typeof e){var t=this.closeable_=!!e;var i=this.getChild("closeButton");if(t&&!i){var r=this.contentEl_;this.contentEl_=this.el_;i=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=r;this.on(i,"close",this.close_)}if(!t&&i){this.off(i,"close",this.close_);this.removeChild(i);i.dispose()}}return this.closeable_};i.fill=function(){this.fillWith(this.content())};i.fillWith=function(e){var t=this.contentEl();var i=t.parentNode;var r=t.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=true;i.removeChild(t);this.empty();Ye(t,e);this.trigger("modalfill");if(r)i.insertBefore(t,r);else i.appendChild(t);var n=this.getChild("closeButton");if(n)i.appendChild(n.el_)};i.empty=function(){this.trigger("beforemodalempty");Ze(this.contentEl());this.trigger("modalempty")};i.content=function(e){if("undefined"!==typeof e)this.content_=e;return this.content_};i.conditionalFocus_=function(){var e=s().activeElement;var t=this.player_.el_;this.previouslyActiveEl_=null;if(t.contains(e)||t===e){this.previouslyActiveEl_=e;this.focus()}};i.conditionalBlur_=function(){if(this.previouslyActiveEl_){this.previouslyActiveEl_.focus();this.previouslyActiveEl_=null}};i.handleKeyDown=function(e){e.stopPropagation();if(l().isEventKey(e,"Escape")&&this.closeable()){e.preventDefault();this.close();return}if(!l().isEventKey(e,"Tab"))return;var t=this.focusableEls_();var i=this.el_.querySelector(":focus");var r;for(var n=0;n<t.length;n++)if(i===t[n]){r=n;break}if(s().activeElement===this.el_)r=0;if(e.shiftKey&&0===r){t[t.length-1].focus();e.preventDefault()}else if(!e.shiftKey&&r===t.length-1){t[0].focus();e.preventDefault()}};i.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,(function(e){return(e instanceof n().HTMLAnchorElement||e instanceof n().HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof n().HTMLInputElement||e instanceof n().HTMLSelectElement||e instanceof n().HTMLTextAreaElement||e instanceof n().HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof n().HTMLIFrameElement||e instanceof n().HTMLObjectElement||e instanceof n().HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")}))};return t}(Jt);pi.prototype.options_={pauseOnOpen:true,temporary:true};Jt.registerComponent("ModalDialog",pi);var mi=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t=[];i=e.call(this)||this;i.tracks_=[];Object.defineProperty((0,d.Z)(i),"length",{get:function(){return this.tracks_.length}});for(var r=0;r<t.length;r++)i.addTrack(t[r]);return i}var i=t.prototype;i.addTrack=function(e){var t=this;var i=this.tracks_.length;if(!(""+i in this))Object.defineProperty(this,i,{get:function(){return this.tracks_[i]}});if(-1===this.tracks_.indexOf(e)){this.tracks_.push(e);this.trigger({track:e,type:"addtrack",target:this})}e.labelchange_=function(){t.trigger({track:e,type:"labelchange",target:t})};if(Dt(e))e.addEventListener("labelchange",e.labelchange_)};i.removeTrack=function(e){var t;for(var i=0,r=this.length;i<r;i++)if(this[i]===e){t=this[i];if(t.off)t.off();this.tracks_.splice(i,1);break}if(!t)return;this.trigger({track:t,type:"removetrack",target:this})};i.getTrackById=function(e){var t=null;for(var i=0,r=this.length;i<r;i++){var n=this[i];if(n.id===e){t=n;break}}return t};return t}(At);mi.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(var vi in mi.prototype.allowedEvents_)mi.prototype["on"+vi]=null;var gi=function(e,t){for(var i=0;i<e.length;i++){if(!Object.keys(e[i]).length||t.id===e[i].id)continue;e[i].enabled=false}};var _i=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t=[];for(var r=t.length-1;r>=0;r--)if(t[r].enabled){gi(t,t[r]);break}i=e.call(this,t)||this;i.changing_=false;return i}var i=t.prototype;i.addTrack=function(t){var i=this;if(t.enabled)gi(this,t);e.prototype.addTrack.call(this,t);if(!t.addEventListener)return;t.enabledChange_=function(){if(i.changing_)return;i.changing_=true;gi(i,t);i.changing_=false;i.trigger("change")};t.addEventListener("enabledchange",t.enabledChange_)};i.removeTrack=function(t){e.prototype.removeTrack.call(this,t);if(t.removeEventListener&&t.enabledChange_){t.removeEventListener("enabledchange",t.enabledChange_);t.enabledChange_=null}};return t}(mi);var yi=function(e,t){for(var i=0;i<e.length;i++){if(!Object.keys(e[i]).length||t.id===e[i].id)continue;e[i].selected=false}};var Ti=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t=[];for(var r=t.length-1;r>=0;r--)if(t[r].selected){yi(t,t[r]);break}i=e.call(this,t)||this;i.changing_=false;Object.defineProperty((0,d.Z)(i),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}});return i}var i=t.prototype;i.addTrack=function(t){var i=this;if(t.selected)yi(this,t);e.prototype.addTrack.call(this,t);if(!t.addEventListener)return;t.selectedChange_=function(){if(i.changing_)return;i.changing_=true;yi(i,t);i.changing_=false;i.trigger("change")};t.addEventListener("selectedchange",t.selectedChange_)};i.removeTrack=function(t){e.prototype.removeTrack.call(this,t);if(t.removeEventListener&&t.selectedChange_){t.removeEventListener("selectedchange",t.selectedChange_);t.selectedChange_=null}};return t}(mi);var bi=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.addTrack=function(t){var i=this;e.prototype.addTrack.call(this,t);if(!this.queueChange_)this.queueChange_=function(){return i.queueTrigger("change")};if(!this.triggerSelectedlanguagechange)this.triggerSelectedlanguagechange_=function(){return i.trigger("selectedlanguagechange")};t.addEventListener("modechange",this.queueChange_);var r=["metadata","chapters"];if(-1===r.indexOf(t.kind))t.addEventListener("modechange",this.triggerSelectedlanguagechange_)};i.removeTrack=function(t){e.prototype.removeTrack.call(this,t);if(t.removeEventListener){if(this.queueChange_)t.removeEventListener("modechange",this.queueChange_);if(this.selectedlanguagechange_)t.removeEventListener("modechange",this.triggerSelectedlanguagechange_)}};return t}(mi);var Si=function(){function e(e){if(void 0===e)e=[];this.trackElements_=[];Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}var t=e.prototype;t.addTrackElement_=function(e){var t=this.trackElements_.length;if(!(""+t in this))Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}});if(-1===this.trackElements_.indexOf(e))this.trackElements_.push(e)};t.getTrackElementByTrack_=function(e){var t;for(var i=0,r=this.trackElements_.length;i<r;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t};t.removeTrackElement_=function(e){for(var t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){if(this.trackElements_[t].track&&"function"===typeof this.trackElements_[t].track.off)this.trackElements_[t].track.off();if("function"===typeof this.trackElements_[t].off)this.trackElements_[t].off();this.trackElements_.splice(t,1);break}};return e}();var ki=function(){function e(t){e.prototype.setCues_.call(this,t);Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;t.setCues_=function(e){var t=this.length||0;var i=0;var r=e.length;this.cues_=e;this.length_=e.length;var n=function(e){if(!(""+e in this))Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<r){i=t;for(;i<r;i++)n.call(this,i)}};t.getCueById=function(e){var t=null;for(var i=0,r=this.length;i<r;i++){var n=this[i];if(n.id===e){t=n;break}}return t};return e}();var Ci={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"};var Ei={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"};var wi={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};var Ii={disabled:"disabled",hidden:"hidden",showing:"showing"};var xi=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t={};i=e.call(this)||this;var r={id:t.id||"vjs_track_"+ct(),kind:t.kind||"",language:t.language||""};var n=t.label||"";var a=function(e){Object.defineProperty((0,d.Z)(i),e,{get:function(){return r[e]},set:function(){}})};for(var s in r)a(s);Object.defineProperty((0,d.Z)(i),"label",{get:function(){return n},set:function(e){if(e!==n){n=e;this.trigger("labelchange")}}});return i}return t}(At);var Pi=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"];var i=s().createElement("a");i.href=e;var r={};for(var a=0;a<t.length;a++)r[t[a]]=i[t[a]];if("http:"===r.protocol)r.host=r.host.replace(/:80$/,"");if("https:"===r.protocol)r.host=r.host.replace(/:443$/,"");if(!r.protocol)r.protocol=n().location.protocol;if(!r.host)r.host=n().location.host;return r};var Ai=function(e){if(!e.match(/^https?:\/\//)){var t=s().createElement("a");t.href=e;e=t.href}return e};var Li=function(e){if("string"===typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/;var i=t.exec(e);if(i)return i.pop().toLowerCase()}return""};var Oi=function(e,t){if(void 0===t)t=n().location;var i=Pi(e);var r=":"===i.protocol?t.protocol:i.protocol;var a=r+i.host!==t.protocol+t.host;return a};var Di=Object.freeze({__proto__:null,parseUrl:Pi,getAbsoluteURL:Ai,getFileExtension:Li,isCrossOrigin:Oi});var Mi=function(e,t){var i=new(n().WebVTT.Parser)(n(),n().vttjs,n().WebVTT.StringDecoder());var r=[];i.oncue=function(e){t.addCue(e)};i.onparsingerror=function(e){r.push(e)};i.onflush=function(){t.trigger({type:"loadeddata",target:t})};i.parse(e);if(r.length>0){if(n().console&&n().console.groupCollapsed)n().console.groupCollapsed("Text Track parsing errors for "+t.src);r.forEach((function(e){return G.error(e)}));if(n().console&&n().console.groupEnd)n().console.groupEnd()}i.flush()};var Ri=function(e,t){var i={uri:e};var r=Oi(e);if(r)i.cors=r;var a="use-credentials"===t.tech_.crossOrigin();if(a)i.withCredentials=a;m()(i,It(this,(function(e,i,r){if(e)return G.error(e,i);t.loaded_=true;if("function"!==typeof n().WebVTT){if(t.tech_)t.tech_.any(["vttjsloaded","vttjserror"],(function(e){if("vttjserror"===e.type){G.error("vttjs failed to load, stopping trying to process "+t.src);return}return Mi(r,t)}))}else Mi(r,t)})))};var Ui=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t={};if(!t.tech)throw new Error("A tech was not provided.");var r=Zt(t,{kind:wi[t.kind]||"subtitles",language:t.language||t.srclang||""});var n=Ii[r.mode]||"disabled";var a=r["default"];if("metadata"===r.kind||"chapters"===r.kind)n="hidden";i=e.call(this,r)||this;i.tech_=r.tech;i.cues_=[];i.activeCues_=[];i.preload_=false!==i.tech_.preloadTextTracks;var s=new ki(i.cues_);var o=new ki(i.activeCues_);var u=false;i.timeupdateHandler=It((0,d.Z)(i),(function(){if(this.tech_.isDisposed())return;if(!this.tech_.isReady_){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler);return}this.activeCues=this.activeCues;if(u){this.trigger("cuechange");u=false}this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)}));var l=function(){i.stopTracking()};i.tech_.one("dispose",l);if("disabled"!==n)i.startTracking();Object.defineProperties((0,d.Z)(i),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return n},set:function(e){if(!Ii[e])return;if(n===e)return;n=e;if(!this.preload_&&"disabled"!==n&&0===this.cues.length)Ri(this.src,this);this.stopTracking();if("disabled"!==n)this.startTracking();this.trigger("modechange")}},cues:{get:function(){if(!this.loaded_)return null;return s},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return o;var e=this.tech_.currentTime();var t=[];for(var i=0,r=this.cues.length;i<r;i++){var n=this.cues[i];if(n.startTime<=e&&n.endTime>=e)t.push(n);else if(n.startTime===n.endTime&&n.startTime<=e&&n.startTime+.5>=e)t.push(n)}u=false;if(t.length!==this.activeCues_.length)u=true;else for(var a=0;a<t.length;a++)if(-1===this.activeCues_.indexOf(t[a]))u=true;this.activeCues_=t;o.setCues_(this.activeCues_);return o},set:function(){}}});if(r.src){i.src=r.src;if(!i.preload_)i.loaded_=true;if(i.preload_||"subtitles"!==r.kind&&"captions"!==r.kind)Ri(i.src,(0,d.Z)(i))}else i.loaded_=true;return i}var i=t.prototype;i.startTracking=function(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)};i.stopTracking=function(){if(this.rvf_){this.tech_.cancelVideoFrameCallback(this.rvf_);this.rvf_=void 0}};i.addCue=function(e){var t=e;if(n().vttjs&&!(e instanceof n().vttjs.VTTCue)){t=new(n().vttjs.VTTCue)(e.startTime,e.endTime,e.text);for(var i in e)if(!(i in t))t[i]=e[i];t.id=e.id;t.originalCue_=e}var r=this.tech_.textTracks();for(var a=0;a<r.length;a++)if(r[a]!==this)r[a].removeCue(t);this.cues_.push(t);this.cues.setCues_(this.cues_)};i.removeCue=function(e){var t=this.cues_.length;while(t--){var i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1);this.cues.setCues_(this.cues_);break}}};return t}(xi);Ui.prototype.allowedEvents_={cuechange:"cuechange"};var Bi=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t={};var r=Zt(t,{kind:Ei[t.kind]||""});i=e.call(this,r)||this;var n=false;Object.defineProperty((0,d.Z)(i),"enabled",{get:function(){return n},set:function(e){if("boolean"!==typeof e||e===n)return;n=e;this.trigger("enabledchange")}});if(r.enabled)i.enabled=r.enabled;i.loaded_=true;return i}return t}(xi);var Ni=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t={};var r=Zt(t,{kind:Ci[t.kind]||""});i=e.call(this,r)||this;var n=false;Object.defineProperty((0,d.Z)(i),"selected",{get:function(){return n},set:function(e){if("boolean"!==typeof e||e===n)return;n=e;this.trigger("selectedchange")}});if(r.selected)i.selected=r.selected;return i}return t}(xi);var Fi=0;var ji=1;var Hi=2;var qi=3;var Vi=function(e){(0,c.Z)(t,e);function t(t){var i;if(void 0===t)t={};i=e.call(this)||this;var r;var n=new Ui(t);i.kind=n.kind;i.src=n.src;i.srclang=n.language;i.label=n.label;i["default"]=n["default"];Object.defineProperties((0,d.Z)(i),{readyState:{get:function(){return r}},track:{get:function(){return n}}});r=Fi;n.addEventListener("loadeddata",(function(){r=Hi;i.trigger({type:"load",target:(0,d.Z)(i)})}));return i}return t}(At);Vi.prototype.allowedEvents_={load:"load"};Vi.NONE=Fi;Vi.LOADING=ji;Vi.LOADED=Hi;Vi.ERROR=qi;var Wi={audio:{ListClass:_i,TrackClass:Bi,capitalName:"Audio"},video:{ListClass:Ti,TrackClass:Ni,capitalName:"Video"},text:{ListClass:bi,TrackClass:Ui,capitalName:"Text"}};Object.keys(Wi).forEach((function(e){Wi[e].getterName=e+"Tracks";Wi[e].privateName=e+"Tracks_"}));var zi={remoteText:{ListClass:bi,TrackClass:Ui,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Si,TrackClass:Vi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}};var Gi=(0,o.Z)({},Wi,zi);zi.names=Object.keys(zi);Wi.names=Object.keys(Wi);Gi.names=[].concat(zi.names).concat(Wi.names);function Ki(e,t,i,r,n){if(void 0===n)n={};var a=e.textTracks();n.kind=t;if(i)n.label=i;if(r)n.language=r;n.tech=e;var s=new Gi.text.TrackClass(n);a.addTrack(s);return s}var Zi=function(e){(0,c.Z)(t,e);function t(t,i){var r;if(void 0===t)t={};if(void 0===i)i=function(){};t.reportTouchActivity=false;r=e.call(this,null,t,i)||this;r.onDurationChange_=function(e){return r.onDurationChange(e)};r.trackProgress_=function(e){return r.trackProgress(e)};r.trackCurrentTime_=function(e){return r.trackCurrentTime(e)};r.stopTrackingCurrentTime_=function(e){return r.stopTrackingCurrentTime(e)};r.disposeSourceHandler_=function(e){return r.disposeSourceHandler(e)};r.queuedHanders_=new Set;r.hasStarted_=false;r.on("playing",(function(){this.hasStarted_=true}));r.on("loadstart",(function(){this.hasStarted_=false}));Gi.names.forEach((function(e){var i=Gi[e];if(t&&t[i.getterName])r[i.privateName]=t[i.getterName]}));if(!r.featuresProgressEvents)r.manualProgressOn();if(!r.featuresTimeupdateEvents)r.manualTimeUpdatesOn();["Text","Audio","Video"].forEach((function(e){if(false===t["native"+e+"Tracks"])r["featuresNative"+e+"Tracks"]=false}));if(false===t.nativeCaptions||false===t.nativeTextTracks)r.featuresNativeTextTracks=false;else if(true===t.nativeCaptions||true===t.nativeTextTracks)r.featuresNativeTextTracks=true;if(!r.featuresNativeTextTracks)r.emulateTextTracks();r.preloadTextTracks=false!==t.preloadTextTracks;r.autoRemoteTextTracks_=new Gi.text.ListClass;r.initTrackListeners();if(!t.nativeControlsForTouch)r.emitTapEvents();if(r.constructor)r.name_=r.constructor.name||"Unknown Tech";return r}var i=t.prototype;i.triggerSourceset=function(e){var t=this;if(!this.isReady_)this.one("ready",(function(){return t.setTimeout((function(){return t.triggerSourceset(e)}),1)}));this.trigger({src:e,type:"sourceset"})};i.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_);this.manualProgress=true;this.one("ready",this.trackProgress_)};i.manualProgressOff=function(){this.manualProgress=false;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange_)};i.trackProgress=function(e){this.stopTrackingProgress();this.progressInterval=this.setInterval(It(this,(function(){var e=this.bufferedPercent();if(this.bufferedPercent_!==e)this.trigger("progress");this.bufferedPercent_=e;if(1===e)this.stopTrackingProgress()})),500)};i.onDurationChange=function(e){this.duration_=this.duration()};i.buffered=function(){return ri(0,0)};i.bufferedPercent=function(){return ni(this.buffered(),this.duration_)};i.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)};i.manualTimeUpdatesOn=function(){this.manualTimeUpdates=true;this.on("play",this.trackCurrentTime_);this.on("pause",this.stopTrackingCurrentTime_)};i.manualTimeUpdatesOff=function(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime_);this.off("pause",this.stopTrackingCurrentTime_)};i.trackCurrentTime=function(){if(this.currentTimeInterval)this.stopTrackingCurrentTime();this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})}),250)};i.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})};i.dispose=function(){this.clearTracks(Wi.names);if(this.manualProgress)this.manualProgressOff();if(this.manualTimeUpdates)this.manualTimeUpdatesOff();e.prototype.dispose.call(this)};i.clearTracks=function(e){var t=this;e=[].concat(e);e.forEach((function(e){var i=t[e+"Tracks"]()||[];var r=i.length;while(r--){var n=i[r];if("text"===e)t.removeRemoteTextTrack(n);i.removeTrack(n)}}))};i.cleanupAutoTextTracks=function(){var e=this.autoRemoteTextTracks_||[];var t=e.length;while(t--){var i=e[t];this.removeRemoteTextTrack(i)}};i.reset=function(){};i.crossOrigin=function(){};i.setCrossOrigin=function(){};i.error=function(e){if(void 0!==e){this.error_=new ai(e);this.trigger("error")}return this.error_};i.played=function(){if(this.hasStarted_)return ri(0,0);return ri()};i.play=function(){};i.setScrubbing=function(){};i.scrubbing=function(){};i.setCurrentTime=function(){if(this.manualTimeUpdates)this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})};i.initTrackListeners=function(){var e=this;Wi.names.forEach((function(t){var i=Wi[t];var r=function(){e.trigger(t+"trackchange")};var n=e[i.getterName]();n.addEventListener("removetrack",r);n.addEventListener("addtrack",r);e.on("dispose",(function(){n.removeEventListener("removetrack",r);n.removeEventListener("addtrack",r)}))}))};i.addWebVttScript_=function(){var e=this;if(n().WebVTT)return;if(s().body.contains(this.el())){if(!this.options_["vtt.js"]&&ee(g())&&Object.keys(g()).length>0){this.trigger("vttjsloaded");return}var t=s().createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js";t.onload=function(){e.trigger("vttjsloaded")};t.onerror=function(){e.trigger("vttjserror")};this.on("dispose",(function(){t.onload=null;t.onerror=null}));n().WebVTT=true;this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)};i.emulateTextTracks=function(){var e=this;var t=this.textTracks();var i=this.remoteTextTracks();var r=function(e){return t.addTrack(e.track)};var n=function(e){return t.removeTrack(e.track)};i.on("addtrack",r);i.on("removetrack",n);this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")};var s=function(){a();for(var e=0;e<t.length;e++){var i=t[e];i.removeEventListener("cuechange",a);if("showing"===i.mode)i.addEventListener("cuechange",a)}};s();t.addEventListener("change",s);t.addEventListener("addtrack",s);t.addEventListener("removetrack",s);this.on("dispose",(function(){i.off("addtrack",r);i.off("removetrack",n);t.removeEventListener("change",s);t.removeEventListener("addtrack",s);t.removeEventListener("removetrack",s);for(var e=0;e<t.length;e++){var o=t[e];o.removeEventListener("cuechange",a)}}))};i.addTextTrack=function(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return Ki(this,e,t,i)};i.createRemoteTextTrack=function(e){var t=Zt(e,{tech:this});return new zi.remoteTextEl.TrackClass(t)};i.addRemoteTextTrack=function(e,t){var i=this;if(void 0===e)e={};var r=this.createRemoteTextTrack(e);if(true!==t&&false!==t){G.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js');t=true}this.remoteTextTrackEls().addTrackElement_(r);this.remoteTextTracks().addTrack(r.track);if(true!==t)this.ready((function(){return i.autoRemoteTextTracks_.addTrack(r.track)}));return r};i.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t);this.remoteTextTracks().removeTrack(e);this.autoRemoteTextTracks_.removeTrack(e)};i.getVideoPlaybackQuality=function(){return{}};i.requestPictureInPicture=function(){var e=this.options_.Promise||n().Promise;if(e)return e.reject()};i.disablePictureInPicture=function(){return true};i.setDisablePictureInPicture=function(){};i.requestVideoFrameCallback=function(e){var t=this;var i=ct();if(this.paused()){this.queuedHanders_.add(i);this.one("playing",(function(){if(t.queuedHanders_.has(i)){t.queuedHanders_["delete"](i);e()}}))}else this.requestNamedAnimationFrame(i,e);return i};i.cancelVideoFrameCallback=function(e){if(this.queuedHanders_.has(e))this.queuedHanders_["delete"](e);else this.cancelNamedAnimationFrame(e)};i.setPoster=function(){};i.playsinline=function(){};i.setPlaysinline=function(){};i.overrideNativeAudioTracks=function(){};i.overrideNativeVideoTracks=function(){};i.canPlayType=function(){return""};t.canPlayType=function(){return""};t.canPlaySource=function(e,i){return t.canPlayType(e.type)};t.isTech=function(e){return e.prototype instanceof t||e instanceof t||e===t};t.registerTech=function(e,i){if(!t.techs_)t.techs_={};if(!t.isTech(i))throw new Error("Tech "+e+" must be a Tech");if(!t.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!t.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");e=Gt(e);t.techs_[e]=i;t.techs_[zt(e)]=i;if("Tech"!==e)t.defaultTechOrder_.push(e);return i};t.getTech=function(e){if(!e)return;if(t.techs_&&t.techs_[e])return t.techs_[e];e=Gt(e);if(n()&&n().videojs&&n().videojs[e]){G.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return n().videojs[e]}};return t}(Jt);Gi.names.forEach((function(e){var t=Gi[e];Zi.prototype[t.getterName]=function(){this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}}));Zi.prototype.featuresVolumeControl=true;Zi.prototype.featuresMuteControl=true;Zi.prototype.featuresFullscreenResize=false;Zi.prototype.featuresPlaybackRate=false;Zi.prototype.featuresProgressEvents=false;Zi.prototype.featuresSourceset=false;Zi.prototype.featuresTimeupdateEvents=false;Zi.prototype.featuresNativeTextTracks=false;Zi.prototype.featuresVideoFrameCallback=false;Zi.withSourceHandlers=function(e){e.registerSourceHandler=function(t,i){var r=e.sourceHandlers;if(!r)r=e.sourceHandlers=[];if(void 0===i)i=r.length;r.splice(i,0,t)};e.canPlayType=function(t){var i=e.sourceHandlers||[];var r;for(var n=0;n<i.length;n++){r=i[n].canPlayType(t);if(r)return r}return""};e.selectSourceHandler=function(t,i){var r=e.sourceHandlers||[];var n;for(var a=0;a<r.length;a++){n=r[a].canHandleSource(t,i);if(n)return r[a]}return null};e.canPlaySource=function(t,i){var r=e.selectSourceHandler(t,i);if(r)return r.canHandleSource(t,i);return""};var t=["seekable","seeking","duration"];t.forEach((function(e){var t=this[e];if("function"!==typeof t)return;this[e]=function(){if(this.sourceHandler_&&this.sourceHandler_[e])return this.sourceHandler_[e].apply(this.sourceHandler_,arguments);return t.apply(this,arguments)}}),e.prototype);e.prototype.setSource=function(t){var i=e.selectSourceHandler(t,this.options_);if(!i)if(e.nativeSourceHandler)i=e.nativeSourceHandler;else G.error("No source handler found for the current source.");this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler_);if(i!==e.nativeSourceHandler)this.currentSource_=t;this.sourceHandler_=i.handleSource(t,this,this.options_);this.one("dispose",this.disposeSourceHandler_)};e.prototype.disposeSourceHandler=function(){if(this.currentSource_){this.clearTracks(["audio","video"]);this.currentSource_=null}this.cleanupAutoTextTracks();if(this.sourceHandler_){if(this.sourceHandler_.dispose)this.sourceHandler_.dispose();this.sourceHandler_=null}}};Jt.registerComponent("Tech",Zi);Zi.registerTech("Tech",Zi);Zi.defaultTechOrder_=[];var Qi={};var Xi={};var Yi={};function $i(e,t){Qi[e]=Qi[e]||[];Qi[e].push(t)}function Ji(e,t,i){e.setTimeout((function(){return cr(t,Qi[t.type],i,e)}),1)}function er(e,t){e.forEach((function(e){return e.setTech&&e.setTech(t)}))}function tr(e,t,i){return e.reduceRight(or(i),t[i]())}function ir(e,t,i,r){return t[i](e.reduce(or(i),r))}function rr(e,t,i,r){if(void 0===r)r=null;var n="call"+Gt(i);var a=e.reduce(or(n),r);var s=a===Yi;var o=s?null:t[i](a);ur(e,i,o,s);return o}var nr={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1};var ar={setCurrentTime:1,setMuted:1,setVolume:1};var sr={play:1,pause:1};function or(e){return function(t,i){if(t===Yi)return Yi;if(i[e])return i[e](t);return t}}function ur(e,t,i,r){for(var n=e.length-1;n>=0;n--){var a=e[n];if(a[t])a[t](r,i)}}function lr(e){Xi[e.id()]=null}function dr(e,t){var i=Xi[e.id()];var r=null;if(void 0===i||null===i){r=t(e);Xi[e.id()]=[[t,r]];return r}for(var n=0;n<i.length;n++){var a=i[n],s=a[0],o=a[1];if(s!==t)continue;r=o}if(null===r){r=t(e);i.push([t,r])}return r}function cr(e,t,i,r,n,a){if(void 0===e)e={};if(void 0===t)t=[];if(void 0===n)n=[];if(void 0===a)a=false;var s=t,o=s[0],u=s.slice(1);if("string"===typeof o)cr(e,Qi[o],i,r,n,a);else if(o){var l=dr(r,o);if(!l.setSource){n.push(l);return cr(e,u,i,r,n,a)}l.setSource($({},e),(function(t,s){if(t)return cr(e,u,i,r,n,a);n.push(l);cr(s,e.type===s.type?u:Qi[s.type],i,r,n,a)}))}else if(u.length)cr(e,u,i,r,n,a);else if(a)i(e,n);else cr(e,Qi["*"],i,r,n,true)}var hr={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"};var fr=function(e){if(void 0===e)e="";var t=Li(e);var i=hr[t.toLowerCase()];return i||""};var pr=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var i=e.cache_.sources.filter((function(e){return e.src===t}));if(i.length)return i[0].type;var r=e.$$("source");for(var n=0;n<r.length;n++){var a=r[n];if(a.type&&a.src&&a.src===t)return a.type}return fr(t)};var mr=function e(t){if(Array.isArray(t)){var i=[];t.forEach((function(t){t=e(t);if(Array.isArray(t))i=i.concat(t);else if(J(t))i.push(t)}));t=i}else if("string"===typeof t&&t.trim())t=[vr({src:t})];else if(J(t)&&"string"===typeof t.src&&t.src&&t.src.trim())t=[vr(t)];else t=[];return t};function vr(e){if(!e.type){var t=fr(e.src);if(t)e.type=t}return e}var gr=function(e){(0,c.Z)(t,e);function t(t,i,r){var n;var a=Zt({createEl:false},i);n=e.call(this,t,a,r)||this;if(!i.playerOptions.sources||0===i.playerOptions.sources.length)for(var s=0,o=i.playerOptions.techOrder;s<o.length;s++){var u=Gt(o[s]);var l=Zi.getTech(u);if(!u)l=Jt.getComponent(u);if(l&&l.isSupported()){t.loadTech_(u);break}}else t.src(i.playerOptions.sources);return n}return t}(Jt);Jt.registerComponent("MediaLoader",gr);var _r=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;if(r.options_.controlText)r.controlText(r.options_.controlText);r.handleMouseOver_=function(e){return r.handleMouseOver(e)};r.handleMouseOut_=function(e){return r.handleMouseOut(e)};r.handleClick_=function(e){return r.handleClick(e)};r.handleKeyDown_=function(e){return r.handleKeyDown(e)};r.emitTapEvents();r.enable();return r}var i=t.prototype;i.createEl=function(e,t,i){if(void 0===e)e="div";if(void 0===t)t={};if(void 0===i)i={};t=$({className:this.buildCSSClass(),tabIndex:0},t);if("button"===e)G.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead.");i=$({role:"button"},i);this.tabIndex_=t.tabIndex;var r=Ae(e,t,i);r.appendChild(Ae("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));this.createControlTextEl(r);return r};i.dispose=function(){this.controlTextEl_=null;e.prototype.dispose.call(this)};i.createControlTextEl=function(e){this.controlTextEl_=Ae("span",{className:"vjs-control-text"},{"aria-live":"polite"});if(e)e.appendChild(this.controlTextEl_);this.controlText(this.controlText_,e);return this.controlTextEl_};i.controlText=function(e,t){if(void 0===t)t=this.el();if(void 0===e)return this.controlText_||"Need Text";var i=this.localize(e);this.controlText_=e;Le(this.controlTextEl_,i);if(!this.nonIconControl&&!this.player_.options_.noUITitleAttributes)t.setAttribute("title",i)};i.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)};i.enable=function(){if(!this.enabled_){this.enabled_=true;this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");if("undefined"!==typeof this.tabIndex_)this.el_.setAttribute("tabIndex",this.tabIndex_);this.on(["tap","click"],this.handleClick_);this.on("keydown",this.handleKeyDown_)}};i.disable=function(){this.enabled_=false;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");if("undefined"!==typeof this.tabIndex_)this.el_.removeAttribute("tabIndex");this.off("mouseover",this.handleMouseOver_);this.off("mouseout",this.handleMouseOut_);this.off(["tap","click"],this.handleClick_);this.off("keydown",this.handleKeyDown_)};i.handleLanguagechange=function(){this.controlText(this.controlText_)};i.handleClick=function(e){if(this.options_.clickHandler)this.options_.clickHandler.call(this,arguments)};i.handleKeyDown=function(t){if(l().isEventKey(t,"Space")||l().isEventKey(t,"Enter")){t.preventDefault();t.stopPropagation();this.trigger("click")}else e.prototype.handleKeyDown.call(this,t)};return t}(Jt);Jt.registerComponent("ClickableComponent",_r);var yr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.update();r.update_=function(e){return r.update(e)};t.on("posterchange",r.update_);return r}var i=t.prototype;i.dispose=function(){this.player().off("posterchange",this.update_);e.prototype.dispose.call(this)};i.createEl=function(){var e=Ae("div",{className:"vjs-poster",tabIndex:-1});return e};i.update=function(e){var t=this.player().poster();this.setSrc(t);if(t)this.show();else this.hide()};i.setSrc=function(e){var t="";if(e)t='url("'+e+'")';this.el_.style.backgroundImage=t};i.handleClick=function(e){if(!this.player_.controls())return;var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;if(this.player_.tech(true)&&!((pe||ce)&&t))this.player_.tech(true).focus();if(this.player_.paused())ui(this.player_.play());else this.player_.pause()};return t}(_r);Jt.registerComponent("PosterImage",yr);var Tr="#222";var br="#ccc";var Sr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function kr(e,t){var i;if(4===e.length)i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else if(7===e.length)i=e.slice(1);else throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function Cr(e,t,i){try{e.style[t]=i}catch(r){return}}var Er=function(e){(0,c.Z)(t,e);function t(t,i,r){var a;a=e.call(this,t,i,r)||this;var s=function(e){return a.updateDisplay(e)};t.on("loadstart",(function(e){return a.toggleDisplay(e)}));t.on("texttrackchange",s);t.on("loadedmetadata",(function(e){return a.preselectTrack(e)}));t.ready(It((0,d.Z)(a),(function(){if(t.tech_&&t.tech_.featuresNativeTextTracks){this.hide();return}t.on("fullscreenchange",s);t.on("playerresize",s);n().addEventListener("orientationchange",s);t.on("dispose",(function(){return n().removeEventListener("orientationchange",s)}));var e=this.options_.playerOptions.tracks||[];for(var i=0;i<e.length;i++)this.player_.addRemoteTextTrack(e[i],true);this.preselectTrack()})));return a}var i=t.prototype;i.preselectTrack=function(){var e={captions:1,subtitles:1};var t=this.player_.textTracks();var i=this.player_.cache_.selectedLanguage;var r;var n;var a;for(var s=0;s<t.length;s++){var o=t[s];if(i&&i.enabled&&i.language&&i.language===o.language&&o.kind in e){if(o.kind===i.kind)a=o;else if(!a)a=o}else if(i&&!i.enabled){a=null;r=null;n=null}else if(o["default"])if("descriptions"===o.kind&&!r)r=o;else if(o.kind in e&&!n)n=o}if(a)a.mode="showing";else if(n)n.mode="showing";else if(r)r.mode="showing"};i.toggleDisplay=function(){if(this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks)this.hide();else this.show()};i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})};i.clearDisplay=function(){if("function"===typeof n().WebVTT)n().WebVTT.processCues(n(),[],this.el_)};i.updateDisplay=function(){var e=this.player_.textTracks();var t=this.options_.allowMultipleShowingTracks;this.clearDisplay();if(t){var i=[];for(var r=0;r<e.length;++r){var n=e[r];if("showing"!==n.mode)continue;i.push(n)}this.updateForTrack(i);return}var a=null;var s=null;var o=e.length;while(o--){var u=e[o];if("showing"===u.mode)if("descriptions"===u.kind)a=u;else s=u}if(s){if("off"!==this.getAttribute("aria-live"))this.setAttribute("aria-live","off");this.updateForTrack(s)}else if(a){if("assertive"!==this.getAttribute("aria-live"))this.setAttribute("aria-live","assertive");this.updateForTrack(a)}};i.updateDisplayState=function(e){var t=this.player_.textTrackSettings.getValues();var i=e.activeCues;var r=i.length;while(r--){var a=i[r];if(!a)continue;var s=a.displayState;if(t.color)s.firstChild.style.color=t.color;if(t.textOpacity)Cr(s.firstChild,"color",kr(t.color||"#fff",t.textOpacity));if(t.backgroundColor)s.firstChild.style.backgroundColor=t.backgroundColor;if(t.backgroundOpacity)Cr(s.firstChild,"backgroundColor",kr(t.backgroundColor||"#000",t.backgroundOpacity));if(t.windowColor)if(t.windowOpacity)Cr(s,"backgroundColor",kr(t.windowColor,t.windowOpacity));else s.style.backgroundColor=t.windowColor;if(t.edgeStyle)if("dropshadow"===t.edgeStyle)s.firstChild.style.textShadow="2px 2px 3px "+Tr+", 2px 2px 4px "+Tr+", 2px 2px 5px "+Tr;else if("raised"===t.edgeStyle)s.firstChild.style.textShadow="1px 1px "+Tr+", 2px 2px "+Tr+", 3px 3px "+Tr;else if("depressed"===t.edgeStyle)s.firstChild.style.textShadow="1px 1px "+br+", 0 1px "+br+", -1px -1px "+Tr+", 0 -1px "+Tr;else if("uniform"===t.edgeStyle)s.firstChild.style.textShadow="0 0 4px "+Tr+", 0 0 4px "+Tr+", 0 0 4px "+Tr+", 0 0 4px "+Tr;if(t.fontPercent&&1!==t.fontPercent){var o=n().parseFloat(s.style.fontSize);s.style.fontSize=o*t.fontPercent+"px";s.style.height="auto";s.style.top="auto"}if(t.fontFamily&&"default"!==t.fontFamily)if("small-caps"===t.fontFamily)s.firstChild.style.fontVariant="small-caps";else s.firstChild.style.fontFamily=Sr[t.fontFamily]}};i.updateForTrack=function(e){if(!Array.isArray(e))e=[e];if("function"!==typeof n().WebVTT||e.every((function(e){return!e.activeCues})))return;var t=[];for(var i=0;i<e.length;++i){var r=e[i];for(var a=0;a<r.activeCues.length;++a)t.push(r.activeCues[a])}n().WebVTT.processCues(n(),t,this.el_);for(var s=0;s<e.length;++s){var o=e[s];for(var u=0;u<o.activeCues.length;++u){var l=o.activeCues[u].displayState;Me(l,"vjs-text-track-cue");Me(l,"vjs-text-track-cue-"+(o.language?o.language:s));if(o.language)je(l,"lang",o.language)}if(this.player_.textTrackSettings)this.updateDisplayState(o)}};return t}(Jt);Jt.registerComponent("TextTrackDisplay",Er);var wr=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.createEl=function(){var t=this.player_.isAudio();var i=this.localize(t?"Audio Player":"Video Player");var r=Ae("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[i])});var n=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});n.appendChild(r);return n};return t}(Jt);Jt.registerComponent("LoadingSpinner",wr);var Ir=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.createEl=function(e,t,i){if(void 0===t)t={};if(void 0===i)i={};e="button";t=$({className:this.buildCSSClass()},t);i=$({type:"button"},i);var r=Ae(e,t,i);r.appendChild(Ae("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));this.createControlTextEl(r);return r};i.addChild=function(e,t){if(void 0===t)t={};var i=this.constructor.name;G.warn("Adding an actionable (user controllable) child to a Button ("+i+") is not supported; use a ClickableComponent instead.");return Jt.prototype.addChild.call(this,e,t)};i.enable=function(){e.prototype.enable.call(this);this.el_.removeAttribute("disabled")};i.disable=function(){e.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")};i.handleKeyDown=function(t){if(l().isEventKey(t,"Space")||l().isEventKey(t,"Enter")){t.stopPropagation();return}e.prototype.handleKeyDown.call(this,t)};return t}(_r);Jt.registerComponent("Button",Ir);var xr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.mouseused_=false;r.on("mousedown",(function(e){return r.handleMouseDown(e)}));return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-big-play-button"};i.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var i=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;ui(t);if(this.player_.tech(true)&&!((pe||ce)&&i))this.player_.tech(true).focus();return}var r=this.player_.getChild("controlBar");var n=r&&r.getChild("playToggle");if(!n){this.player_.tech(true).focus();return}var a=function(){return n.focus()};if(oi(t))t.then(a,(function(){}));else this.setTimeout(a,1)};i.handleKeyDown=function(t){this.mouseused_=false;e.prototype.handleKeyDown.call(this,t)};i.handleMouseDown=function(e){this.mouseused_=true};return t}(Ir);xr.prototype.controlText_="Play Video";Jt.registerComponent("BigPlayButton",xr);var Pr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.controlText(i&&i.controlText||r.localize("Close"));return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)};i.handleClick=function(e){this.trigger({type:"close",bubbles:false})};i.handleKeyDown=function(t){if(l().isEventKey(t,"Esc")){t.preventDefault();t.stopPropagation();this.trigger("click")}else e.prototype.handleKeyDown.call(this,t)};return t}(Ir);Jt.registerComponent("CloseButton",Pr);var Ar=function(e){(0,c.Z)(t,e);function t(t,i){var r;if(void 0===i)i={};r=e.call(this,t,i)||this;i.replay=void 0===i.replay||i.replay;r.on(t,"play",(function(e){return r.handlePlay(e)}));r.on(t,"pause",(function(e){return r.handlePause(e)}));if(i.replay)r.on(t,"ended",(function(e){return r.handleEnded(e)}));return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)};i.handleClick=function(e){if(this.player_.paused())ui(this.player_.play());else this.player_.pause()};i.handleSeeked=function(e){this.removeClass("vjs-ended");if(this.player_.paused())this.handlePause(e);else this.handlePlay(e)};i.handlePlay=function(e){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")};i.handlePause=function(e){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")};i.handleEnded=function(e){var t=this;this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",(function(e){return t.handleSeeked(e)}))};return t}(Ir);Ar.prototype.controlText_="Play";Jt.registerComponent("PlayToggle",Ar);var Lr=function(e,t){e=e<0?0:e;var i=Math.floor(e%60);var r=Math.floor(e/60%60);var n=Math.floor(e/3600);var a=Math.floor(t/60%60);var s=Math.floor(t/3600);if(isNaN(e)||e===1/0)n=r=i="-";n=n>0||s>0?n+":":"";r=((n||a>=10)&&r<10?"0"+r:r)+":";i=i<10?"0"+i:i;return n+r+i};var Or=Lr;function Dr(e){Or=e}function Mr(){Or=Lr}function Rr(e,t){if(void 0===t)t=e;return Or(e,t)}var Ur=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.on(t,["timeupdate","ended"],(function(e){return r.updateContent(e)}));r.updateTextNode_();return r}var i=t.prototype;i.createEl=function(){var t=this.buildCSSClass();var i=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control"});var r=Ae("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+"\xa0"},{role:"presentation"});i.appendChild(r);this.contentEl_=Ae("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"});i.appendChild(this.contentEl_);return i};i.dispose=function(){this.contentEl_=null;this.textNode_=null;e.prototype.dispose.call(this)};i.updateTextNode_=function(e){var t=this;if(void 0===e)e=0;e=Rr(e);if(this.formattedTime_===e)return;this.formattedTime_=e;this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",(function(){if(!t.contentEl_)return;var e=t.textNode_;if(e&&t.contentEl_.firstChild!==e){e=null;G.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")}t.textNode_=s().createTextNode(t.formattedTime_);if(!t.textNode_)return;if(e)t.contentEl_.replaceChild(t.textNode_,e);else t.contentEl_.appendChild(t.textNode_)}))};i.updateContent=function(e){};return t}(Jt);Ur.prototype.labelText_="Time";Ur.prototype.controlText_="Time";Jt.registerComponent("TimeDisplay",Ur);var Br=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.buildCSSClass=function(){return"vjs-current-time"};i.updateContent=function(e){var t;if(this.player_.ended())t=this.player_.duration();else t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateTextNode_(t)};return t}(Ur);Br.prototype.labelText_="Current Time";Br.prototype.controlText_="Current Time";Jt.registerComponent("CurrentTimeDisplay",Br);var Nr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;var n=function(e){return r.updateContent(e)};r.on(t,"durationchange",n);r.on(t,"loadstart",n);r.on(t,"loadedmetadata",n);return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-duration"};i.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)};return t}(Ur);Nr.prototype.labelText_="Duration";Nr.prototype.controlText_="Duration";Jt.registerComponent("DurationDisplay",Nr);var Fr=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":true});var i=e.prototype.createEl.call(this,"div");var r=e.prototype.createEl.call(this,"span",{textContent:"/"});i.appendChild(r);t.appendChild(i);return t};return t}(Jt);Jt.registerComponent("TimeDivider",Fr);var jr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.on(t,"durationchange",(function(e){return r.updateContent(e)}));return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-remaining-time"};i.createEl=function(){var t=e.prototype.createEl.call(this);if(false!==this.options_.displayNegative)t.insertBefore(Ae("span",{},{"aria-hidden":true},"-"),this.contentEl_);return t};i.updateContent=function(e){if("number"!==typeof this.player_.duration())return;var t;if(this.player_.ended())t=0;else if(this.player_.remainingTimeDisplay)t=this.player_.remainingTimeDisplay();else t=this.player_.remainingTime();this.updateTextNode_(t)};return t}(Ur);jr.prototype.labelText_="Remaining Time";jr.prototype.controlText_="Remaining Time";Jt.registerComponent("RemainingTimeDisplay",jr);var Hr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.updateShowing();r.on(r.player(),"durationchange",(function(e){return r.updateShowing(e)}));return r}var i=t.prototype;i.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=Ae("div",{className:"vjs-live-display"},{"aria-live":"off"});this.contentEl_.appendChild(Ae("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+"\xa0"}));this.contentEl_.appendChild(s().createTextNode(this.localize("LIVE")));t.appendChild(this.contentEl_);return t};i.dispose=function(){this.contentEl_=null;e.prototype.dispose.call(this)};i.updateShowing=function(e){if(this.player().duration()===1/0)this.show();else this.hide()};return t}(Jt);Jt.registerComponent("LiveDisplay",Hr);var qr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.updateLiveEdgeStatus();if(r.player_.liveTracker){r.updateLiveEdgeStatusHandler_=function(e){return r.updateLiveEdgeStatus(e)};r.on(r.player_.liveTracker,"liveedgechange",r.updateLiveEdgeStatusHandler_)}return r}var i=t.prototype;i.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});this.textEl_=Ae("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"});t.appendChild(this.textEl_);return t};i.updateLiveEdgeStatus=function(){if(!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()){this.setAttribute("aria-disabled",true);this.addClass("vjs-at-live-edge");this.controlText("Seek to live, currently playing live")}else{this.setAttribute("aria-disabled",false);this.removeClass("vjs-at-live-edge");this.controlText("Seek to live, currently behind live")}};i.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()};i.dispose=function(){if(this.player_.liveTracker)this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_);this.textEl_=null;e.prototype.dispose.call(this)};return t}(Ir);qr.prototype.controlText_="Seek to live, currently playing live";Jt.registerComponent("SeekToLive",qr);var Vr=function(e,t,i){e=Number(e);return Math.min(i,Math.max(t,isNaN(e)?t:e))};var Wr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.handleMouseDown_=function(e){return r.handleMouseDown(e)};r.handleMouseUp_=function(e){return r.handleMouseUp(e)};r.handleKeyDown_=function(e){return r.handleKeyDown(e)};r.handleClick_=function(e){return r.handleClick(e)};r.handleMouseMove_=function(e){return r.handleMouseMove(e)};r.update_=function(e){return r.update(e)};r.bar=r.getChild(r.options_.barName);r.vertical(!!r.options_.vertical);r.enable();return r}var i=t.prototype;i.enabled=function(){return this.enabled_};i.enable=function(){if(this.enabled())return;this.on("mousedown",this.handleMouseDown_);this.on("touchstart",this.handleMouseDown_);this.on("keydown",this.handleKeyDown_);this.on("click",this.handleClick_);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent)this.on(this.player_,this.playerEvent,this.update);this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=true};i.disable=function(){if(!this.enabled())return;var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_);this.off("touchstart",this.handleMouseDown_);this.off("keydown",this.handleKeyDown_);this.off("click",this.handleClick_);this.off(this.player_,"controlsvisible",this.update_);this.off(e,"mousemove",this.handleMouseMove_);this.off(e,"mouseup",this.handleMouseUp_);this.off(e,"touchmove",this.handleMouseMove_);this.off(e,"touchend",this.handleMouseUp_);this.removeAttribute("tabindex");this.addClass("disabled");if(this.playerEvent)this.off(this.player_,this.playerEvent,this.update);this.enabled_=false};i.createEl=function(t,i,r){if(void 0===i)i={};if(void 0===r)r={};i.className=i.className+" vjs-slider";i=$({tabIndex:0},i);r=$({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r);return e.prototype.createEl.call(this,t,i,r)};i.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;if("mousedown"===e.type)e.preventDefault();if("touchstart"===e.type&&!he)e.preventDefault();qe();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(t,"mousemove",this.handleMouseMove_);this.on(t,"mouseup",this.handleMouseUp_);this.on(t,"touchmove",this.handleMouseMove_);this.on(t,"touchend",this.handleMouseUp_);this.handleMouseMove(e,true)};i.handleMouseMove=function(e){};i.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;Ve();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(e,"mousemove",this.handleMouseMove_);this.off(e,"mouseup",this.handleMouseUp_);this.off(e,"touchmove",this.handleMouseMove_);this.off(e,"touchend",this.handleMouseUp_);this.update()};i.update=function(){var e=this;if(!this.el_||!this.bar)return;var t=this.getProgress();if(t===this.progress_)return t;this.progress_=t;this.requestNamedAnimationFrame("Slider#update",(function(){var i=e.vertical()?"height":"width";e.bar.el().style[i]=(100*t).toFixed(2)+"%"}));return t};i.getProgress=function(){return Number(Vr(this.getPercent(),0,1).toFixed(4))};i.calculateDistance=function(e){var t=Ge(this.el_,e);if(this.vertical())return t.y;return t.x};i.handleKeyDown=function(t){if(l().isEventKey(t,"Left")||l().isEventKey(t,"Down")){t.preventDefault();t.stopPropagation();this.stepBack()}else if(l().isEventKey(t,"Right")||l().isEventKey(t,"Up")){t.preventDefault();t.stopPropagation();this.stepForward()}else e.prototype.handleKeyDown.call(this,t)};i.handleClick=function(e){e.stopPropagation();e.preventDefault()};i.vertical=function(e){if(void 0===e)return this.vertical_||false;this.vertical_=!!e;if(this.vertical_)this.addClass("vjs-slider-vertical");else this.addClass("vjs-slider-horizontal")};return t}(Jt);Jt.registerComponent("Slider",Wr);var zr=function(e,t){return Vr(e/t*100,0,100).toFixed(2)+"%"};var Gr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.partEls_=[];r.on(t,"progress",(function(e){return r.update(e)}));return r}var i=t.prototype;i.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-load-progress"});var i=Ae("span",{className:"vjs-control-text"});var r=Ae("span",{textContent:this.localize("Loaded")});var n=s().createTextNode(": ");this.percentageEl_=Ae("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"});t.appendChild(i);i.appendChild(r);i.appendChild(n);i.appendChild(this.percentageEl_);return t};i.dispose=function(){this.partEls_=null;this.percentageEl_=null;e.prototype.dispose.call(this)};i.update=function(e){var t=this;this.requestNamedAnimationFrame("LoadProgressBar#update",(function(){var e=t.player_.liveTracker;var i=t.player_.buffered();var r=e&&e.isLive()?e.seekableEnd():t.player_.duration();var n=t.player_.bufferedEnd();var a=t.partEls_;var s=zr(n,r);if(t.percent_!==s){t.el_.style.width=s;Le(t.percentageEl_,s);t.percent_=s}for(var o=0;o<i.length;o++){var u=i.start(o);var l=i.end(o);var d=a[o];if(!d){d=t.el_.appendChild(Ae());a[o]=d}if(d.dataset.start===u&&d.dataset.end===l)continue;d.dataset.start=u;d.dataset.end=l;d.style.left=zr(u,n);d.style.width=zr(l-u,n)}for(var c=a.length;c>i.length;c--)t.el_.removeChild(a[c-1]);a.length=i.length}))};return t}(Jt);Jt.registerComponent("LoadProgressBar",Gr);var Kr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.update=xt(It((0,d.Z)(r),r.update),wt);return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})};i.update=function(e,t,i){var r=ze(this.el_);var n=We(this.player_.el());var a=e.width*t;if(!n||!r)return;var s=e.left-n.left+a;var o=e.width-a+(n.right-e.right);var u=r.width/2;if(s<u)u+=u-s;else if(o<u)u=o;if(u<0)u=0;else if(u>r.width)u=r.width;u=Math.round(u);this.el_.style.right="-"+u+"px";this.write(i)};i.write=function(e){Le(this.el_,e)};i.updateTime=function(e,t,i,r){var n=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",(function(){var a;var s=n.player_.duration();if(n.player_.liveTracker&&n.player_.liveTracker.isLive()){var o=n.player_.liveTracker.liveWindow();var u=o-t*o;a=(u<1?"":"-")+Rr(u,o)}else a=Rr(i,s);n.update(e,t,a);if(r)r()}))};return t}(Jt);Jt.registerComponent("TimeTooltip",Kr);var Zr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.update=xt(It((0,d.Z)(r),r.update),wt);return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})};i.update=function(e,t){var i=this.getChild("timeTooltip");if(!i)return;var r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(e,t,r)};return t}(Jt);Zr.prototype.options_={children:[]};if(!Te&&!oe)Zr.prototype.options_.children.push("timeTooltip");Jt.registerComponent("PlayProgressBar",Zr);var Qr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.update=xt(It((0,d.Z)(r),r.update),wt);return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};i.update=function(e,t){var i=this;var r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,r,(function(){i.el_.style.left=e.width*t+"px"}))};return t}(Jt);Qr.prototype.options_={children:["timeTooltip"]};Jt.registerComponent("MouseTimeDisplay",Qr);var Xr=5;var Yr=12;var $r=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.setEventHandlers_();return r}var i=t.prototype;i.setEventHandlers_=function(){var e=this;this.update_=It(this,this.update);this.update=xt(this.update_,wt);this.on(this.player_,["ended","durationchange","timeupdate"],this.update);if(this.player_.liveTracker)this.on(this.player_.liveTracker,"liveedgechange",this.update);this.updateInterval=null;this.enableIntervalHandler_=function(t){return e.enableInterval_(t)};this.disableIntervalHandler_=function(t){return e.disableInterval_(t)};this.on(this.player_,["playing"],this.enableIntervalHandler_);this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_);if("hidden"in s()&&"visibilityState"in s())this.on(s(),"visibilitychange",this.toggleVisibility_)};i.toggleVisibility_=function(e){if("hidden"===s().visibilityState){this.cancelNamedAnimationFrame("SeekBar#update");this.cancelNamedAnimationFrame("Slider#update");this.disableInterval_(e)}else{if(!this.player_.ended()&&!this.player_.paused())this.enableInterval_();this.update()}};i.enableInterval_=function(){if(this.updateInterval)return;this.updateInterval=this.setInterval(this.update,wt)};i.disableInterval_=function(e){if(this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type)return;if(!this.updateInterval)return;this.clearInterval(this.updateInterval);this.updateInterval=null};i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})};i.update=function(t){var i=this;if("hidden"===s().visibilityState)return;var r=e.prototype.update.call(this);this.requestNamedAnimationFrame("SeekBar#update",(function(){var e=i.player_.ended()?i.player_.duration():i.getCurrentTime_();var t=i.player_.liveTracker;var n=i.player_.duration();if(t&&t.isLive())n=i.player_.liveTracker.liveCurrentTime();if(i.percent_!==r){i.el_.setAttribute("aria-valuenow",(100*r).toFixed(2));i.percent_=r}if(i.currentTime_!==e||i.duration_!==n){i.el_.setAttribute("aria-valuetext",i.localize("progress bar timing: currentTime={1} duration={2}",[Rr(e,n),Rr(n,n)],"{1} of {2}"));i.currentTime_=e;i.duration_=n}if(i.bar)i.bar.update(We(i.el()),i.getProgress())}));return r};i.userSeek_=function(e){if(this.player_.liveTracker&&this.player_.liveTracker.isLive())this.player_.liveTracker.nextSeekedFromUser();this.player_.currentTime(e)};i.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()};i.getPercent=function(){var e=this.getCurrentTime_();var t;var i=this.player_.liveTracker;if(i&&i.isLive()){t=(e-i.seekableStart())/i.liveWindow();if(i.atLiveEdge())t=1}else t=e/this.player_.duration();return t};i.handleMouseDown=function(t){if(!$e(t))return;t.stopPropagation();this.videoWasPlaying=!this.player_.paused();this.player_.pause();e.prototype.handleMouseDown.call(this,t)};i.handleMouseMove=function(e,t){if(void 0===t)t=false;if(!$e(e))return;if(!t&&!this.player_.scrubbing())this.player_.scrubbing(true);var i;var r=this.calculateDistance(e);var n=this.player_.liveTracker;if(!n||!n.isLive()){i=r*this.player_.duration();if(i===this.player_.duration())i-=.1}else{if(r>=.99){n.seekToLiveEdge();return}var a=n.seekableStart();var s=n.liveCurrentTime();i=a+r*n.liveWindow();if(i>=s)i=s;if(i<=a)i=a+.1;if(i===1/0)return}this.userSeek_(i)};i.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");if(!t)return;t.show()};i.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");if(!t)return;t.hide()};i.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t);if(t)t.stopPropagation();this.player_.scrubbing(false);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:true});if(this.videoWasPlaying)ui(this.player_.play());else this.update_()};i.stepForward=function(){this.userSeek_(this.player_.currentTime()+Xr)};i.stepBack=function(){this.userSeek_(this.player_.currentTime()-Xr)};i.handleAction=function(e){if(this.player_.paused())this.player_.play();else this.player_.pause()};i.handleKeyDown=function(t){var i=this.player_.liveTracker;if(l().isEventKey(t,"Space")||l().isEventKey(t,"Enter")){t.preventDefault();t.stopPropagation();this.handleAction(t)}else if(l().isEventKey(t,"Home")){t.preventDefault();t.stopPropagation();this.userSeek_(0)}else if(l().isEventKey(t,"End")){t.preventDefault();t.stopPropagation();if(i&&i.isLive())this.userSeek_(i.liveCurrentTime());else this.userSeek_(this.player_.duration())}else if(/^[0-9]$/.test(l()(t))){t.preventDefault();t.stopPropagation();var r=10*(l().codes[l()(t)]-l().codes[0])/100;if(i&&i.isLive())this.userSeek_(i.seekableStart()+i.liveWindow()*r);else this.userSeek_(this.player_.duration()*r)}else if(l().isEventKey(t,"PgDn")){t.preventDefault();t.stopPropagation();this.userSeek_(this.player_.currentTime()-Xr*Yr)}else if(l().isEventKey(t,"PgUp")){t.preventDefault();t.stopPropagation();this.userSeek_(this.player_.currentTime()+Xr*Yr)}else e.prototype.handleKeyDown.call(this,t)};i.dispose=function(){this.disableInterval_();this.off(this.player_,["ended","durationchange","timeupdate"],this.update);if(this.player_.liveTracker)this.off(this.player_.liveTracker,"liveedgechange",this.update);this.off(this.player_,["playing"],this.enableIntervalHandler_);this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_);if("hidden"in s()&&"visibilityState"in s())this.off(s(),"visibilitychange",this.toggleVisibility_);e.prototype.dispose.call(this)};return t}(Wr);$r.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};if(!Te&&!oe)$r.prototype.options_.children.splice(1,0,"mouseTimeDisplay");Jt.registerComponent("SeekBar",$r);var Jr=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.handleMouseMove=xt(It((0,d.Z)(r),r.handleMouseMove),wt);r.throttledHandleMouseSeek=xt(It((0,d.Z)(r),r.handleMouseSeek),wt);r.handleMouseUpHandler_=function(e){return r.handleMouseUp(e)};r.handleMouseDownHandler_=function(e){return r.handleMouseDown(e)};r.enable();return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})};i.handleMouseMove=function(e){var t=this.getChild("seekBar");if(!t)return;var i=t.getChild("playProgressBar");var r=t.getChild("mouseTimeDisplay");if(!i&&!r)return;var n=t.el();var a=ze(n);var s=Ge(n,e).x;s=Vr(s,0,1);if(r)r.update(a,s);if(i)i.update(a,t.getProgress())};i.handleMouseSeek=function(e){var t=this.getChild("seekBar");if(t)t.handleMouseMove(e)};i.enabled=function(){return this.enabled_};i.disable=function(){this.children().forEach((function(e){return e.disable&&e.disable()}));if(!this.enabled())return;this.off(["mousedown","touchstart"],this.handleMouseDownHandler_);this.off(this.el_,"mousemove",this.handleMouseMove);this.removeListenersAddedOnMousedownAndTouchstart();this.addClass("disabled");this.enabled_=false;if(this.player_.scrubbing()){var e=this.getChild("seekBar");this.player_.scrubbing(false);if(e.videoWasPlaying)ui(this.player_.play())}};i.enable=function(){this.children().forEach((function(e){return e.enable&&e.enable()}));if(this.enabled())return;this.on(["mousedown","touchstart"],this.handleMouseDownHandler_);this.on(this.el_,"mousemove",this.handleMouseMove);this.removeClass("disabled");this.enabled_=true};i.removeListenersAddedOnMousedownAndTouchstart=function(){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek);this.off(e,"touchmove",this.throttledHandleMouseSeek);this.off(e,"mouseup",this.handleMouseUpHandler_);this.off(e,"touchend",this.handleMouseUpHandler_)};i.handleMouseDown=function(e){var t=this.el_.ownerDocument;var i=this.getChild("seekBar");if(i)i.handleMouseDown(e);this.on(t,"mousemove",this.throttledHandleMouseSeek);this.on(t,"touchmove",this.throttledHandleMouseSeek);this.on(t,"mouseup",this.handleMouseUpHandler_);this.on(t,"touchend",this.handleMouseUpHandler_)};i.handleMouseUp=function(e){var t=this.getChild("seekBar");if(t)t.handleMouseUp(e);this.removeListenersAddedOnMousedownAndTouchstart()};return t}(Jt);Jr.prototype.options_={children:["seekBar"]};Jt.registerComponent("ProgressControl",Jr);var en=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.on(t,["enterpictureinpicture","leavepictureinpicture"],(function(e){return r.handlePictureInPictureChange(e)}));r.on(t,["disablepictureinpicturechanged","loadedmetadata"],(function(e){return r.handlePictureInPictureEnabledChange(e)}));r.on(t,["loadedmetadata","audioonlymodechange","audiopostermodechange"],(function(){var e="audio"===t.currentType().substring(0,5);if(e||t.audioPosterMode()||t.audioOnlyMode()){if(t.isInPictureInPicture())t.exitPictureInPicture();r.hide()}else r.show()}));r.disable();return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)};i.handlePictureInPictureEnabledChange=function(){if(s().pictureInPictureEnabled&&false===this.player_.disablePictureInPicture())this.enable();else this.disable()};i.handlePictureInPictureChange=function(e){if(this.player_.isInPictureInPicture())this.controlText("Exit Picture-in-Picture");else this.controlText("Picture-in-Picture");this.handlePictureInPictureEnabledChange()};i.handleClick=function(e){if(!this.player_.isInPictureInPicture())this.player_.requestPictureInPicture();else this.player_.exitPictureInPicture()};return t}(Ir);en.prototype.controlText_="Picture-in-Picture";Jt.registerComponent("PictureInPictureToggle",en);var tn=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.on(t,"fullscreenchange",(function(e){return r.handleFullscreenChange(e)}));if(false===s()[t.fsApi_.fullscreenEnabled])r.disable();return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)};i.handleFullscreenChange=function(e){if(this.player_.isFullscreen())this.controlText("Non-Fullscreen");else this.controlText("Fullscreen")};i.handleClick=function(e){if(!this.player_.isFullscreen())this.player_.requestFullscreen();else this.player_.exitFullscreen()};return t}(Ir);tn.prototype.controlText_="Fullscreen";Jt.registerComponent("FullscreenToggle",tn);var rn=function(e,t){if(t.tech_&&!t.tech_.featuresVolumeControl)e.addClass("vjs-hidden");e.on(t,"loadstart",(function(){if(!t.tech_.featuresVolumeControl)e.addClass("vjs-hidden");else e.removeClass("vjs-hidden")}))};var nn=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});t.appendChild(e.prototype.createEl.call(this,"span",{className:"vjs-control-text"}));return t};return t}(Jt);Jt.registerComponent("VolumeLevel",nn);var an=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.update=xt(It((0,d.Z)(r),r.update),wt);return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})};i.update=function(e,t,i,r){if(!i){var n=We(this.el_);var a=We(this.player_.el());var s=e.width*t;if(!a||!n)return;var o=e.left-a.left+s;var u=e.width-s+(a.right-e.right);var l=n.width/2;if(o<l)l+=l-o;else if(u<l)l=u;if(l<0)l=0;else if(l>n.width)l=n.width;this.el_.style.right="-"+l+"px"}this.write(r+"%")};i.write=function(e){Le(this.el_,e)};i.updateVolume=function(e,t,i,r,n){var a=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",(function(){a.update(e,t,i,r.toFixed(0));if(n)n()}))};return t}(Jt);Jt.registerComponent("VolumeLevelTooltip",an);var sn=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.update=xt(It((0,d.Z)(r),r.update),wt);return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};i.update=function(e,t,i){var r=this;var n=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,i,n,(function(){if(i)r.el_.style.bottom=e.height*t+"px";else r.el_.style.left=e.width*t+"px"}))};return t}(Jt);sn.prototype.options_={children:["volumeLevelTooltip"]};Jt.registerComponent("MouseVolumeLevelDisplay",sn);var on=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.on("slideractive",(function(e){return r.updateLastVolume_(e)}));r.on(t,"volumechange",(function(e){return r.updateARIAAttributes(e)}));t.ready((function(){return r.updateARIAAttributes()}));return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})};i.handleMouseDown=function(t){if(!$e(t))return;e.prototype.handleMouseDown.call(this,t)};i.handleMouseMove=function(e){var t=this.getChild("mouseVolumeLevelDisplay");if(t){var i=this.el();var r=We(i);var n=this.vertical();var a=Ge(i,e);a=n?a.y:a.x;a=Vr(a,0,1);t.update(r,a,n)}if(!$e(e))return;this.checkMuted();this.player_.volume(this.calculateDistance(e))};i.checkMuted=function(){if(this.player_.muted())this.player_.muted(false)};i.getPercent=function(){if(this.player_.muted())return 0;return this.player_.volume()};i.stepForward=function(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)};i.stepBack=function(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)};i.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t);this.el_.setAttribute("aria-valuetext",t+"%")};i.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())};i.updateLastVolume_=function(){var e=this;var t=this.player_.volume();this.one("sliderinactive",(function(){if(0===e.player_.volume())e.player_.lastVolume_(t)}))};return t}(Wr);on.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};if(!Te&&!oe)on.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");on.prototype.playerEvent="volumechange";Jt.registerComponent("VolumeBar",on);var un=function(e){(0,c.Z)(t,e);function t(t,i){var r;if(void 0===i)i={};i.vertical=i.vertical||false;if("undefined"===typeof i.volumeBar||ee(i.volumeBar)){i.volumeBar=i.volumeBar||{};i.volumeBar.vertical=i.vertical}r=e.call(this,t,i)||this;rn((0,d.Z)(r),t);r.throttledHandleMouseMove=xt(It((0,d.Z)(r),r.handleMouseMove),wt);r.handleMouseUpHandler_=function(e){return r.handleMouseUp(e)};r.on("mousedown",(function(e){return r.handleMouseDown(e)}));r.on("touchstart",(function(e){return r.handleMouseDown(e)}));r.on("mousemove",(function(e){return r.handleMouseMove(e)}));r.on(r.volumeBar,["focus","slideractive"],(function(){r.volumeBar.addClass("vjs-slider-active");r.addClass("vjs-slider-active");r.trigger("slideractive")}));r.on(r.volumeBar,["blur","sliderinactive"],(function(){r.volumeBar.removeClass("vjs-slider-active");r.removeClass("vjs-slider-active");r.trigger("sliderinactive")}));return r}var i=t.prototype;i.createEl=function(){var t="vjs-volume-horizontal";if(this.options_.vertical)t="vjs-volume-vertical";return e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})};i.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove);this.on(t,"touchmove",this.throttledHandleMouseMove);this.on(t,"mouseup",this.handleMouseUpHandler_);this.on(t,"touchend",this.handleMouseUpHandler_)};i.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove);this.off(t,"touchmove",this.throttledHandleMouseMove);this.off(t,"mouseup",this.handleMouseUpHandler_);this.off(t,"touchend",this.handleMouseUpHandler_)};i.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)};return t}(Jt);un.prototype.options_={children:["volumeBar"]};Jt.registerComponent("VolumeControl",un);var ln=function(e,t){if(t.tech_&&!t.tech_.featuresMuteControl)e.addClass("vjs-hidden");e.on(t,"loadstart",(function(){if(!t.tech_.featuresMuteControl)e.addClass("vjs-hidden");else e.removeClass("vjs-hidden")}))};var dn=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;ln((0,d.Z)(r),t);r.on(t,["loadstart","volumechange"],(function(e){return r.update(e)}));return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)};i.handleClick=function(e){var t=this.player_.volume();var i=this.player_.lastVolume_();if(0===t){var r=i<.1?.1:i;this.player_.volume(r);this.player_.muted(false)}else this.player_.muted(this.player_.muted()?false:true)};i.update=function(e){this.updateIcon_();this.updateControlText_()};i.updateIcon_=function(){var e=this.player_.volume();var t=3;if(Te&&this.player_.tech_&&this.player_.tech_.el_)this.player_.muted(this.player_.tech_.el_.muted);if(0===e||this.player_.muted())t=0;else if(e<.33)t=1;else if(e<.67)t=2;for(var i=0;i<4;i++)Re(this.el_,"vjs-vol-"+i);Me(this.el_,"vjs-vol-"+t)};i.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume();var t=e?"Unmute":"Mute";if(this.controlText()!==t)this.controlText(t)};return t}(Ir);dn.prototype.controlText_="Mute";Jt.registerComponent("MuteToggle",dn);var cn=function(e){(0,c.Z)(t,e);function t(t,i){var r;if(void 0===i)i={};if("undefined"!==typeof i.inline)i.inline=i.inline;else i.inline=true;if("undefined"===typeof i.volumeControl||ee(i.volumeControl)){i.volumeControl=i.volumeControl||{};i.volumeControl.vertical=!i.inline}r=e.call(this,t,i)||this;r.handleKeyPressHandler_=function(e){return r.handleKeyPress(e)};r.on(t,["loadstart"],(function(e){return r.volumePanelState_(e)}));r.on(r.muteToggle,"keyup",(function(e){return r.handleKeyPress(e)}));r.on(r.volumeControl,"keyup",(function(e){return r.handleVolumeControlKeyUp(e)}));r.on("keydown",(function(e){return r.handleKeyPress(e)}));r.on("mouseover",(function(e){return r.handleMouseOver(e)}));r.on("mouseout",(function(e){return r.handleMouseOut(e)}));r.on(r.volumeControl,["slideractive"],r.sliderActive_);r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_);return r}var i=t.prototype;i.sliderActive_=function(){this.addClass("vjs-slider-active")};i.sliderInactive_=function(){this.removeClass("vjs-slider-active")};i.volumePanelState_=function(){if(this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden"))this.addClass("vjs-hidden");if(this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden"))this.addClass("vjs-mute-toggle-only")};i.createEl=function(){var t="vjs-volume-panel-horizontal";if(!this.options_.inline)t="vjs-volume-panel-vertical";return e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})};i.dispose=function(){this.handleMouseOut();e.prototype.dispose.call(this)};i.handleVolumeControlKeyUp=function(e){if(l().isEventKey(e,"Esc"))this.muteToggle.focus()};i.handleMouseOver=function(e){this.addClass("vjs-hover");Tt(s(),"keyup",this.handleKeyPressHandler_)};i.handleMouseOut=function(e){this.removeClass("vjs-hover");bt(s(),"keyup",this.handleKeyPressHandler_)};i.handleKeyPress=function(e){if(l().isEventKey(e,"Esc"))this.handleMouseOut()};return t}(Jt);cn.prototype.options_={children:["muteToggle","volumeControl"]};Jt.registerComponent("VolumePanel",cn);var hn=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;if(i)r.menuButton_=i.menuButton;r.focusedChild_=-1;r.on("keydown",(function(e){return r.handleKeyDown(e)}));r.boundHandleBlur_=function(e){return r.handleBlur(e)};r.boundHandleTapClick_=function(e){return r.handleTapClick(e)};return r}var i=t.prototype;i.addEventListenerForItem=function(e){if(!(e instanceof Jt))return;this.on(e,"blur",this.boundHandleBlur_);this.on(e,["tap","click"],this.boundHandleTapClick_)};i.removeEventListenerForItem=function(e){if(!(e instanceof Jt))return;this.off(e,"blur",this.boundHandleBlur_);this.off(e,["tap","click"],this.boundHandleTapClick_)};i.removeChild=function(t){if("string"===typeof t)t=this.getChild(t);this.removeEventListenerForItem(t);e.prototype.removeChild.call(this,t)};i.addItem=function(e){var t=this.addChild(e);if(t)this.addEventListenerForItem(t)};i.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=Ae(t,{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var i=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});i.appendChild(this.contentEl_);Tt(i,"click",(function(e){e.preventDefault();e.stopImmediatePropagation()}));return i};i.dispose=function(){this.contentEl_=null;this.boundHandleBlur_=null;this.boundHandleTapClick_=null;e.prototype.dispose.call(this)};i.handleBlur=function(e){var t=e.relatedTarget||s().activeElement;if(!this.children().some((function(e){return e.el()===t}))){var i=this.menuButton_;if(i&&i.buttonPressed_&&t!==i.el().firstChild)i.unpressButton()}};i.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var i=t.filter((function(t){return t.el()===e.target}))[0];if(!i)return;if("CaptionSettingsMenuItem"!==i.name())this.menuButton_.focus()}};i.handleKeyDown=function(e){if(l().isEventKey(e,"Left")||l().isEventKey(e,"Down")){e.preventDefault();e.stopPropagation();this.stepForward()}else if(l().isEventKey(e,"Right")||l().isEventKey(e,"Up")){e.preventDefault();e.stopPropagation();this.stepBack()}};i.stepForward=function(){var e=0;if(void 0!==this.focusedChild_)e=this.focusedChild_+1;this.focus(e)};i.stepBack=function(){var e=0;if(void 0!==this.focusedChild_)e=this.focusedChild_-1;this.focus(e)};i.focus=function(e){if(void 0===e)e=0;var t=this.children().slice();var i=t.length&&t[0].hasClass("vjs-menu-title");if(i)t.shift();if(t.length>0){if(e<0)e=0;else if(e>=t.length)e=t.length-1;this.focusedChild_=e;t[e].el_.focus()}};return t}(Jt);Jt.registerComponent("Menu",hn);var fn=function(e){(0,c.Z)(t,e);function t(t,i){var r;if(void 0===i)i={};r=e.call(this,t,i)||this;r.menuButton_=new Ir(t,i);r.menuButton_.controlText(r.controlText_);r.menuButton_.el_.setAttribute("aria-haspopup","true");var n=Ir.prototype.buildCSSClass();r.menuButton_.el_.className=r.buildCSSClass()+" "+n;r.menuButton_.removeClass("vjs-control");r.addChild(r.menuButton_);r.update();r.enabled_=true;var a=function(e){return r.handleClick(e)};r.handleMenuKeyUp_=function(e){return r.handleMenuKeyUp(e)};r.on(r.menuButton_,"tap",a);r.on(r.menuButton_,"click",a);r.on(r.menuButton_,"keydown",(function(e){return r.handleKeyDown(e)}));r.on(r.menuButton_,"mouseenter",(function(){r.addClass("vjs-hover");r.menu.show();Tt(s(),"keyup",r.handleMenuKeyUp_)}));r.on("mouseleave",(function(e){return r.handleMouseLeave(e)}));r.on("keydown",(function(e){return r.handleSubmenuKeyDown(e)}));return r}var i=t.prototype;i.update=function(){var e=this.createMenu();if(this.menu){this.menu.dispose();this.removeChild(this.menu)}this.menu=e;this.addChild(e);this.buttonPressed_=false;this.menuButton_.el_.setAttribute("aria-expanded","false");if(this.items&&this.items.length<=this.hideThreshold_){this.hide();this.menu.contentEl_.removeAttribute("role")}else{this.show();this.menu.contentEl_.setAttribute("role","menu")}};i.createMenu=function(){var e=new hn(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var t=Ae("li",{className:"vjs-menu-title",textContent:Gt(this.options_.title),tabIndex:-1});var i=new Jt(this.player_,{el:t});e.addItem(i)}this.items=this.createItems();if(this.items)for(var r=0;r<this.items.length;r++)e.addItem(this.items[r]);return e};i.createItems=function(){};i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})};i.buildWrapperCSSClass=function(){var t="vjs-menu-button";if(true===this.options_.inline)t+="-inline";else t+="-popup";var i=Ir.prototype.buildCSSClass();return"vjs-menu-button "+t+" "+i+" "+e.prototype.buildCSSClass.call(this)};i.buildCSSClass=function(){var t="vjs-menu-button";if(true===this.options_.inline)t+="-inline";else t+="-popup";return"vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)};i.controlText=function(e,t){if(void 0===t)t=this.menuButton_.el();return this.menuButton_.controlText(e,t)};i.dispose=function(){this.handleMouseLeave();e.prototype.dispose.call(this)};i.handleClick=function(e){if(this.buttonPressed_)this.unpressButton();else this.pressButton()};i.handleMouseLeave=function(e){this.removeClass("vjs-hover");bt(s(),"keyup",this.handleMenuKeyUp_)};i.focus=function(){this.menuButton_.focus()};i.blur=function(){this.menuButton_.blur()};i.handleKeyDown=function(e){if(l().isEventKey(e,"Esc")||l().isEventKey(e,"Tab")){if(this.buttonPressed_)this.unpressButton();if(!l().isEventKey(e,"Tab")){e.preventDefault();this.menuButton_.focus()}}else if(l().isEventKey(e,"Up")||l().isEventKey(e,"Down"))if(!this.buttonPressed_){e.preventDefault();this.pressButton()}};i.handleMenuKeyUp=function(e){if(l().isEventKey(e,"Esc")||l().isEventKey(e,"Tab"))this.removeClass("vjs-hover")};i.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)};i.handleSubmenuKeyDown=function(e){if(l().isEventKey(e,"Esc")||l().isEventKey(e,"Tab")){if(this.buttonPressed_)this.unpressButton();if(!l().isEventKey(e,"Tab")){e.preventDefault();this.menuButton_.focus()}}};i.pressButton=function(){if(this.enabled_){this.buttonPressed_=true;this.menu.show();this.menu.lockShowing();this.menuButton_.el_.setAttribute("aria-expanded","true");if(Te&&xe())return;this.menu.focus()}};i.unpressButton=function(){if(this.enabled_){this.buttonPressed_=false;this.menu.unlockShowing();this.menu.hide();this.menuButton_.el_.setAttribute("aria-expanded","false")}};i.disable=function(){this.unpressButton();this.enabled_=false;this.addClass("vjs-disabled");this.menuButton_.disable()};i.enable=function(){this.enabled_=true;this.removeClass("vjs-disabled");this.menuButton_.enable()};return t}(Jt);Jt.registerComponent("MenuButton",fn);var pn=function(e){(0,c.Z)(t,e);function t(t,i){var r;var n=i.tracks;r=e.call(this,t,i)||this;if(r.items.length<=1)r.hide();if(!n)return(0,d.Z)(r);var a=It((0,d.Z)(r),r.update);n.addEventListener("removetrack",a);n.addEventListener("addtrack",a);n.addEventListener("labelchange",a);r.player_.on("ready",a);r.player_.on("dispose",(function(){n.removeEventListener("removetrack",a);n.removeEventListener("addtrack",a);n.removeEventListener("labelchange",a)}));return r}return t}(fn);Jt.registerComponent("TrackButton",pn);var mn=["Tab","Esc","Up","Down","Right","Left"];var vn=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.selectable=i.selectable;r.isSelected_=i.selected||false;r.multiSelectable=i.multiSelectable;r.selected(r.isSelected_);if(r.selectable)if(r.multiSelectable)r.el_.setAttribute("role","menuitemcheckbox");else r.el_.setAttribute("role","menuitemradio");else r.el_.setAttribute("role","menuitem");return r}var i=t.prototype;i.createEl=function(t,i,r){this.nonIconControl=true;var n=e.prototype.createEl.call(this,"li",$({className:"vjs-menu-item",tabIndex:-1},i),r);n.replaceChild(Ae("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),n.querySelector(".vjs-icon-placeholder"));return n};i.handleKeyDown=function(t){if(!mn.some((function(e){return l().isEventKey(t,e)})))e.prototype.handleKeyDown.call(this,t)};i.handleClick=function(e){this.selected(true)};i.selected=function(e){if(this.selectable)if(e){this.addClass("vjs-selected");this.el_.setAttribute("aria-checked","true");this.controlText(", selected");this.isSelected_=true}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-checked","false");this.controlText("");this.isSelected_=false}};return t}(_r);Jt.registerComponent("MenuItem",vn);var gn=function(e){(0,c.Z)(t,e);function t(t,i){var r;var a=i.track;var o=t.textTracks();i.label=a.label||a.language||"Unknown";i.selected="showing"===a.mode;r=e.call(this,t,i)||this;r.track=a;r.kinds=(i.kinds||[i.kind||r.track.kind]).filter(Boolean);var u=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r.handleTracksChange.apply((0,d.Z)(r),t)};var l=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r.handleSelectedLanguageChange.apply((0,d.Z)(r),t)};t.on(["loadstart","texttrackchange"],u);o.addEventListener("change",u);o.addEventListener("selectedlanguagechange",l);r.on("dispose",(function(){t.off(["loadstart","texttrackchange"],u);o.removeEventListener("change",u);o.removeEventListener("selectedlanguagechange",l)}));if(void 0===o.onchange){var c;r.on(["tap","click"],(function(){if("object"!==typeof n().Event)try{c=new(n().Event)("change")}catch(e){}if(!c){c=s().createEvent("Event");c.initEvent("change",true,true)}o.dispatchEvent(c)}))}r.handleTracksChange();return r}var i=t.prototype;i.handleClick=function(t){var i=this.track;var r=this.player_.textTracks();e.prototype.handleClick.call(this,t);if(!r)return;for(var n=0;n<r.length;n++){var a=r[n];if(-1===this.kinds.indexOf(a.kind))continue;if(a===i){if("showing"!==a.mode)a.mode="showing"}else if("disabled"!==a.mode)a.mode="disabled"}};i.handleTracksChange=function(e){var t="showing"===this.track.mode;if(t!==this.isSelected_)this.selected(t)};i.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:true,language:this.track.language,kind:this.track.kind}}};i.dispose=function(){this.track=null;e.prototype.dispose.call(this)};return t}(vn);Jt.registerComponent("TextTrackMenuItem",gn);var _n=function(e){(0,c.Z)(t,e);function t(t,i){i.track={player:t,kind:i.kind,kinds:i.kinds,default:false,mode:"disabled"};if(!i.kinds)i.kinds=[i.kind];if(i.label)i.track.label=i.label;else i.track.label=i.kinds.join(" and ")+" off";i.selectable=true;i.multiSelectable=false;return e.call(this,t,i)||this}var i=t.prototype;i.handleTracksChange=function(e){var t=this.player().textTracks();var i=true;for(var r=0,n=t.length;r<n;r++){var a=t[r];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){i=false;break}}if(i!==this.isSelected_)this.selected(i)};i.handleSelectedLanguageChange=function(e){var t=this.player().textTracks();var i=true;for(var r=0,n=t.length;r<n;r++){var a=t[r];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){i=false;break}}if(i)this.player_.cache_.selectedLanguage={enabled:false}};return t}(gn);Jt.registerComponent("OffTextTrackMenuItem",_n);var yn=function(e){(0,c.Z)(t,e);function t(t,i){if(void 0===i)i={};i.tracks=t.textTracks();return e.call(this,t,i)||this}var i=t.prototype;i.createItems=function(e,t){if(void 0===e)e=[];if(void 0===t)t=gn;var i;if(this.label_)i=this.label_+" off";e.push(new _n(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i}));this.hideThreshold_+=1;var r=this.player_.textTracks();if(!Array.isArray(this.kinds_))this.kinds_=[this.kind_];for(var n=0;n<r.length;n++){var a=r[n];if(this.kinds_.indexOf(a.kind)>-1){var s=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:true,multiSelectable:false});s.addClass("vjs-"+a.kind+"-menu-item");e.push(s)}}return e};return t}(pn);Jt.registerComponent("TextTrackButton",yn);var Tn=function(e){(0,c.Z)(t,e);function t(t,i){var r;var n=i.track;var a=i.cue;var s=t.currentTime();i.selectable=true;i.multiSelectable=false;i.label=a.text;i.selected=a.startTime<=s&&s<a.endTime;r=e.call(this,t,i)||this;r.track=n;r.cue=a;return r}var i=t.prototype;i.handleClick=function(t){e.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime)};return t}(vn);Jt.registerComponent("ChaptersTrackMenuItem",Tn);var bn=function(e){(0,c.Z)(t,e);function t(t,i,r){var n;n=e.call(this,t,i,r)||this;n.selectCurrentItem_=function(){n.items.forEach((function(e){e.selected(n.track_.activeCues[0]===e.cue)}))};return n}var i=t.prototype;i.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)};i.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)};i.update=function(t){if(t&&t.track&&"chapters"!==t.track.kind)return;var i=this.findChaptersTrack();if(i!==this.track_){this.setTrack(i);e.prototype.update.call(this)}else if(!this.items||i&&i.cues&&i.cues.length!==this.items.length)e.prototype.update.call(this)};i.setTrack=function(e){if(this.track_===e)return;if(!this.updateHandler_)this.updateHandler_=this.update.bind(this);if(this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(t)t.removeEventListener("load",this.updateHandler_);this.track_.removeEventListener("cuechange",this.selectCurrentItem_);this.track_=null}this.track_=e;if(this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(i)i.addEventListener("load",this.updateHandler_);this.track_.addEventListener("cuechange",this.selectCurrentItem_)}};i.findChaptersTrack=function(){var e=this.player_.textTracks()||[];for(var t=e.length-1;t>=0;t--){var i=e[t];if(i.kind===this.kind_)return i}};i.getMenuCaption=function(){if(this.track_&&this.track_.label)return this.track_.label;return this.localize(Gt(this.kind_))};i.createMenu=function(){this.options_.title=this.getMenuCaption();return e.prototype.createMenu.call(this)};i.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var i=0,r=t.length;i<r;i++){var n=t[i];var a=new Tn(this.player_,{track:this.track_,cue:n});e.push(a)}return e};return t}(yn);bn.prototype.kind_="chapters";bn.prototype.controlText_="Chapters";Jt.registerComponent("ChaptersButton",bn);var Sn=function(e){(0,c.Z)(t,e);function t(t,i,r){var n;n=e.call(this,t,i,r)||this;var a=t.textTracks();var s=It((0,d.Z)(n),n.handleTracksChange);a.addEventListener("change",s);n.on("dispose",(function(){a.removeEventListener("change",s)}));return n}var i=t.prototype;i.handleTracksChange=function(e){var t=this.player().textTracks();var i=false;for(var r=0,n=t.length;r<n;r++){var a=t[r];if(a.kind!==this.kind_&&"showing"===a.mode){i=true;break}}if(i)this.disable();else this.enable()};i.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)};i.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(yn);Sn.prototype.kind_="descriptions";Sn.prototype.controlText_="Descriptions";Jt.registerComponent("DescriptionsButton",Sn);var kn=function(e){(0,c.Z)(t,e);function t(t,i,r){return e.call(this,t,i,r)||this}var i=t.prototype;i.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)};i.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(yn);kn.prototype.kind_="subtitles";kn.prototype.controlText_="Subtitles";Jt.registerComponent("SubtitlesButton",kn);var Cn=function(e){(0,c.Z)(t,e);function t(t,i){var r;i.track={player:t,kind:i.kind,label:i.kind+" settings",selectable:false,default:false,mode:"disabled"};i.selectable=false;i.name="CaptionSettingsMenuItem";r=e.call(this,t,i)||this;r.addClass("vjs-texttrack-settings");r.controlText(", opens "+i.kind+" settings dialog");return r}var i=t.prototype;i.handleClick=function(e){this.player().getChild("textTrackSettings").open()};return t}(gn);Jt.registerComponent("CaptionSettingsMenuItem",Cn);var En=function(e){(0,c.Z)(t,e);function t(t,i,r){return e.call(this,t,i,r)||this}var i=t.prototype;i.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)};i.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)};i.createItems=function(){var t=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){t.push(new Cn(this.player_,{kind:this.kind_}));this.hideThreshold_+=1}return e.prototype.createItems.call(this,t)};return t}(yn);En.prototype.kind_="captions";En.prototype.controlText_="Captions";Jt.registerComponent("CaptionsButton",En);var wn=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.createEl=function(t,i,r){var n=e.prototype.createEl.call(this,t,i,r);var a=n.querySelector(".vjs-menu-item-text");if("captions"===this.options_.track.kind){a.appendChild(Ae("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));a.appendChild(Ae("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))}return n};return t}(gn);Jt.registerComponent("SubsCapsMenuItem",wn);var In=function(e){(0,c.Z)(t,e);function t(t,i){var r;if(void 0===i)i={};r=e.call(this,t,i)||this;r.label_="subtitles";if(["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1)r.label_="captions";r.menuButton_.controlText(Gt(r.label_));return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)};i.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)};i.createItems=function(){var t=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){t.push(new Cn(this.player_,{kind:this.label_}));this.hideThreshold_+=1}t=e.prototype.createItems.call(this,t,wn);return t};return t}(yn);In.prototype.kinds_=["captions","subtitles"];In.prototype.controlText_="Subtitles";Jt.registerComponent("SubsCapsButton",In);var xn=function(e){(0,c.Z)(t,e);function t(t,i){var r;var n=i.track;var a=t.audioTracks();i.label=n.label||n.language||"Unknown";i.selected=n.enabled;r=e.call(this,t,i)||this;r.track=n;r.addClass("vjs-"+n.kind+"-menu-item");var s=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r.handleTracksChange.apply((0,d.Z)(r),t)};a.addEventListener("change",s);r.on("dispose",(function(){a.removeEventListener("change",s)}));return r}var i=t.prototype;i.createEl=function(t,i,r){var n=e.prototype.createEl.call(this,t,i,r);var a=n.querySelector(".vjs-menu-item-text");if("main-desc"===this.options_.track.kind){a.appendChild(Ae("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));a.appendChild(Ae("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))}return n};i.handleClick=function(t){e.prototype.handleClick.call(this,t);this.track.enabled=true;if(this.player_.tech_.featuresNativeAudioTracks){var i=this.player_.audioTracks();for(var r=0;r<i.length;r++){var n=i[r];if(n===this.track)continue;n.enabled=n===this.track}}};i.handleTracksChange=function(e){this.selected(this.track.enabled)};return t}(vn);Jt.registerComponent("AudioTrackMenuItem",xn);var Pn=function(e){(0,c.Z)(t,e);function t(t,i){if(void 0===i)i={};i.tracks=t.audioTracks();return e.call(this,t,i)||this}var i=t.prototype;i.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)};i.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)};i.createItems=function(e){if(void 0===e)e=[];this.hideThreshold_=1;var t=this.player_.audioTracks();for(var i=0;i<t.length;i++){var r=t[i];e.push(new xn(this.player_,{track:r,selectable:true,multiSelectable:false}))}return e};return t}(pn);Pn.prototype.controlText_="Audio Track";Jt.registerComponent("AudioTrackButton",Pn);var An=function(e){(0,c.Z)(t,e);function t(t,i){var r;var n=i.rate;var a=parseFloat(n,10);i.label=n;i.selected=a===t.playbackRate();i.selectable=true;i.multiSelectable=false;r=e.call(this,t,i)||this;r.label=n;r.rate=a;r.on(t,"ratechange",(function(e){return r.update(e)}));return r}var i=t.prototype;i.handleClick=function(t){e.prototype.handleClick.call(this);this.player().playbackRate(this.rate)};i.update=function(e){this.selected(this.player().playbackRate()===this.rate)};return t}(vn);An.prototype.contentElType="button";Jt.registerComponent("PlaybackRateMenuItem",An);var Ln=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.menuButton_.el_.setAttribute("aria-describedby",r.labelElId_);r.updateVisibility();r.updateLabel();r.on(t,"loadstart",(function(e){return r.updateVisibility(e)}));r.on(t,"ratechange",(function(e){return r.updateLabel(e)}));r.on(t,"playbackrateschange",(function(e){return r.handlePlaybackRateschange(e)}));return r}var i=t.prototype;i.createEl=function(){var t=e.prototype.createEl.call(this);this.labelElId_="vjs-playback-rate-value-label-"+this.id_;this.labelEl_=Ae("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"});t.appendChild(this.labelEl_);return t};i.dispose=function(){this.labelEl_=null;e.prototype.dispose.call(this)};i.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)};i.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)};i.createItems=function(){var e=this.playbackRates();var t=[];for(var i=e.length-1;i>=0;i--)t.push(new An(this.player(),{rate:e[i]+"x"}));return t};i.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())};i.handleClick=function(e){var t=this.player().playbackRate();var i=this.playbackRates();var r=i.indexOf(t);var n=(r+1)%i.length;this.player().playbackRate(i[n])};i.handlePlaybackRateschange=function(e){this.update()};i.playbackRates=function(){var e=this.player();return e.playbackRates&&e.playbackRates()||[]};i.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0};i.updateVisibility=function(e){if(this.playbackRateSupported())this.removeClass("vjs-hidden");else this.addClass("vjs-hidden")};i.updateLabel=function(e){if(this.playbackRateSupported())this.labelEl_.textContent=this.player().playbackRate()+"x"};return t}(fn);Ln.prototype.controlText_="Playback Rate";Jt.registerComponent("PlaybackRateMenuButton",Ln);var On=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)};i.createEl=function(t,i,r){if(void 0===t)t="div";if(void 0===i)i={};if(void 0===r)r={};if(!i.className)i.className=this.buildCSSClass();return e.prototype.createEl.call(this,t,i,r)};return t}(Jt);Jt.registerComponent("Spacer",On);var Dn=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)};i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:"\xa0"})};return t}(On);Jt.registerComponent("CustomControlSpacer",Dn);var Mn=function(e){(0,c.Z)(t,e);function t(){return e.apply(this,arguments)||this}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})};return t}(Jt);Mn.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};if("exitPictureInPicture"in s())Mn.prototype.options_.children.splice(Mn.prototype.options_.children.length-1,0,"pictureInPictureToggle");Jt.registerComponent("ControlBar",Mn);var Rn=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;r.on(t,"error",(function(e){return r.open(e)}));return r}var i=t.prototype;i.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)};i.content=function(){var e=this.player().error();return e?this.localize(e.message):""};return t}(pi);Rn.prototype.options_=(0,o.Z)({},pi.prototype.options_,{pauseOnOpen:false,fillAlways:true,temporary:false,uncloseable:true});Jt.registerComponent("ErrorDisplay",Rn);var Un="vjs-text-track-settings";var Bn=["#000","Black"];var Nn=["#00F","Blue"];var Fn=["#0FF","Cyan"];var jn=["#0F0","Green"];var Hn=["#F0F","Magenta"];var qn=["#F00","Red"];var Vn=["#FFF","White"];var Wn=["#FF0","Yellow"];var zn=["1","Opaque"];var Gn=["0.5","Semi-Transparent"];var Kn=["0","Transparent"];var Zn={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Bn,Vn,qn,jn,Nn,Wn,Hn,Fn]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[zn,Gn,Kn]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Vn,Bn,qn,jn,Nn,Wn,Hn,Fn]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[zn,Gn]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Kn,Gn,zn]}};Zn.windowColor.options=Zn.backgroundColor.options;function Qn(e,t){if(t)e=t(e);if(e&&"none"!==e)return e}function Xn(e,t){var i=e.options[e.options.selectedIndex].value;return Qn(i,t)}function Yn(e,t,i){if(!t)return;for(var r=0;r<e.options.length;r++)if(Qn(e.options[r].value,i)===t){e.selectedIndex=r;break}}var $n=function(e){(0,c.Z)(t,e);function t(t,i){var r;i.temporary=false;r=e.call(this,t,i)||this;r.updateDisplay=r.updateDisplay.bind((0,d.Z)(r));r.fill();r.hasBeenOpened_=r.hasBeenFilled_=true;r.endDialog=Ae("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")});r.el().appendChild(r.endDialog);r.setDefaults();if(void 0===i.persistTextTrackSettings)r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings;r.on(r.$(".vjs-done-button"),"click",(function(){r.saveSettings();r.close()}));r.on(r.$(".vjs-default-button"),"click",(function(){r.setDefaults();r.updateDisplay()}));X(Zn,(function(e){r.on(r.$(e.selector),"change",r.updateDisplay)}));if(r.options_.persistTextTrackSettings)r.restoreSettings();return r}var i=t.prototype;i.dispose=function(){this.endDialog=null;e.prototype.dispose.call(this)};i.createElSelect_=function(e,t,i){var r=this;if(void 0===t)t="";if(void 0===i)i="label";var n=Zn[e];var a=n.id.replace("%s",this.id_);var s=[t,a].join(" ").trim();return["<"+i+' id="'+a+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(n.label),"</"+i+">",'<select aria-labelledby="'+s+'">'].concat(n.options.map((function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+s+" "+t+'">',r.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")};i.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")};i.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")};i.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")};i.createElColors_=function(){return Ae("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})};i.createElFont_=function(){return Ae("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})};i.createElControls_=function(){var e=this.localize("restore all settings to the default values");return Ae("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})};i.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]};i.label=function(){return this.localize("Caption Settings Dialog")};i.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")};i.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"};i.getValues=function(){var e=this;return Y(Zn,(function(t,i,r){var n=Xn(e.$(i.selector),i.parser);if(void 0!==n)t[r]=n;return t}),{})};i.setValues=function(e){var t=this;X(Zn,(function(i,r){Yn(t.$(i.selector),e[r],i.parser)}))};i.setDefaults=function(){var e=this;X(Zn,(function(t){var i=t.hasOwnProperty("default")?t["default"]:0;e.$(t.selector).selectedIndex=i}))};i.restoreSettings=function(){var e;try{e=JSON.parse(n().localStorage.getItem(Un))}catch(t){G.warn(t)}if(e)this.setValues(e)};i.saveSettings=function(){if(!this.options_.persistTextTrackSettings)return;var e=this.getValues();try{if(Object.keys(e).length)n().localStorage.setItem(Un,JSON.stringify(e));else n().localStorage.removeItem(Un)}catch(t){G.warn(t)}};i.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");if(e)e.updateDisplay()};i.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar;var t=e&&e.subsCapsButton;var i=e&&e.captionsButton;if(t)t.focus();else if(i)i.focus()};return t}(pi);Jt.registerComponent("TextTrackSettings",$n);var Jn=function(e){(0,c.Z)(t,e);function t(t,i){var r;var a=i.ResizeObserver||n().ResizeObserver;if(null===i.ResizeObserver)a=false;var s=Zt({createEl:!a,reportTouchActivity:false},i);r=e.call(this,t,s)||this;r.ResizeObserver=i.ResizeObserver||n().ResizeObserver;r.loadListener_=null;r.resizeObserver_=null;r.debouncedHandler_=Pt((function(){r.resizeHandler()}),100,false,(0,d.Z)(r));if(a){r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_);r.resizeObserver_.observe(t.el())}else{r.loadListener_=function(){if(!r.el_||!r.el_.contentWindow)return;var e=r.debouncedHandler_;var t=r.unloadListener_=function(){bt(this,"resize",e);bt(this,"unload",t);t=null};Tt(r.el_.contentWindow,"unload",t);Tt(r.el_.contentWindow,"resize",e)};r.one("load",r.loadListener_)}return r}var i=t.prototype;i.createEl=function(){return e.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})};i.resizeHandler=function(){if(!this.player_||!this.player_.trigger)return;this.player_.trigger("playerresize")};i.dispose=function(){if(this.debouncedHandler_)this.debouncedHandler_.cancel();if(this.resizeObserver_){if(this.player_.el())this.resizeObserver_.unobserve(this.player_.el());this.resizeObserver_.disconnect()}if(this.loadListener_)this.off("load",this.loadListener_);if(this.el_&&this.el_.contentWindow&&this.unloadListener_)this.unloadListener_.call(this.el_.contentWindow);this.ResizeObserver=null;this.resizeObserver=null;this.debouncedHandler_=null;this.loadListener_=null;e.prototype.dispose.call(this)};return t}(Jt);Jt.registerComponent("ResizeManager",Jn);var ea={trackingThreshold:20,liveTolerance:15};var ta=function(e){(0,c.Z)(t,e);function t(t,i){var r;var n=Zt(ea,i,{createEl:false});r=e.call(this,t,n)||this;r.handleVisibilityChange_=function(e){return r.handleVisibilityChange(e)};r.trackLiveHandler_=function(){return r.trackLive_()};r.handlePlay_=function(e){return r.handlePlay(e)};r.handleFirstTimeupdate_=function(e){return r.handleFirstTimeupdate(e)};r.handleSeeked_=function(e){return r.handleSeeked(e)};r.seekToLiveEdge_=function(e){return r.seekToLiveEdge(e)};r.reset_();r.on(r.player_,"durationchange",(function(e){return r.handleDurationchange(e)}));r.on(r.player_,"canplay",(function(){return r.toggleTracking()}));if(pe&&"hidden"in s()&&"visibilityState"in s())r.on(s(),"visibilitychange",r.handleVisibilityChange_);return r}var i=t.prototype;i.handleVisibilityChange=function(){if(this.player_.duration()!==1/0)return;if(s().hidden)this.stopTracking();else this.startTracking()};i.trackLive_=function(){var e=this.player_.seekable();if(!e||!e.length)return;var t=Number(n().performance.now().toFixed(4));var i=-1===this.lastTime_?0:(t-this.lastTime_)/1e3;this.lastTime_=t;this.pastSeekEnd_=this.pastSeekEnd()+i;var r=this.liveCurrentTime();var a=this.player_.currentTime();var s=this.player_.paused()||this.seekedBehindLive_||Math.abs(r-a)>this.options_.liveTolerance;if(!this.timeupdateSeen_||r===1/0)s=false;if(s!==this.behindLiveEdge_){this.behindLiveEdge_=s;this.trigger("liveedgechange")}};i.handleDurationchange=function(){this.toggleTracking()};i.toggleTracking=function(){if(this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold){if(this.player_.options_.liveui)this.player_.addClass("vjs-liveui");this.startTracking()}else{this.player_.removeClass("vjs-liveui");this.stopTracking()}};i.startTracking=function(){if(this.isTracking())return;if(!this.timeupdateSeen_)this.timeupdateSeen_=this.player_.hasStarted();this.trackingInterval_=this.setInterval(this.trackLiveHandler_,wt);this.trackLive_();this.on(this.player_,["play","pause"],this.trackLiveHandler_);if(!this.timeupdateSeen_){this.one(this.player_,"play",this.handlePlay_);this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)}else this.on(this.player_,"seeked",this.handleSeeked_)};i.handleFirstTimeupdate=function(){this.timeupdateSeen_=true;this.on(this.player_,"seeked",this.handleSeeked_)};i.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2;this.nextSeekedFromUser_=false;this.trackLive_()};i.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)};i.reset_=function(){this.lastTime_=-1;this.pastSeekEnd_=0;this.lastSeekEnd_=-1;this.behindLiveEdge_=true;this.timeupdateSeen_=false;this.seekedBehindLive_=false;this.nextSeekedFromUser_=false;this.clearInterval(this.trackingInterval_);this.trackingInterval_=null;this.off(this.player_,["play","pause"],this.trackLiveHandler_);this.off(this.player_,"seeked",this.handleSeeked_);this.off(this.player_,"play",this.handlePlay_);this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_);this.off(this.player_,"timeupdate",this.seekToLiveEdge_)};i.nextSeekedFromUser=function(){this.nextSeekedFromUser_=true};i.stopTracking=function(){if(!this.isTracking())return;this.reset_();this.trigger("liveedgechange")};i.seekableEnd=function(){var e=this.player_.seekable();var t=[];var i=e?e.length:0;while(i--)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0};i.seekableStart=function(){var e=this.player_.seekable();var t=[];var i=e?e.length:0;while(i--)t.push(e.start(i));return t.length?t.sort()[0]:0};i.liveWindow=function(){var e=this.liveCurrentTime();if(e===1/0)return 0;return e-this.seekableStart()};i.isLive=function(){return this.isTracking()};i.atLiveEdge=function(){return!this.behindLiveEdge()};i.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()};i.pastSeekEnd=function(){var e=this.seekableEnd();if(-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_)this.pastSeekEnd_=0;this.lastSeekEnd_=e;return this.pastSeekEnd_};i.behindLiveEdge=function(){return this.behindLiveEdge_};i.isTracking=function(){return"number"===typeof this.trackingInterval_};i.seekToLiveEdge=function(){this.seekedBehindLive_=false;if(this.atLiveEdge())return;this.nextSeekedFromUser_=false;this.player_.currentTime(this.liveCurrentTime())};i.dispose=function(){this.off(s(),"visibilitychange",this.handleVisibilityChange_);this.stopTracking();e.prototype.dispose.call(this)};return t}(Jt);Jt.registerComponent("LiveTracker",ta);var ia=function(e){var t=e.el();if(t.hasAttribute("src")){e.triggerSourceset(t.src);return true}var i=e.$$("source");var r=[];var n="";if(!i.length)return false;for(var a=0;a<i.length;a++){var s=i[a].src;if(s&&-1===r.indexOf(s))r.push(s)}if(!r.length)return false;if(1===r.length)n=r[0];e.triggerSourceset(n);return true};var ra=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(true).innerHTML},set:function(e){var t=s().createElement(this.nodeName.toLowerCase());t.innerHTML=e;var i=s().createDocumentFragment();while(t.childNodes.length)i.appendChild(t.childNodes[0]);this.innerText="";n().Element.prototype.appendChild.call(this,i);return this.innerHTML}});var na=function(e,t){var i={};for(var r=0;r<e.length;r++){i=Object.getOwnPropertyDescriptor(e[r],t);if(i&&i.set&&i.get)break}i.enumerable=true;i.configurable=true;return i};var aa=function(e){return na([e.el(),n().HTMLMediaElement.prototype,n().Element.prototype,ra],"innerHTML")};var sa=function(e){var t=e.el();if(t.resetSourceWatch_)return;var i={};var r=aa(e);var n=function(i){return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=i.apply(t,n);ia(e);return s}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){if(!t[e])return;i[e]=t[e];t[e]=n(i[e])}));Object.defineProperty(t,"innerHTML",Zt(r,{set:n(r.set)}));t.resetSourceWatch_=function(){t.resetSourceWatch_=null;Object.keys(i).forEach((function(e){t[e]=i[e]}));Object.defineProperty(t,"innerHTML",r)};e.one("sourceset",t.resetSourceWatch_)};var oa=Object.defineProperty({},"src",{get:function(){if(this.hasAttribute("src"))return Ai(n().Element.prototype.getAttribute.call(this,"src"));return""},set:function(e){n().Element.prototype.setAttribute.call(this,"src",e);return e}});var ua=function(e){return na([e.el(),n().HTMLMediaElement.prototype,oa],"src")};var la=function(e){if(!e.featuresSourceset)return;var t=e.el();if(t.resetSourceset_)return;var i=ua(e);var r=t.setAttribute;var n=t.load;Object.defineProperty(t,"src",Zt(i,{set:function(r){var n=i.set.call(t,r);e.triggerSourceset(t.src);return n}}));t.setAttribute=function(i,n){var a=r.call(t,i,n);if(/src/i.test(i))e.triggerSourceset(t.src);return a};t.load=function(){var i=n.call(t);if(!ia(e)){e.triggerSourceset("");sa(e)}return i};if(t.currentSrc)e.triggerSourceset(t.currentSrc);else if(!ia(e))sa(e);t.resetSourceset_=function(){t.resetSourceset_=null;t.load=n;t.setAttribute=r;Object.defineProperty(t,"src",i);if(t.resetSourceWatch_)t.resetSourceWatch_()}};var da=function(e,t,i,r){if(void 0===r)r=true;var n=function(i){return Object.defineProperty(e,t,{value:i,enumerable:true,writable:true})};var a={configurable:true,enumerable:true,get:function(){var e=i();n(e);return e}};if(r)a.set=n;return Object.defineProperty(e,t,a)};var ca=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this,t,i)||this;var n=t.source;var a=false;if(n&&(r.el_.currentSrc!==n.src||t.tag&&3===t.tag.initNetworkState_))r.setSource(n);else r.handleLateInit_(r.el_);if(t.enableSourceset)r.setupSourcesetHandling_();r.isScrubbing_=false;if(r.el_.hasChildNodes()){var s=r.el_.childNodes;var o=s.length;var u=[];while(o--){var l=s[o];var d=l.nodeName.toLowerCase();if("track"===d)if(!r.featuresNativeTextTracks)u.push(l);else{r.remoteTextTrackEls().addTrackElement_(l);r.remoteTextTracks().addTrack(l.track);r.textTracks().addTrack(l.track);if(!a&&!r.el_.hasAttribute("crossorigin")&&Oi(l.src))a=true}}for(var c=0;c<u.length;c++)r.el_.removeChild(u[c])}r.proxyNativeTracks_();if(r.featuresNativeTextTracks&&a)G.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n"+"This may prevent text tracks from loading.");r.restoreMetadataTracksInIOSNativePlayer_();if((ge||ye||le)&&true===t.nativeControlsForTouch)r.setControls(true);r.proxyWebkitFullscreen_();r.featuresVideoFrameCallback=r.featuresVideoFrameCallback&&"VIDEO"===r.el_.tagName;r.triggerReady();return r}var i=t.prototype;i.dispose=function(){if(this.el_&&this.el_.resetSourceset_)this.el_.resetSourceset_();t.disposeMediaElement(this.el_);this.options_=null;e.prototype.dispose.call(this)};i.setupSourcesetHandling_=function(){la(this)};i.restoreMetadataTracksInIOSNativePlayer_=function(){var e=this.textTracks();var t;var i=function(){t=[];for(var i=0;i<e.length;i++){var r=e[i];if("metadata"===r.kind)t.push({track:r,storedMode:r.mode})}};i();e.addEventListener("change",i);this.on("dispose",(function(){return e.removeEventListener("change",i)}));var r=function i(){for(var r=0;r<t.length;r++){var n=t[r];if("disabled"===n.track.mode&&n.track.mode!==n.storedMode)n.track.mode=n.storedMode}e.removeEventListener("change",i)};this.on("webkitbeginfullscreen",(function(){e.removeEventListener("change",i);e.removeEventListener("change",r);e.addEventListener("change",r)}));this.on("webkitendfullscreen",(function(){e.removeEventListener("change",i);e.addEventListener("change",i);e.removeEventListener("change",r)}))};i.overrideNative_=function(e,t){var i=this;if(t!==this["featuresNative"+e+"Tracks"])return;var r=e.toLowerCase();if(this[r+"TracksListeners_"])Object.keys(this[r+"TracksListeners_"]).forEach((function(e){var t=i.el()[r+"Tracks"];t.removeEventListener(e,i[r+"TracksListeners_"][e])}));this["featuresNative"+e+"Tracks"]=!t;this[r+"TracksListeners_"]=null;this.proxyNativeTracksForType_(r)};i.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)};i.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)};i.proxyNativeTracksForType_=function(e){var t=this;var i=Wi[e];var r=this.el()[i.getterName];var n=this[i.getterName]();if(!this["featuresNative"+i.capitalName+"Tracks"]||!r||!r.addEventListener)return;var a={change:function(i){var r={type:"change",target:n,currentTarget:n,srcElement:n};n.trigger(r);if("text"===e)t[zi.remoteText.getterName]().trigger(r)},addtrack:function(e){n.addTrack(e.track)},removetrack:function(e){n.removeTrack(e.track)}};var s=function(){var e=[];for(var t=0;t<n.length;t++){var i=false;for(var a=0;a<r.length;a++)if(r[a]===n[t]){i=true;break}if(!i)e.push(n[t])}while(e.length)n.removeTrack(e.shift())};this[i.getterName+"Listeners_"]=a;Object.keys(a).forEach((function(e){var i=a[e];r.addEventListener(e,i);t.on("dispose",(function(t){return r.removeEventListener(e,i)}))}));this.on("loadstart",s);this.on("dispose",(function(e){return t.off("loadstart",s)}))};i.proxyNativeTracks_=function(){var e=this;Wi.names.forEach((function(t){e.proxyNativeTracksForType_(t)}))};i.createEl=function(){var e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){var i=e.cloneNode(true);if(e.parentNode)e.parentNode.insertBefore(i,e);t.disposeMediaElement(e);e=i}else{e=s().createElement("video");var r=this.options_.tag&&Ne(this.options_.tag);var n=Zt({},r);if(!ge||true!==this.options_.nativeControlsForTouch)delete n.controls;Be(e,$(n,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}if("undefined"!==typeof this.options_.preload)je(e,"preload",this.options_.preload);if(void 0!==this.options_.disablePictureInPicture)e.disablePictureInPicture=this.options_.disablePictureInPicture;var a=["loop","muted","playsinline","autoplay"];for(var o=0;o<a.length;o++){var u=a[o];var l=this.options_[u];if("undefined"!==typeof l){if(l)je(e,u,u);else He(e,u);e[u]=l}}return e};i.handleLateInit_=function(e){if(0===e.networkState||3===e.networkState)return;if(0===e.readyState){var t=false;var i=function(){t=true};this.on("loadstart",i);var r=function(){if(!t)this.trigger("loadstart")};this.on("loadedmetadata",r);this.ready((function(){this.off("loadstart",i);this.off("loadedmetadata",r);if(!t)this.trigger("loadstart")}));return}var n=["loadstart"];n.push("loadedmetadata");if(e.readyState>=2)n.push("loadeddata");if(e.readyState>=3)n.push("canplay");if(e.readyState>=4)n.push("canplaythrough");this.ready((function(){n.forEach((function(e){this.trigger(e)}),this)}))};i.setScrubbing=function(e){this.isScrubbing_=e};i.scrubbing=function(){return this.isScrubbing_};i.setCurrentTime=function(e){try{if(this.isScrubbing_&&this.el_.fastSeek&&be)this.el_.fastSeek(e);else this.el_.currentTime=e}catch(t){G(t,"Video is not ready. (Video.js)")}};i.duration=function(){var e=this;if(this.el_.duration===1/0&&oe&&he&&0===this.el_.currentTime){var t=function t(){if(e.el_.currentTime>0){if(e.el_.duration===1/0)e.trigger("durationchange");e.off("timeupdate",t)}};this.on("timeupdate",t);return NaN}return this.el_.duration||NaN};i.width=function(){return this.el_.offsetWidth};i.height=function(){return this.el_.offsetHeight};i.proxyWebkitFullscreen_=function(){var e=this;if(!("webkitDisplayingFullscreen"in this.el_))return;var t=function(){this.trigger("fullscreenchange",{isFullscreen:false});if(this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls())this.el_.controls=false};var i=function(){if("webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode){this.one("webkitendfullscreen",t);this.trigger("fullscreenchange",{isFullscreen:true,nativeIOSFullscreen:true})}};this.on("webkitbeginfullscreen",i);this.on("dispose",(function(){e.off("webkitbeginfullscreen",i);e.off("webkitendfullscreen",t)}))};i.supportsFullScreen=function(){if("function"===typeof this.el_.webkitEnterFullScreen){var e=n().navigator&&n().navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return true}return false};i.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA){ui(this.el_.play());this.setTimeout((function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}),0)}else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}};i.exitFullScreen=function(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()};i.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()};i.requestVideoFrameCallback=function(t){if(this.featuresVideoFrameCallback)return this.el_.requestVideoFrameCallback(t);return e.prototype.requestVideoFrameCallback.call(this,t)};i.cancelVideoFrameCallback=function(t){if(this.featuresVideoFrameCallback)this.el_.cancelVideoFrameCallback(t);else e.prototype.cancelVideoFrameCallback.call(this,t)};i.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)};i.reset=function(){t.resetMediaElement(this.el_)};i.currentSrc=function(){if(this.currentSource_)return this.currentSource_.src;return this.el_.currentSrc};i.setControls=function(e){this.el_.controls=!!e};i.addTextTrack=function(t,i,r){if(!this.featuresNativeTextTracks)return e.prototype.addTextTrack.call(this,t,i,r);return this.el_.addTextTrack(t,i,r)};i.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return e.prototype.createRemoteTextTrack.call(this,t);var i=s().createElement("track");if(t.kind)i.kind=t.kind;if(t.label)i.label=t.label;if(t.language||t.srclang)i.srclang=t.language||t.srclang;if(t["default"])i["default"]=t["default"];if(t.id)i.id=t.id;if(t.src)i.src=t.src;return i};i.addRemoteTextTrack=function(t,i){var r=e.prototype.addRemoteTextTrack.call(this,t,i);if(this.featuresNativeTextTracks)this.el().appendChild(r);return r};i.removeRemoteTextTrack=function(t){e.prototype.removeRemoteTextTrack.call(this,t);if(this.featuresNativeTextTracks){var i=this.$$("track");var r=i.length;while(r--)if(t===i[r]||t===i[r].track)this.el().removeChild(i[r])}};i.getVideoPlaybackQuality=function(){if("function"===typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};if("undefined"!==typeof this.el().webkitDroppedFrameCount&&"undefined"!==typeof this.el().webkitDecodedFrameCount){e.droppedVideoFrames=this.el().webkitDroppedFrameCount;e.totalVideoFrames=this.el().webkitDecodedFrameCount}if(n().performance&&"function"===typeof n().performance.now)e.creationTime=n().performance.now();else if(n().performance&&n().performance.timing&&"number"===typeof n().performance.timing.navigationStart)e.creationTime=n().Date.now()-n().performance.timing.navigationStart;return e};return t}(Zi);da(ca,"TEST_VID",(function(){if(!we())return;var e=s().createElement("video");var t=s().createElement("track");t.kind="captions";t.srclang="en";t.label="English";e.appendChild(t);return e}));ca.isSupported=function(){try{ca.TEST_VID.volume=.5}catch(e){return false}return!!(ca.TEST_VID&&ca.TEST_VID.canPlayType)};ca.canPlayType=function(e){return ca.TEST_VID.canPlayType(e)};ca.canPlaySource=function(e,t){return ca.canPlayType(e.type)};ca.canControlVolume=function(){try{var e=ca.TEST_VID.volume;ca.TEST_VID.volume=e/2+.1;var t=e!==ca.TEST_VID.volume;if(t&&Te){n().setTimeout((function(){if(ca&&ca.prototype)ca.prototype.featuresVolumeControl=e!==ca.TEST_VID.volume}));return false}return t}catch(i){return false}};ca.canMuteVolume=function(){try{var e=ca.TEST_VID.muted;ca.TEST_VID.muted=!e;if(ca.TEST_VID.muted)je(ca.TEST_VID,"muted","muted");else He(ca.TEST_VID,"muted","muted");return e!==ca.TEST_VID.muted}catch(t){return false}};ca.canControlPlaybackRate=function(){if(oe&&he&&fe<58)return false;try{var e=ca.TEST_VID.playbackRate;ca.TEST_VID.playbackRate=e/2+.1;return e!==ca.TEST_VID.playbackRate}catch(t){return false}};ca.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(s().createElement("video"),"src",{get:e,set:e});Object.defineProperty(s().createElement("audio"),"src",{get:e,set:e});Object.defineProperty(s().createElement("video"),"innerHTML",{get:e,set:e});Object.defineProperty(s().createElement("audio"),"innerHTML",{get:e,set:e})}catch(t){return false}return true};ca.supportsNativeTextTracks=function(){return be||Te&&he};ca.supportsNativeVideoTracks=function(){return!!(ca.TEST_VID&&ca.TEST_VID.videoTracks)};ca.supportsNativeAudioTracks=function(){return!!(ca.TEST_VID&&ca.TEST_VID.audioTracks)};ca.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){var t=e[0],i=e[1];da(ca.prototype,t,(function(){return ca[i]()}),true)}));ca.prototype.featuresVolumeControl=ca.canControlVolume();ca.prototype.movingMediaElementInDOM=!Te;ca.prototype.featuresFullscreenResize=true;ca.prototype.featuresProgressEvents=true;ca.prototype.featuresTimeupdateEvents=true;ca.prototype.featuresVideoFrameCallback=!!(ca.TEST_VID&&ca.TEST_VID.requestVideoFrameCallback);var ha;ca.patchCanPlayType=function(){if(ue>=4&&!de&&!he){ha=ca.TEST_VID&&ca.TEST_VID.constructor.prototype.canPlayType;ca.TEST_VID.constructor.prototype.canPlayType=function(e){var t=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;if(e&&t.test(e))return"maybe";return ha.call(this,e)}}};ca.unpatchCanPlayType=function(){var e=ca.TEST_VID.constructor.prototype.canPlayType;if(ha)ca.TEST_VID.constructor.prototype.canPlayType=ha;return e};ca.patchCanPlayType();ca.disposeMediaElement=function(e){if(!e)return;if(e.parentNode)e.parentNode.removeChild(e);while(e.hasChildNodes())e.removeChild(e.firstChild);e.removeAttribute("src");if("function"===typeof e.load)(function(){try{e.load()}catch(t){}})()};ca.resetMediaElement=function(e){if(!e)return;var t=e.querySelectorAll("source");var i=t.length;while(i--)e.removeChild(t[i]);e.removeAttribute("src");if("function"===typeof e.load)(function(){try{e.load()}catch(t){}})()};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){ca.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}));["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){ca.prototype["set"+Gt(e)]=function(t){this.el_[e]=t;if(t)this.el_.setAttribute(e,e);else this.el_.removeAttribute(e)}}));["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){ca.prototype[e]=function(){return this.el_[e]}}));["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach((function(e){ca.prototype["set"+Gt(e)]=function(t){this.el_[e]=t}}));["pause","load","play"].forEach((function(e){ca.prototype[e]=function(){return this.el_[e]()}}));Zi.withSourceHandlers(ca);ca.nativeSourceHandler={};ca.nativeSourceHandler.canPlayType=function(e){try{return ca.TEST_VID.canPlayType(e)}catch(t){return""}};ca.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return ca.nativeSourceHandler.canPlayType(e.type);else if(e.src){var i=Li(e.src);return ca.nativeSourceHandler.canPlayType("video/"+i)}return""};ca.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)};ca.nativeSourceHandler.dispose=function(){};ca.registerSourceHandler(ca.nativeSourceHandler);Zi.registerTech("Html5",ca);var fa=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"];var pa={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"};var ma=["tiny","xsmall","small","medium","large","xlarge","huge"];var va={};ma.forEach((function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;va[e]="vjs-layout-"+t}));var ga={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};var _a=function(e){(0,c.Z)(t,e);function t(i,r,n){var a;i.id=i.id||r.id||"vjs_video_"+ct();r=$(t.getTagSettings(i),r);r.initChildren=false;r.createEl=false;r.evented=false;r.reportTouchActivity=false;if(!r.language)if("function"===typeof i.closest){var o=i.closest("[lang]");if(o&&o.getAttribute)r.language=o.getAttribute("lang")}else{var u=i;while(u&&1===u.nodeType){if(Ne(u).hasOwnProperty("lang")){r.language=u.getAttribute("lang");break}u=u.parentNode}}a=e.call(this,null,r,n)||this;a.boundDocumentFullscreenChange_=function(e){return a.documentFullscreenChange_(e)};a.boundFullWindowOnEscKey_=function(e){return a.fullWindowOnEscKey(e)};a.boundUpdateStyleEl_=function(e){return a.updateStyleEl_(e)};a.boundApplyInitTime_=function(e){return a.applyInitTime_(e)};a.boundUpdateCurrentBreakpoint_=function(e){return a.updateCurrentBreakpoint_(e)};a.boundHandleTechClick_=function(e){return a.handleTechClick_(e)};a.boundHandleTechDoubleClick_=function(e){return a.handleTechDoubleClick_(e)};a.boundHandleTechTouchStart_=function(e){return a.handleTechTouchStart_(e)};a.boundHandleTechTouchMove_=function(e){return a.handleTechTouchMove_(e)};a.boundHandleTechTouchEnd_=function(e){return a.handleTechTouchEnd_(e)};a.boundHandleTechTap_=function(e){return a.handleTechTap_(e)};a.isFullscreen_=false;a.log=K(a.id_);a.fsApi_=B;a.isPosterFromTech_=false;a.queuedCallbacks_=[];a.isReady_=false;a.hasStarted_=false;a.userActive_=false;a.debugEnabled_=false;a.audioOnlyMode_=false;a.audioPosterMode_=false;a.audioOnlyCache_={playerHeight:null,hiddenChildren:[]};if(!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite "+"videojs.options instead of just changing the "+"properties you want to override?");a.tag=i;a.tagAttributes=i&&Ne(i);a.language(a.options_.language);if(r.languages){var l={};Object.getOwnPropertyNames(r.languages).forEach((function(e){l[e.toLowerCase()]=r.languages[e]}));a.languages_=l}else a.languages_=t.prototype.options_.languages;a.resetCache_();a.poster_=r.poster||"";a.controls_=!!r.controls;i.controls=false;i.removeAttribute("controls");a.changingSrc_=false;a.playCallbacks_=[];a.playTerminatedQueue_=[];if(i.hasAttribute("autoplay"))a.autoplay(true);else a.autoplay(a.options_.autoplay);if(r.plugins)Object.keys(r.plugins).forEach((function(e){if("function"!==typeof a[e])throw new Error('plugin "'+e+'" does not exist')}));a.scrubbing_=false;a.el_=a.createEl();qt((0,d.Z)(a),{eventBusKey:"el_"});if(a.fsApi_.requestFullscreen){Tt(s(),a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_);a.on(a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_)}if(a.fluid_)a.on(["playerreset","resize"],a.boundUpdateStyleEl_);var c=Zt(a.options_);if(r.plugins)Object.keys(r.plugins).forEach((function(e){a[e](r.plugins[e])}));if(r.debug)a.debug(true);a.options_.playerOptions=c;a.middleware_=[];a.playbackRates(r.playbackRates);a.initChildren();a.isAudio("audio"===i.nodeName.toLowerCase());if(a.controls())a.addClass("vjs-controls-enabled");else a.addClass("vjs-controls-disabled");a.el_.setAttribute("role","region");if(a.isAudio())a.el_.setAttribute("aria-label",a.localize("Audio Player"));else a.el_.setAttribute("aria-label",a.localize("Video Player"));if(a.isAudio())a.addClass("vjs-audio");if(a.flexNotSupported_())a.addClass("vjs-no-flex");if(ge)a.addClass("vjs-touch-enabled");if(!Te)a.addClass("vjs-workinghover");t.players[a.id_]=(0,d.Z)(a);var h=L.split(".")[0];a.addClass("vjs-v"+h);a.userActive(true);a.reportUserActivity();a.one("play",(function(e){return a.listenForUserActivity_(e)}));a.on("stageclick",(function(e){return a.handleStageClick_(e)}));a.on("keydown",(function(e){return a.handleKeyDown(e)}));a.on("languagechange",(function(e){return a.handleLanguagechange(e)}));a.breakpoints(a.options_.breakpoints);a.responsive(a.options_.responsive);a.on("ready",(function(){a.audioPosterMode(a.options_.audioPosterMode);a.audioOnlyMode(a.options_.audioOnlyMode)}));return a}var i=t.prototype;i.dispose=function(){var i=this;this.trigger("dispose");this.off("dispose");bt(s(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_);bt(s(),"keydown",this.boundFullWindowOnEscKey_);if(this.styleEl_&&this.styleEl_.parentNode){this.styleEl_.parentNode.removeChild(this.styleEl_);this.styleEl_=null}t.players[this.id_]=null;if(this.tag&&this.tag.player)this.tag.player=null;if(this.el_&&this.el_.player)this.el_.player=null;if(this.tech_){this.tech_.dispose();this.isPosterFromTech_=false;this.poster_=""}if(this.playerElIngest_)this.playerElIngest_=null;if(this.tag)this.tag=null;lr(this);Gi.names.forEach((function(e){var t=Gi[e];var r=i[t.getterName]();if(r&&r.off)r.off()}));e.prototype.dispose.call(this,{restoreEl:this.options_.restoreEl})};i.createEl=function(){var t=this.tag;var i;var r=this.playerElIngest_=t.parentNode&&t.parentNode.hasAttribute&&t.parentNode.hasAttribute("data-vjs-player");var a="video-js"===this.tag.tagName.toLowerCase();if(r)i=this.el_=t.parentNode;else if(!a)i=this.el_=e.prototype.createEl.call(this,"div");var o=Ne(t);if(a){i=this.el_=t;t=this.tag=s().createElement("video");while(i.children.length)t.appendChild(i.firstChild);if(!De(i,"video-js"))Me(i,"video-js");i.appendChild(t);r=this.playerElIngest_=i;Object.keys(i).forEach((function(e){try{t[e]=i[e]}catch(r){}}))}t.setAttribute("tabindex","-1");o.tabindex="-1";if(pe||he&&ve){t.setAttribute("role","application");o.role="application"}t.removeAttribute("width");t.removeAttribute("height");if("width"in o)delete o.width;if("height"in o)delete o.height;Object.getOwnPropertyNames(o).forEach((function(e){if(!(a&&"class"===e))i.setAttribute(e,o[e]);if(a)t.setAttribute(e,o[e])}));t.playerId=t.id;t.id+="_html5_api";t.className="vjs-tech";t.player=i.player=this;this.addClass("vjs-paused");if(true!==n().VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=ot("vjs-styles-dimensions");var u=Je(".vjs-styles-defaults");var l=Je("head");l.insertBefore(this.styleEl_,u?u.nextSibling:l.firstChild)}this.fill_=false;this.fluid_=false;this.width(this.options_.width);this.height(this.options_.height);this.fill(this.options_.fill);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);var d=t.getElementsByTagName("a");for(var c=0;c<d.length;c++){var h=d.item(c);Me(h,"vjs-hidden");h.setAttribute("hidden","hidden")}t.initNetworkState_=t.networkState;if(t.parentNode&&!r)t.parentNode.insertBefore(i,t);Oe(t,i);this.children_.unshift(t);this.el_.setAttribute("lang",this.language_);this.el_.setAttribute("translate","no");this.el_=i;return i};i.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");if("anonymous"!==e&&"use-credentials"!==e){G.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"');return}this.techCall_("setCrossOrigin",e);return};i.width=function(e){return this.dimension("width",e)};i.height=function(e){return this.dimension("height",e)};i.dimension=function(e,t){var i=e+"_";if(void 0===t)return this[i]||0;if(""===t||"auto"===t){this[i]=void 0;this.updateStyleEl_();return}var r=parseFloat(t);if(isNaN(r)){G.error('Improper value "'+t+'" supplied for for '+e);return}this[i]=r;this.updateStyleEl_()};i.fluid=function(e){var t=this;if(void 0===e)return!!this.fluid_;this.fluid_=!!e;if(Dt(this))this.off(["playerreset","resize"],this.boundUpdateStyleEl_);if(e){this.addClass("vjs-fluid");this.fill(false);Mt(this,(function(){t.on(["playerreset","resize"],t.boundUpdateStyleEl_)}))}else this.removeClass("vjs-fluid");this.updateStyleEl_()};i.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e;if(e){this.addClass("vjs-fill");this.fluid(false)}else this.removeClass("vjs-fill")};i.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e;this.fluid(true);this.updateStyleEl_()};i.updateStyleEl_=function(){if(true===n().VIDEOJS_NO_DYNAMIC_STYLE){var e="number"===typeof this.width_?this.width_:this.options_.width;var t="number"===typeof this.height_?this.height_:this.options_.height;var i=this.tech_&&this.tech_.el();if(i){if(e>=0)i.width=e;if(t>=0)i.height=t}return}var r;var a;var s;var o;if(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_)s=this.aspectRatio_;else if(this.videoWidth()>0)s=this.videoWidth()+":"+this.videoHeight();else s="16:9";var u=s.split(":");var l=u[1]/u[0];if(void 0!==this.width_)r=this.width_;else if(void 0!==this.height_)r=this.height_/l;else r=this.videoWidth()||300;if(void 0!==this.height_)a=this.height_;else a=r*l;if(/^[^a-zA-Z]/.test(this.id()))o="dimensions-"+this.id();else o=this.id()+"-dimensions";this.addClass(o);ut(this.styleEl_,"\n      ."+o+" {\n        width: "+r+"px;\n        height: "+a+"px;\n      }\n\n      ."+o+".vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: "+100*l+"%;\n      }\n    ")};i.loadTech_=function(e,t){var i=this;if(this.tech_)this.unloadTech_();var r=Gt(e);var n=e.charAt(0).toLowerCase()+e.slice(1);if("Html5"!==r&&this.tag){Zi.getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null}this.techName_=r;this.isReady_=false;var a=this.autoplay();if("string"===typeof this.autoplay()||true===this.autoplay()&&this.options_.normalizeAutoplay)a=false;var s={source:t,autoplay:a,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+n+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||false,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Gi.names.forEach((function(e){var t=Gi[e];s[t.getterName]=i[t.privateName]}));$(s,this.options_[r]);$(s,this.options_[n]);$(s,this.options_[e.toLowerCase()]);if(this.tag)s.tag=this.tag;if(t&&t.src===this.cache_.src&&this.cache_.currentTime>0)s.startTime=this.cache_.currentTime;var o=Zi.getTech(e);if(!o)throw new Error("No Tech named '"+r+"' exists! '"+r+"' should be registered using videojs.registerTech()'");this.tech_=new o(s);this.tech_.ready(It(this,this.handleTechReady_),true);hi.jsonToTextTracks(this.textTracksJson_||[],this.tech_);fa.forEach((function(e){i.on(i.tech_,e,(function(t){return i["handleTech"+Gt(e)+"_"](t)}))}));Object.keys(pa).forEach((function(e){i.on(i.tech_,e,(function(t){if(0===i.tech_.playbackRate()&&i.tech_.seeking()){i.queuedCallbacks_.push({callback:i["handleTech"+pa[e]+"_"].bind(i),event:t});return}i["handleTech"+pa[e]+"_"](t)}))}));this.on(this.tech_,"loadstart",(function(e){return i.handleTechLoadStart_(e)}));this.on(this.tech_,"sourceset",(function(e){return i.handleTechSourceset_(e)}));this.on(this.tech_,"waiting",(function(e){return i.handleTechWaiting_(e)}));this.on(this.tech_,"ended",(function(e){return i.handleTechEnded_(e)}));this.on(this.tech_,"seeking",(function(e){return i.handleTechSeeking_(e)}));this.on(this.tech_,"play",(function(e){return i.handleTechPlay_(e)}));this.on(this.tech_,"firstplay",(function(e){return i.handleTechFirstPlay_(e)}));this.on(this.tech_,"pause",(function(e){return i.handleTechPause_(e)}));this.on(this.tech_,"durationchange",(function(e){return i.handleTechDurationChange_(e)}));this.on(this.tech_,"fullscreenchange",(function(e,t){return i.handleTechFullscreenChange_(e,t)}));this.on(this.tech_,"fullscreenerror",(function(e,t){return i.handleTechFullscreenError_(e,t)}));this.on(this.tech_,"enterpictureinpicture",(function(e){return i.handleTechEnterPictureInPicture_(e)}));this.on(this.tech_,"leavepictureinpicture",(function(e){return i.handleTechLeavePictureInPicture_(e)}));this.on(this.tech_,"error",(function(e){return i.handleTechError_(e)}));this.on(this.tech_,"posterchange",(function(e){return i.handleTechPosterChange_(e)}));this.on(this.tech_,"textdata",(function(e){return i.handleTechTextData_(e)}));this.on(this.tech_,"ratechange",(function(e){return i.handleTechRateChange_(e)}));this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_);this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls())this.addTechControlsListeners_();if(this.tech_.el().parentNode!==this.el()&&("Html5"!==r||!this.tag))Oe(this.tech_.el(),this.el());if(this.tag){this.tag.player=null;this.tag=null}};i.unloadTech_=function(){var e=this;Gi.names.forEach((function(t){var i=Gi[t];e[i.privateName]=e[i.getterName]()}));this.textTracksJson_=hi.textTracksToJson(this.tech_);this.isReady_=false;this.tech_.dispose();this.tech_=false;if(this.isPosterFromTech_){this.poster_="";this.trigger("posterchange")}this.isPosterFromTech_=false};i.tech=function(e){if(void 0===e)G.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\n"+"See https://github.com/videojs/video.js/issues/2617 for more info.\n");return this.tech_};i.addTechControlsListeners_=function(){this.removeTechControlsListeners_();this.on(this.tech_,"click",this.boundHandleTechClick_);this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_);this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_);this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_);this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_);this.on(this.tech_,"tap",this.boundHandleTechTap_)};i.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_);this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_);this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_);this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_);this.off(this.tech_,"click",this.boundHandleTechClick_);this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)};i.handleTechReady_=function(){this.triggerReady();if(this.cache_.volume)this.techCall_("setVolume",this.cache_.volume);this.handleTechPosterChange_();this.handleTechDurationChange_()};i.handleTechLoadStart_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);this.handleTechDurationChange_();if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay")}else{this.hasStarted(false);this.trigger("loadstart")}this.manualAutoplay_(true===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())};i.manualAutoplay_=function(e){var t=this;if(!this.tech_||"string"!==typeof e)return;var i=function(){var e=t.muted();t.muted(true);var i=function(){t.muted(e)};t.playTerminatedQueue_.push(i);var r=t.play();if(!oi(r))return;return r["catch"]((function(e){i();throw new Error("Rejection at manualAutoplay. Restoring muted value. "+(e?e:""))}))};var r;if("any"===e&&!this.muted()){r=this.play();if(oi(r))r=r["catch"](i)}else if("muted"===e&&!this.muted())r=i();else r=this.play();if(!oi(r))return;return r.then((function(){t.trigger({type:"autoplay-success",autoplay:e})}))["catch"]((function(){t.trigger({type:"autoplay-failure",autoplay:e})}))};i.updateSourceCaches_=function(e){if(void 0===e)e="";var t=e;var i="";if("string"!==typeof t){t=e.src;i=e.type}this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];if(t&&!i)i=pr(this,t);this.cache_.source=Zt({},e,{src:t,type:i});var r=this.cache_.sources.filter((function(e){return e.src&&e.src===t}));var n=[];var a=this.$$("source");var s=[];for(var o=0;o<a.length;o++){var u=Ne(a[o]);n.push(u);if(u.src&&u.src===t)s.push(u.src)}if(s.length&&!r.length)this.cache_.sources=n;else if(!r.length)this.cache_.sources=[this.cache_.source];this.cache_.src=t};i.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var i=function(e){return t.updateSourceCaches_(e)};var r=this.currentSource().src;var n=e.src;if(r&&!/^blob:/.test(r)&&/^blob:/.test(n))if(!this.lastSource_||this.lastSource_.tech!==n&&this.lastSource_.player!==r)i=function(){};i(n);if(!e.src)this.tech_.any(["sourceset","loadstart"],(function(e){if("sourceset"===e.type)return;var i=t.techGet("currentSrc");t.lastSource_.tech=i;t.updateSourceCaches_(i)}))}this.lastSource_={player:this.currentSource().src,tech:e.src};this.trigger({src:e.src,type:"sourceset"})};i.hasStarted=function(e){if(void 0===e)return this.hasStarted_;if(e===this.hasStarted_)return;this.hasStarted_=e;if(this.hasStarted_){this.addClass("vjs-has-started");this.trigger("firstplay")}else this.removeClass("vjs-has-started")};i.handleTechPlay_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(true);this.trigger("play")};i.handleTechRateChange_=function(){if(this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate){this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)}));this.queuedCallbacks_=[]}this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")};i.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting");this.trigger("waiting");var t=this.currentTime();var i=function i(){if(t!==e.currentTime()){e.removeClass("vjs-waiting");e.off("timeupdate",i)}};this.on("timeupdate",i)};i.handleTechCanPlay_=function(){this.removeClass("vjs-waiting");this.trigger("canplay")};i.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")};i.handleTechPlaying_=function(){this.removeClass("vjs-waiting");this.trigger("playing")};i.handleTechSeeking_=function(){this.addClass("vjs-seeking");this.trigger("seeking")};i.handleTechSeeked_=function(){this.removeClass("vjs-seeking");this.removeClass("vjs-ended");this.trigger("seeked")};i.handleTechFirstPlay_=function(){if(this.options_.starttime){G.warn("Passing the `starttime` option to the player will be deprecated in 6.0");this.currentTime(this.options_.starttime)}this.addClass("vjs-has-started");this.trigger("firstplay")};i.handleTechPause_=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")};i.handleTechEnded_=function(){this.addClass("vjs-ended");this.removeClass("vjs-waiting");if(this.options_.loop){this.currentTime(0);this.play()}else if(!this.paused())this.pause();this.trigger("ended")};i.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))};i.handleTechClick_=function(e){if(!this.controls_)return;if(void 0===this.options_||void 0===this.options_.userActions||void 0===this.options_.userActions.click||false!==this.options_.userActions.click)if(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"===typeof this.options_.userActions.click)this.options_.userActions.click.call(this,e);else if(this.paused())ui(this.play());else this.pause()};i.handleTechDoubleClick_=function(e){if(!this.controls_)return;var t=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(t){return t.contains(e.target)}));if(!t)if(void 0===this.options_||void 0===this.options_.userActions||void 0===this.options_.userActions.doubleClick||false!==this.options_.userActions.doubleClick)if(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"===typeof this.options_.userActions.doubleClick)this.options_.userActions.doubleClick.call(this,e);else if(this.isFullscreen())this.exitFullscreen();else this.requestFullscreen()};i.handleTechTap_=function(){this.userActive(!this.userActive())};i.handleTechTouchStart_=function(){this.userWasActive=this.userActive()};i.handleTechTouchMove_=function(){if(this.userWasActive)this.reportUserActivity()};i.handleTechTouchEnd_=function(e){if(e.cancelable)e.preventDefault()};i.handleStageClick_=function(){this.reportUserActivity()};i.toggleFullscreenClass_=function(){if(this.isFullscreen())this.addClass("vjs-fullscreen");else this.removeClass("vjs-fullscreen")};i.documentFullscreenChange_=function(e){var t=e.target.player;if(t&&t!==this)return;var i=this.el();var r=s()[this.fsApi_.fullscreenElement]===i;if(!r&&i.matches)r=i.matches(":"+this.fsApi_.fullscreen);else if(!r&&i.msMatchesSelector)r=i.msMatchesSelector(":"+this.fsApi_.fullscreen);this.isFullscreen(r)};i.handleTechFullscreenChange_=function(e,t){var i=this;if(t){if(t.nativeIOSFullscreen){this.addClass("vjs-ios-native-fs");this.tech_.one("webkitendfullscreen",(function(){i.removeClass("vjs-ios-native-fs")}))}this.isFullscreen(t.isFullscreen)}};i.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)};i.togglePictureInPictureClass_=function(){if(this.isInPictureInPicture())this.addClass("vjs-picture-in-picture");else this.removeClass("vjs-picture-in-picture")};i.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(true)};i.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(false)};i.handleTechError_=function(){var e=this.tech_.error();this.error(e)};i.handleTechTextData_=function(){var e=null;if(arguments.length>1)e=arguments[1];this.trigger("textdata",e)};i.getCache=function(){return this.cache_};i.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}};i.techCall_=function(e,t){this.ready((function(){if(e in ar)return ir(this.middleware_,this.tech_,e,t);else if(e in sr)return rr(this.middleware_,this.tech_,e,t);try{if(this.tech_)this.tech_[e](t)}catch(i){G(i);throw i}}),true)};i.techGet_=function(e){if(!this.tech_||!this.tech_.isReady_)return;if(e in nr)return tr(this.middleware_,this.tech_,e);else if(e in sr)return rr(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e]){G("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t);throw t}if("TypeError"===t.name){G("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t);this.tech_.isReady_=false;throw t}G(t);throw t}};i.play=function(){var e=this;var t=this.options_.Promise||n().Promise;if(t)return new t((function(t){e.play_(t)}));return this.play_()};i.play_=function(e){var t=this;if(void 0===e)e=ui;this.playCallbacks_.push(e);var i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_){this.off(["ready","loadstart"],this.waitToPlay_);this.waitToPlay_=null}if(!this.isReady_||!i){this.waitToPlay_=function(e){t.play_()};this.one(["ready","loadstart"],this.waitToPlay_);if(!i&&(be||Te))this.load();return}var r=this.techGet_("play");if(null===r)this.runPlayTerminatedQueue_();else this.runPlayCallbacks_(r)};i.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[];e.forEach((function(e){e()}))};i.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[];this.playTerminatedQueue_=[];t.forEach((function(t){t(e)}))};i.pause=function(){this.techCall_("pause")};i.paused=function(){return false===this.techGet_("paused")?false:true};i.played=function(){return this.techGet_("played")||ri(0,0)};i.scrubbing=function(e){if("undefined"===typeof e)return this.scrubbing_;this.scrubbing_=!!e;this.techCall_("setScrubbing",this.scrubbing_);if(e)this.addClass("vjs-scrubbing");else this.removeClass("vjs-scrubbing")};i.currentTime=function(e){if("undefined"!==typeof e){if(e<0)e=0;if(!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e;this.off("canplay",this.boundApplyInitTime_);this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e);this.cache_.initTime=0;return}this.cache_.currentTime=this.techGet_("currentTime")||0;return this.cache_.currentTime};i.applyInitTime_=function(){this.currentTime(this.cache_.initTime)};i.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;e=parseFloat(e);if(e<0)e=1/0;if(e!==this.cache_.duration){this.cache_.duration=e;if(e===1/0)this.addClass("vjs-live");else this.removeClass("vjs-live");if(!isNaN(e))this.trigger("durationchange")}};i.remainingTime=function(){return this.duration()-this.currentTime()};i.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())};i.buffered=function(){var e=this.techGet_("buffered");if(!e||!e.length)e=ri(0,0);return e};i.bufferedPercent=function(){return ni(this.buffered(),this.duration())};i.bufferedEnd=function(){var e=this.buffered();var t=this.duration();var i=e.end(e.length-1);if(i>t)i=t;return i};i.volume=function(e){var t;if(void 0!==e){t=Math.max(0,Math.min(1,parseFloat(e)));this.cache_.volume=t;this.techCall_("setVolume",t);if(t>0)this.lastVolume_(t);return}t=parseFloat(this.techGet_("volume"));return isNaN(t)?1:t};i.muted=function(e){if(void 0!==e){this.techCall_("setMuted",e);return}return this.techGet_("muted")||false};i.defaultMuted=function(e){if(void 0!==e)return this.techCall_("setDefaultMuted",e);return this.techGet_("defaultMuted")||false};i.lastVolume_=function(e){if(void 0!==e&&0!==e){this.cache_.lastVolume=e;return}return this.cache_.lastVolume};i.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||false};i.isFullscreen=function(e){if(void 0!==e){var t=this.isFullscreen_;this.isFullscreen_=Boolean(e);if(this.isFullscreen_!==t&&this.fsApi_.prefixed)this.trigger("fullscreenchange");this.toggleFullscreenClass_();return}return this.isFullscreen_};i.requestFullscreen=function(e){var t=this.options_.Promise||n().Promise;if(t){var i=this;return new t((function(t,r){function n(){i.off("fullscreenerror",s);i.off("fullscreenchange",a)}function a(){n();t()}function s(e,t){n();r(t)}i.one("fullscreenchange",a);i.one("fullscreenerror",s);var o=i.requestFullscreenHelper_(e);if(o){o.then(n,n);o.then(t,r)}}))}return this.requestFullscreenHelper_()};i.requestFullscreenHelper_=function(e){var t=this;var i;if(!this.fsApi_.prefixed){i=this.options_.fullscreen&&this.options_.fullscreen.options||{};if(void 0!==e)i=e}if(this.fsApi_.requestFullscreen){var r=this.el_[this.fsApi_.requestFullscreen](i);if(r)r.then((function(){return t.isFullscreen(true)}),(function(){return t.isFullscreen(false)}));return r}else if(this.tech_.supportsFullScreen()&&true===!this.options_.preferFullWindow)this.techCall_("enterFullScreen");else this.enterFullWindow()};i.exitFullscreen=function(){var e=this.options_.Promise||n().Promise;if(e){var t=this;return new e((function(e,i){function r(){t.off("fullscreenerror",a);t.off("fullscreenchange",n)}function n(){r();e()}function a(e,t){r();i(t)}t.one("fullscreenchange",n);t.one("fullscreenerror",a);var s=t.exitFullscreenHelper_();if(s){s.then(r,r);s.then(e,i)}}))}return this.exitFullscreenHelper_()};i.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var t=s()[this.fsApi_.exitFullscreen]();if(t)ui(t.then((function(){return e.isFullscreen(false)})));return t}else if(this.tech_.supportsFullScreen()&&true===!this.options_.preferFullWindow)this.techCall_("exitFullScreen");else this.exitFullWindow()};i.enterFullWindow=function(){this.isFullscreen(true);this.isFullWindow=true;this.docOrigOverflow=s().documentElement.style.overflow;Tt(s(),"keydown",this.boundFullWindowOnEscKey_);s().documentElement.style.overflow="hidden";Me(s().body,"vjs-full-window");this.trigger("enterFullWindow")};i.fullWindowOnEscKey=function(e){if(l().isEventKey(e,"Esc"))if(true===this.isFullscreen())if(!this.isFullWindow)this.exitFullscreen();else this.exitFullWindow()};i.exitFullWindow=function(){this.isFullscreen(false);this.isFullWindow=false;bt(s(),"keydown",this.boundFullWindowOnEscKey_);s().documentElement.style.overflow=this.docOrigOverflow;Re(s().body,"vjs-full-window");this.trigger("exitFullWindow")};i.disablePictureInPicture=function(e){if(void 0===e)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e);this.options_.disablePictureInPicture=e;this.trigger("disablepictureinpicturechanged")};i.isInPictureInPicture=function(e){if(void 0!==e){this.isInPictureInPicture_=!!e;this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_};i.requestPictureInPicture=function(){if("pictureInPictureEnabled"in s()&&false===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")};i.exitPictureInPicture=function(){if("pictureInPictureEnabled"in s())return s().exitPictureInPicture()};i.handleKeyDown=function(e){var t=this.options_.userActions;if(!t||!t.hotkeys)return;var i=function(e){var t=e.tagName.toLowerCase();if(e.isContentEditable)return true;var i=["button","checkbox","hidden","radio","reset","submit"];if("input"===t)return-1===i.indexOf(e.type);var r=["textarea"];return-1!==r.indexOf(t)};if(i(this.el_.ownerDocument.activeElement))return;if("function"===typeof t.hotkeys)t.hotkeys.call(this,e);else this.handleHotkeys(e)};i.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{};var i=t.fullscreenKey,r=void 0===i?function(e){return l().isEventKey(e,"f")}:i,n=t.muteKey,a=void 0===n?function(e){return l().isEventKey(e,"m")}:n,o=t.playPauseKey,u=void 0===o?function(e){return l().isEventKey(e,"k")||l().isEventKey(e,"Space")}:o;if(r.call(this,e)){e.preventDefault();e.stopPropagation();var d=Jt.getComponent("FullscreenToggle");if(false!==s()[this.fsApi_.fullscreenEnabled])d.prototype.handleClick.call(this,e)}else if(a.call(this,e)){e.preventDefault();e.stopPropagation();var c=Jt.getComponent("MuteToggle");c.prototype.handleClick.call(this,e)}else if(u.call(this,e)){e.preventDefault();e.stopPropagation();var h=Jt.getComponent("PlayToggle");h.prototype.handleClick.call(this,e)}};i.canPlayType=function(e){var t;for(var i=0,r=this.options_.techOrder;i<r.length;i++){var n=r[i];var a=Zi.getTech(n);if(!a)a=Jt.getComponent(n);if(!a){G.error('The "'+n+'" tech is undefined. Skipped browser support check for that tech.');continue}if(a.isSupported()){t=a.canPlayType(e);if(t)return t}}return""};i.selectSource=function(e){var t=this;var i=this.options_.techOrder.map((function(e){return[e,Zi.getTech(e)]})).filter((function(e){var t=e[0],i=e[1];if(i)return i.isSupported();G.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.');return false}));var r=function(e,t,i){var r;e.some((function(e){return t.some((function(t){r=i(e,t);if(r)return true}))}));return r};var n;var a=function(e){return function(t,i){return e(i,t)}};var s=function(e,i){var r=e[0],n=e[1];if(n.canPlaySource(i,t.options_[r.toLowerCase()]))return{source:i,tech:r}};if(this.options_.sourceOrder)n=r(e,i,a(s));else n=r(i,e,s);return n||false};i.handleSrc_=function(e,t){var i=this;if("undefined"===typeof e)return this.cache_.src||"";if(this.resetRetryOnError_)this.resetRetryOnError_();var r=mr(e);if(!r.length){this.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0);return}this.changingSrc_=true;if(!t)this.cache_.sources=r;this.updateSourceCaches_(r[0]);Ji(this,r[0],(function(e,n){i.middleware_=n;if(!t)i.cache_.sources=r;i.updateSourceCaches_(e);var a=i.src_(e);if(a){if(r.length>1)return i.handleSrc_(r.slice(1));i.changingSrc_=false;i.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0);i.triggerReady();return}er(n,i.tech_)}));if(this.options_.retryOnError&&r.length>1){var n=function(){i.error(null);i.handleSrc_(r.slice(1),true)};var a=function(){i.off("error",n)};this.one("error",n);this.one("playing",a);this.resetRetryOnError_=function(){i.off("error",n);i.off("playing",a)}}};i.src=function(e){return this.handleSrc_(e,false)};i.src_=function(e){var t=this;var i=this.selectSource([e]);if(!i)return true;if(!Kt(i.tech,this.techName_)){this.changingSrc_=true;this.loadTech_(i.tech,i.source);this.tech_.ready((function(){t.changingSrc_=false}));return false}this.ready((function(){if(this.tech_.constructor.prototype.hasOwnProperty("setSource"))this.techCall_("setSource",e);else this.techCall_("src",e.src);this.changingSrc_=false}),true);return false};i.load=function(){this.techCall_("load")};i.reset=function(){var e=this;var t=this.options_.Promise||n().Promise;if(this.paused()||!t)this.doReset_();else{var i=this.play();ui(i.then((function(){return e.doReset_()})))}};i.doReset_=function(){if(this.tech_)this.tech_.clearTracks("text");this.resetCache_();this.poster("");this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset");this.resetControlBarUI_();if(Dt(this))this.trigger("playerreset")};i.resetControlBarUI_=function(){this.resetProgressBar_();this.resetPlaybackRate_();this.resetVolumeBar_()};i.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar||{},t=e.durationDisplay,i=e.remainingTimeDisplay;if(t)t.updateContent();if(i)i.updateContent()};i.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate());this.handleTechRateChange_()};i.resetVolumeBar_=function(){this.volume(1);this.trigger("volumechange")};i.currentSources=function(){var e=this.currentSource();var t=[];if(0!==Object.keys(e).length)t.push(e);return this.cache_.sources||t};i.currentSource=function(){return this.cache_.source||{}};i.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""};i.currentType=function(){return this.currentSource()&&this.currentSource().type||""};i.preload=function(e){if(void 0!==e){this.techCall_("setPreload",e);this.options_.preload=e;return}return this.techGet_("preload")};i.autoplay=function(e){if(void 0===e)return this.options_.autoplay||false;var t;if("string"===typeof e&&/(any|play|muted)/.test(e)||true===e&&this.options_.normalizeAutoplay){this.options_.autoplay=e;this.manualAutoplay_("string"===typeof e?e:"play");t=false}else if(!e)this.options_.autoplay=false;else this.options_.autoplay=true;t="undefined"===typeof t?this.options_.autoplay:t;if(this.tech_)this.techCall_("setAutoplay",t)};i.playsinline=function(e){if(void 0!==e){this.techCall_("setPlaysinline",e);this.options_.playsinline=e;return this}return this.techGet_("playsinline")};i.loop=function(e){if(void 0!==e){this.techCall_("setLoop",e);this.options_.loop=e;return}return this.techGet_("loop")};i.poster=function(e){if(void 0===e)return this.poster_;if(!e)e="";if(e===this.poster_)return;this.poster_=e;this.techCall_("setPoster",e);this.isPosterFromTech_=false;this.trigger("posterchange")};i.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";if(e!==this.poster_){this.poster_=e;this.isPosterFromTech_=true;this.trigger("posterchange")}}};i.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e;if(this.controls_===e)return;this.controls_=e;if(this.usingNativeControls())this.techCall_("setControls",e);if(this.controls_){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls())this.addTechControlsListeners_()}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls())this.removeTechControlsListeners_()}};i.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e;if(this.usingNativeControls_===e)return;this.usingNativeControls_=e;if(this.usingNativeControls_){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols")}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols")}};i.error=function(e){var t=this;if(void 0===e)return this.error_||null;D("beforeerror").forEach((function(i){var r=i(t,e);if(!(J(r)&&!Array.isArray(r)||"string"===typeof r||"number"===typeof r||null===r)){t.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=r}));if(this.options_.suppressNotSupportedError&&e&&4===e.code){var i=function(){this.error(e)};this.options_.suppressNotSupportedError=false;this.any(["click","touchstart"],i);this.one("loadstart",(function(){this.off(["click","touchstart"],i)}));return}if(null===e){this.error_=e;this.removeClass("vjs-error");if(this.errorDisplay)this.errorDisplay.close();return}this.error_=new ai(e);this.addClass("vjs-error");G.error("(CODE:"+this.error_.code+" "+ai.errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");D("error").forEach((function(e){return e(t,t.error_)}));return};i.reportUserActivity=function(e){this.userActivity_=true};i.userActive=function(e){if(void 0===e)return this.userActive_;e=!!e;if(e===this.userActive_)return;this.userActive_=e;if(this.userActive_){this.userActivity_=true;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");return}if(this.tech_)this.tech_.one("mousemove",(function(e){e.stopPropagation();e.preventDefault()}));this.userActivity_=false;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")};i.listenForUserActivity_=function(){var e;var t;var i;var r=It(this,this.reportUserActivity);var n=function(e){if(e.screenX!==t||e.screenY!==i){t=e.screenX;i=e.screenY;r()}};var a=function(){r();this.clearInterval(e);e=this.setInterval(r,250)};var s=function(t){r();this.clearInterval(e)};this.on("mousedown",a);this.on("mousemove",n);this.on("mouseup",s);this.on("mouseleave",s);var o=this.getChild("controlBar");if(o&&!Te&&!oe){o.on("mouseenter",(function(e){if(0!==this.player().options_.inactivityTimeout)this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout;this.player().options_.inactivityTimeout=0}));o.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))}this.on("keydown",r);this.on("keyup",r);var u;this.setInterval((function(){if(!this.userActivity_)return;this.userActivity_=false;this.userActive(true);this.clearTimeout(u);var e=this.options_.inactivityTimeout;if(e<=0)return;u=this.setTimeout((function(){if(!this.userActivity_)this.userActive(false)}),e)}),250)};i.playbackRate=function(e){if(void 0!==e){this.techCall_("setPlaybackRate",e);return}if(this.tech_&&this.tech_.featuresPlaybackRate)return this.cache_.lastPlaybackRate||this.techGet_("playbackRate");return 1};i.defaultPlaybackRate=function(e){if(void 0!==e)return this.techCall_("setDefaultPlaybackRate",e);if(this.tech_&&this.tech_.featuresPlaybackRate)return this.techGet_("defaultPlaybackRate");return 1};i.isAudio=function(e){if(void 0!==e){this.isAudio_=!!e;return}return!!this.isAudio_};i.enableAudioOnlyUI_=function(){var e=this;this.addClass("vjs-audio-only-mode");var t=this.children();var i=this.getChild("ControlBar");var r=i&&i.currentHeight();t.forEach((function(t){if(t===i)return;if(t.el_&&!t.hasClass("vjs-hidden")){t.hide();e.audioOnlyCache_.hiddenChildren.push(t)}}));this.audioOnlyCache_.playerHeight=this.currentHeight();this.height(r);this.trigger("audioonlymodechange")};i.disableAudioOnlyUI_=function(){this.removeClass("vjs-audio-only-mode");this.audioOnlyCache_.hiddenChildren.forEach((function(e){return e.show()}));this.height(this.audioOnlyCache_.playerHeight);this.trigger("audioonlymodechange")};i.audioOnlyMode=function(e){var t=this;if("boolean"!==typeof e||e===this.audioOnlyMode_)return this.audioOnlyMode_;this.audioOnlyMode_=e;var i=this.options_.Promise||n().Promise;if(i){if(e){var r=[];if(this.isInPictureInPicture())r.push(this.exitPictureInPicture());if(this.isFullscreen())r.push(this.exitFullscreen());if(this.audioPosterMode())r.push(this.audioPosterMode(false));return i.all(r).then((function(){return t.enableAudioOnlyUI_()}))}return i.resolve().then((function(){return t.disableAudioOnlyUI_()}))}if(e){if(this.isInPictureInPicture())this.exitPictureInPicture();if(this.isFullscreen())this.exitFullscreen();this.enableAudioOnlyUI_()}else this.disableAudioOnlyUI_()};i.enablePosterModeUI_=function(){var e=this.tech_&&this.tech_;e.hide();this.addClass("vjs-audio-poster-mode");this.trigger("audiopostermodechange")};i.disablePosterModeUI_=function(){var e=this.tech_&&this.tech_;e.show();this.removeClass("vjs-audio-poster-mode");this.trigger("audiopostermodechange")};i.audioPosterMode=function(e){var t=this;if("boolean"!==typeof e||e===this.audioPosterMode_)return this.audioPosterMode_;this.audioPosterMode_=e;var i=this.options_.Promise||n().Promise;if(i){if(e){if(this.audioOnlyMode()){var r=this.audioOnlyMode(false);return r.then((function(){t.enablePosterModeUI_()}))}return i.resolve().then((function(){t.enablePosterModeUI_()}))}return i.resolve().then((function(){t.disablePosterModeUI_()}))}if(e){if(this.audioOnlyMode())this.audioOnlyMode(false);this.enablePosterModeUI_();return}this.disablePosterModeUI_()};i.addTextTrack=function(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)};i.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)};i.removeRemoteTextTrack=function(e){if(void 0===e)e={};var t=e,i=t.track;if(!i)i=e;if(this.tech_)return this.tech_.removeRemoteTextTrack(i)};i.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")};i.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0};i.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0};i.language=function(e){if(void 0===e)return this.language_;if(this.language_!==String(e).toLowerCase()){this.language_=String(e).toLowerCase();if(Dt(this))this.trigger("languagechange")}};i.languages=function(){return Zt(t.prototype.options_.languages,this.languages_)};i.toJSON=function(){var e=Zt(this.options_);var t=e.tracks;e.tracks=[];for(var i=0;i<t.length;i++){var r=t[i];r=Zt(r);r.player=void 0;e.tracks[i]=r}return e};i.createModal=function(e,t){var i=this;t=t||{};t.content=e||"";var r=new pi(this,t);this.addChild(r);r.on("dispose",(function(){i.removeChild(r)}));r.open();return r};i.updateCurrentBreakpoint_=function(){if(!this.responsive())return;var e=this.currentBreakpoint();var t=this.currentWidth();for(var i=0;i<ma.length;i++){var r=ma[i];var n=this.breakpoints_[r];if(t<=n){if(e===r)return;if(e)this.removeClass(va[e]);this.addClass(va[r]);this.breakpoint_=r;break}}};i.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="";if(e)this.removeClass(e)};i.breakpoints=function(e){if(void 0===e)return $(this.breakpoints_);this.breakpoint_="";this.breakpoints_=$({},ga,e);this.updateCurrentBreakpoint_();return $(this.breakpoints_)};i.responsive=function(e){if(void 0===e)return this.responsive_;e=Boolean(e);var t=this.responsive_;if(e===t)return;this.responsive_=e;if(e){this.on("playerresize",this.boundUpdateCurrentBreakpoint_);this.updateCurrentBreakpoint_()}else{this.off("playerresize",this.boundUpdateCurrentBreakpoint_);this.removeCurrentBreakpoint_()}return e};i.currentBreakpoint=function(){return this.breakpoint_};i.currentBreakpointClass=function(){return va[this.breakpoint_]||""};i.loadMedia=function(e,t){var i=this;if(!e||"object"!==typeof e)return;this.reset();this.cache_.media=Zt(e);var r=this.cache_.media,n=r.artwork,a=r.poster,s=r.src,o=r.textTracks;if(!n&&a)this.cache_.media.artwork=[{src:a,type:fr(a)}];if(s)this.src(s);if(a)this.poster(a);if(Array.isArray(o))o.forEach((function(e){return i.addRemoteTextTrack(e,false)}));this.ready(t)};i.getMedia=function(){if(!this.cache_.media){var e=this.poster();var t=this.currentSources();var i=Array.prototype.map.call(this.remoteTextTracks(),(function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}}));var r={src:t,textTracks:i};if(e){r.poster=e;r.artwork=[{src:r.poster,type:fr(r.poster)}]}return r}return Zt(this.cache_.media)};t.getTagSettings=function(e){var t={sources:[],tracks:[]};var i=Ne(e);var r=i["data-setup"];if(De(e,"vjs-fill"))i.fill=true;if(De(e,"vjs-fluid"))i.fluid=true;if(null!==r){var n=f()(r||"{}"),a=n[0],s=n[1];if(a)G.error(a);$(i,s)}$(t,i);if(e.hasChildNodes()){var o=e.childNodes;for(var u=0,l=o.length;u<l;u++){var d=o[u];var c=d.nodeName.toLowerCase();if("source"===c)t.sources.push(Ne(d));else if("track"===c)t.tracks.push(Ne(d))}}return t};i.flexNotSupported_=function(){var e=s().createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)};i.debug=function(e){if(void 0===e)return this.debugEnabled_;if(e){this.trigger("debugon");this.previousLogLevel_=this.log.level;this.log.level("debug");this.debugEnabled_=true}else{this.trigger("debugoff");this.log.level(this.previousLogLevel_);this.previousLogLevel_=void 0;this.debugEnabled_=false}};i.playbackRates=function(e){if(void 0===e)return this.cache_.playbackRates;if(!Array.isArray(e))return;if(!e.every((function(e){return"number"===typeof e})))return;this.cache_.playbackRates=e;this.trigger("playbackrateschange")};return t}(Jt);Gi.names.forEach((function(e){var t=Gi[e];_a.prototype[t.getterName]=function(){if(this.tech_)return this.tech_[t.getterName]();this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}}));_a.prototype.crossorigin=_a.prototype.crossOrigin;_a.players={};var ya=n().navigator;_a.prototype.options_={techOrder:Zi.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:false,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:ya&&(ya.languages&&ya.languages[0]||ya.userLanguage||ya.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:false,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:false,audioOnlyMode:false,audioPosterMode:false};["ended","seeking","seekable","networkState","readyState"].forEach((function(e){_a.prototype[e]=function(){return this.techGet_(e)}}));fa.forEach((function(e){_a.prototype["handleTech"+Gt(e)+"_"]=function(){return this.trigger(e)}}));Jt.registerComponent("Player",_a);var Ta="plugin";var ba="activePlugins_";var Sa={};var ka=function(e){return Sa.hasOwnProperty(e)};var Ca=function(e){return ka(e)?Sa[e]:void 0};var Ea=function(e,t){e[ba]=e[ba]||{};e[ba][t]=true};var wa=function(e,t,i){var r=(i?"before":"")+"pluginsetup";e.trigger(r,t);e.trigger(r+":"+t.name,t)};var Ia=function(e,t){var i=function(){wa(this,{name:e,plugin:t,instance:null},true);var i=t.apply(this,arguments);Ea(this,e);wa(this,{name:e,plugin:t,instance:i});return i};Object.keys(t).forEach((function(e){i[e]=t[e]}));return i};var xa=function(e,t){t.prototype.name=e;return function(){wa(this,{name:e,plugin:t,instance:null},true);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];var a=(0,_.Z)(t,[this].concat(r));this[e]=function(){return a};wa(this,a.getEventHash());return a}};var Pa=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t;if(!this.log)this.log=this.player.log.createLogger(this.name);qt(this);delete this.trigger;Wt(this,this.constructor.defaultState);Ea(t,this.name);this.dispose=this.dispose.bind(this);t.on("dispose",this.dispose)}var t=e.prototype;t.version=function(){return this.constructor.VERSION};t.getEventHash=function(e){if(void 0===e)e={};e.name=this.name;e.plugin=this.constructor;e.instance=this;return e};t.trigger=function(e,t){if(void 0===t)t={};return St(this.eventBusEl_,e,this.getEventHash(t))};t.handleStateChanged=function(e){};t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose");this.off();t.off("dispose",this.dispose);t[ba][e]=false;this.player=this.state=null;t[e]=xa(e,Sa[e])};e.isBasic=function(t){var i="string"===typeof t?Ca(t):t;return"function"===typeof i&&!e.prototype.isPrototypeOf(i.prototype)};e.registerPlugin=function(t,i){if("string"!==typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(ka(t))G.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(_a.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!==typeof i)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof i+".");Sa[t]=i;if(t!==Ta)if(e.isBasic(i))_a.prototype[t]=Ia(t,i);else _a.prototype[t]=xa(t,i);return i};e.deregisterPlugin=function(e){if(e===Ta)throw new Error("Cannot de-register base plugin.");if(ka(e)){delete Sa[e];delete _a.prototype[e]}};e.getPlugins=function(e){if(void 0===e)e=Object.keys(Sa);var t;e.forEach((function(e){var i=Ca(e);if(i){t=t||{};t[e]=i}}));return t};e.getPluginVersion=function(e){var t=Ca(e);return t&&t.VERSION||""};return e}();Pa.getPlugin=Ca;Pa.BASE_PLUGIN_NAME=Ta;Pa.registerPlugin(Ta,Pa);_a.prototype.usingPlugin=function(e){return!!this[ba]&&true===this[ba][e]};_a.prototype.hasPlugin=function(e){return!!ka(e)};var Aa=function(e,t){if(void 0===t)t={};var i=function(){e.apply(this,arguments)};var r={};if("object"===typeof t){if(t.constructor!==Object.prototype.constructor)i=t.constructor;r=t}else if("function"===typeof t)i=t;(0,y.Z)(i,e);if(e)i.super_=e;for(var n in r)if(r.hasOwnProperty(n))i.prototype[n]=r[n];return i};var La=function(e){return 0===e.indexOf("#")?e.slice(1):e};function Oa(e,t,i){var r=Oa.getPlayer(e);if(r){if(t)G.warn('Player "'+e+'" is already initialised. Options will not be applied.');if(i)r.ready(i);return r}var n="string"===typeof e?Je("#"+La(e)):e;if(!Ie(n))throw new TypeError("The element or ID supplied is not valid. (videojs)");if(!n.ownerDocument.defaultView||!n.ownerDocument.body.contains(n))G.warn("The element supplied is not included in the DOM");t=t||{};if(true===t.restoreEl)t.restoreEl=(n.parentNode&&n.parentNode.hasAttribute("data-vjs-player")?n.parentNode:n).cloneNode(true);D("beforesetup").forEach((function(e){var i=e(n,Zt(t));if(!J(i)||Array.isArray(i)){G.error("please return an object in beforesetup hooks");return}t=Zt(t,i)}));var a=Jt.getComponent("Player");r=new a(n,t,i);D("setup").forEach((function(e){return e(r)}));return r}Oa.hooks_=O;Oa.hooks=D;Oa.hook=M;Oa.hookOnce=U;Oa.removeHook=R;if(true!==n().VIDEOJS_NO_DYNAMIC_STYLE&&we()){var Da=Je(".vjs-styles-defaults");if(!Da){Da=ot("vjs-styles-defaults");var Ma=Je("head");if(Ma)Ma.insertBefore(Da,Ma.firstChild);ut(Da,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: 56.25%\n      }\n    ")}}at(1,Oa);Oa.VERSION=L;Oa.options=_a.prototype.options_;Oa.getPlayers=function(){return _a.players};Oa.getPlayer=function(e){var t=_a.players;var i;if("string"===typeof e){var r=La(e);var n=t[r];if(n)return n;i=Je("#"+r)}else i=e;if(Ie(i)){var a=i,s=a.player,o=a.playerId;if(s||t[o])return s||t[o]}};Oa.getAllPlayers=function(){return Object.keys(_a.players).map((function(e){return _a.players[e]})).filter(Boolean)};Oa.players=_a.players;Oa.getComponent=Jt.getComponent;Oa.registerComponent=function(e,t){if(Zi.isTech(t))G.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)");Jt.registerComponent.call(Jt,e,t)};Oa.getTech=Zi.getTech;Oa.registerTech=Zi.registerTech;Oa.use=$i;Object.defineProperty(Oa,"middleware",{value:{},writeable:false,enumerable:true});Object.defineProperty(Oa.middleware,"TERMINATOR",{value:Yi,writeable:false,enumerable:true});Oa.browser=Se;Oa.TOUCH_ENABLED=ge;Oa.extend=Aa;Oa.mergeOptions=Zt;Oa.bind=It;Oa.registerPlugin=Pa.registerPlugin;Oa.deregisterPlugin=Pa.deregisterPlugin;Oa.plugin=function(e,t){G.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead");return Pa.registerPlugin(e,t)};Oa.getPlugins=Pa.getPlugins;Oa.getPlugin=Pa.getPlugin;Oa.getPluginVersion=Pa.getPluginVersion;Oa.addLanguage=function(e,t){var i;e=(""+e).toLowerCase();Oa.options.languages=Zt(Oa.options.languages,(i={},i[e]=t,i));return Oa.options.languages[e]};Oa.log=G;Oa.createLogger=K;Oa.createTimeRange=Oa.createTimeRanges=ri;Oa.formatTime=Rr;Oa.setFormatTime=Dr;Oa.resetFormatTime=Mr;Oa.parseUrl=Pi;Oa.isCrossOrigin=Oi;Oa.EventTarget=At;Oa.on=Tt;Oa.one=kt;Oa.off=bt;Oa.trigger=St;Oa.xhr=m();Oa.TextTrack=Ui;Oa.AudioTrack=Bi;Oa.VideoTrack=Ni;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){Oa[e]=function(){G.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead");return tt[e].apply(null,arguments)}}));Oa.computedStyle=te;Oa.dom=tt;Oa.url=Di;Oa.defineLazyProperty=da;Oa.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});var Ra=T.Z;var Ua=function(e,t,i){if(e&&i&&i.responseURL&&t!==i.responseURL)return i.responseURL;return t};var Ba=function(e){if(Oa.log.debug)return Oa.log.debug.bind(Oa,"VHS:",e+" >");return function(){}};var Na=1/30;var Fa=3*Na;var ja=function(e,t){var i=[];var r;if(e&&e.length)for(r=0;r<e.length;r++)if(t(e.start(r),e.end(r)))i.push([e.start(r),e.end(r)]);return Oa.createTimeRanges(i)};var Ha=function(e,t){return ja(e,(function(e,i){return e-Fa<=t&&i+Fa>=t}))};var qa=function(e,t){return ja(e,(function(e){return e-Na>=t}))};var Va=function(e){if(e.length<2)return Oa.createTimeRanges();var t=[];for(var i=1;i<e.length;i++){var r=e.end(i-1);var n=e.start(i);t.push([r,n])}return Oa.createTimeRanges(t)};var Wa=function(e,t){var i=null;var r=null;var n=0;var a=[];var s=[];if(!e||!e.length||!t||!t.length)return Oa.createTimeRange();var o=e.length;while(o--){a.push({time:e.start(o),type:"start"});a.push({time:e.end(o),type:"end"})}o=t.length;while(o--){a.push({time:t.start(o),type:"start"});a.push({time:t.end(o),type:"end"})}a.sort((function(e,t){return e.time-t.time}));for(o=0;o<a.length;o++){if("start"===a[o].type){n++;if(2===n)i=a[o].time}else if("end"===a[o].type){n--;if(1===n)r=a[o].time}if(null!==i&&null!==r){s.push([i,r]);i=null;r=null}}return Oa.createTimeRanges(s)};var za=function(e){var t=[];if(!e||!e.length)return"";for(var i=0;i<e.length;i++)t.push(e.start(i)+" => "+e.end(i));return t.join(", ")};var Ga=function(e,t,i){if(void 0===i)i=1;var r=e.length?e.end(e.length-1):0;return(r-t)/i};var Ka=function(e){var t=[];for(var i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t};var Za=function(e,t){if(e===t)return false;if(!e&&t||!t&&e)return true;if(e.length!==t.length)return true;for(var i=0;i<e.length;i++)if(e.start(i)!==t.start(i)||e.end(i)!==t.end(i))return true;return false};var Qa=function(e){if(!e||!e.length||!e.end)return;return e.end(e.length-1)};var Xa=function(e,t){var i=0;if(!e||!e.length)return i;for(var r=0;r<e.length;r++){var n=e.start(r);var a=e.end(r);if(t>a)continue;if(t>n&&t<=a){i+=a-t;continue}i+=a-n}return i};var Ya=Oa.createTimeRange;var $a=function(e,t){if(!t.preload)return t.duration;var i=0;(t.parts||[]).forEach((function(e){i+=e.duration}));(t.preloadHints||[]).forEach((function(t){if("PART"===t.type)i+=e.partTargetDuration}));return i};var Ja=function(e){return(e.segments||[]).reduce((function(e,t,i){if(t.parts)t.parts.forEach((function(r,n){e.push({duration:r.duration,segmentIndex:i,partIndex:n,part:r,segment:t})}));else e.push({duration:t.duration,segmentIndex:i,partIndex:null,segment:t,part:null});return e}),[])};var es=function(e){var t=e.segments&&e.segments.length&&e.segments[e.segments.length-1];return t&&t.parts||[]};var ts=function(e){var t=e.preloadSegment;if(!t)return;var i=t.parts,r=t.preloadHints;var n=(r||[]).reduce((function(e,t){return e+("PART"===t.type?1:0)}),0);n+=i&&i.length?i.length:0;return n};var is=function(e,t){if(t.endList)return 0;if(e&&e.suggestedPresentationDelay)return e.suggestedPresentationDelay;var i=es(t).length>0;if(i&&t.serverControl&&t.serverControl.partHoldBack)return t.serverControl.partHoldBack;else if(i&&t.partTargetDuration)return 3*t.partTargetDuration;else if(t.serverControl&&t.serverControl.holdBack)return t.serverControl.holdBack;else if(t.targetDuration)return 3*t.targetDuration;return 0};var rs=function(e,t){var i=0;var r=t-e.mediaSequence;var n=e.segments[r];if(n){if("undefined"!==typeof n.start)return{result:n.start,precise:true};if("undefined"!==typeof n.end)return{result:n.end-n.duration,precise:true}}while(r--){n=e.segments[r];if("undefined"!==typeof n.end)return{result:i+n.end,precise:true};i+=$a(e,n);if("undefined"!==typeof n.start)return{result:i+n.start,precise:true}}return{result:i,precise:false}};var ns=function(e,t){var i=0;var r;var n=t-e.mediaSequence;for(;n<e.segments.length;n++){r=e.segments[n];if("undefined"!==typeof r.start)return{result:r.start-i,precise:true};i+=$a(e,r);if("undefined"!==typeof r.end)return{result:r.end-i,precise:true}}return{result:-1,precise:false}};var as=function(e,t,i){if("undefined"===typeof t)t=e.mediaSequence+e.segments.length;if(t<e.mediaSequence)return 0;var r=rs(e,t);if(r.precise)return r.result;var n=ns(e,t);if(n.precise)return n.result;return r.result+i};var ss=function(e,t,i){if(!e)return 0;if("number"!==typeof i)i=0;if("undefined"===typeof t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return n()[1/0]}return as(e,t,i)};var os=function(e){var t=e.defaultDuration,i=e.durationList,r=e.startIndex,n=e.endIndex;var a=0;if(r>n){var s=[n,r];r=s[0];n=s[1]}if(r<0){for(var o=r;o<Math.min(0,n);o++)a+=t;r=0}for(var u=r;u<n;u++)a+=i[u].duration;return a};var us=function(e,t,i,r){if(!e||!e.segments)return null;if(e.endList)return ss(e);if(null===t)return null;t=t||0;var n=as(e,e.mediaSequence+e.segments.length,t);if(i){r="number"===typeof r?r:is(null,e);n-=r}return Math.max(0,n)};var ls=function(e,t,i){var r=true;var n=t||0;var a=us(e,t,r,i);if(null===a)return Ya();return Ya(n,a)};var ds=function(e){var t=e.playlist,i=e.currentTime,r=e.startingSegmentIndex,n=e.startingPartIndex,a=e.startTime,s=e.experimentalExactManifestTimings;var o=i-a;var u=Ja(t);var l=0;for(var d=0;d<u.length;d++){var c=u[d];if(r!==c.segmentIndex)continue;if("number"===typeof n&&"number"===typeof c.partIndex&&n!==c.partIndex)continue;l=d;break}if(o<0){if(l>0)for(var h=l-1;h>=0;h--){var f=u[h];o+=f.duration;if(s){if(o<0)continue}else if(o+Na<=0)continue;return{partIndex:f.partIndex,segmentIndex:f.segmentIndex,startTime:a-os({defaultDuration:t.targetDuration,durationList:u,startIndex:l,endIndex:h})}}return{partIndex:u[0]&&u[0].partIndex||null,segmentIndex:u[0]&&u[0].segmentIndex||0,startTime:i}}if(l<0){for(var p=l;p<0;p++){o-=t.targetDuration;if(o<0)return{partIndex:u[0]&&u[0].partIndex||null,segmentIndex:u[0]&&u[0].segmentIndex||0,startTime:i}}l=0}for(var m=l;m<u.length;m++){var v=u[m];o-=v.duration;if(s){if(o>0)continue}else if(o-Na>=0)continue;return{partIndex:v.partIndex,segmentIndex:v.segmentIndex,startTime:a+os({defaultDuration:t.targetDuration,durationList:u,startIndex:l,endIndex:m})}}return{segmentIndex:u[u.length-1].segmentIndex,partIndex:u[u.length-1].partIndex,startTime:i}};var cs=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()};var hs=function(e){return e.excludeUntil&&e.excludeUntil===1/0};var fs=function(e){var t=cs(e);return!e.disabled&&!t};var ps=function(e){return e.disabled};var ms=function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return true;return false};var vs=function(e,t){return t.attributes&&t.attributes[e]};var gs=function(e,t,i,r){if(void 0===r)r=0;if(!vs("BANDWIDTH",i))return NaN;var n=e*i.attributes.BANDWIDTH;return(n-8*r)/t};var _s=function(e,t){if(1===e.playlists.length)return true;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter((function(e){if(!fs(e))return false;return(e.attributes.BANDWIDTH||0)<i})).length};var ys=function(e,t){if(!e&&!t||!e&&t||e&&!t)return false;if(e===t)return true;if(e.id&&t.id&&e.id===t.id)return true;if(e.resolvedUri&&t.resolvedUri&&e.resolvedUri===t.resolvedUri)return true;if(e.uri&&t.uri&&e.uri===t.uri)return true;return false};var Ts=function(e,t){var i=e&&e.mediaGroups&&e.mediaGroups.AUDIO||{};var r=false;for(var n in i){for(var a in i[n]){r=t(i[n][a]);if(r)break}if(r)break}return!!r};var bs=function(e){if(!e||!e.playlists||!e.playlists.length){var t=Ts(e,(function(e){return e.playlists&&e.playlists.length||e.uri}));return t}var i=function(t){var i=e.playlists[t];var r=i.attributes&&i.attributes.CODECS;if(r&&r.split(",").every((function(e){return(0,S.KL)(e)})))return"continue";var n=Ts(e,(function(e){return ys(i,e)}));if(n)return"continue";return{v:false}};for(var r=0;r<e.playlists.length;r++){var n=i(r);if("continue"===n)continue;if("object"===typeof n)return n.v}return true};var Ss={liveEdgeDelay:is,duration:ss,seekable:ls,getMediaInfoForTime:ds,isEnabled:fs,isDisabled:ps,isBlacklisted:cs,isIncompatible:hs,playlistEnd:us,isAes:ms,hasAttribute:vs,estimateSegmentRequestTime:gs,isLowestEnabledRendition:_s,isAudioOnly:bs,playlistMatch:ys,segmentDurationWithParts:$a};var ks=Oa.log;var Cs=function(e,t){return e+"-"+t};var Es=function(e){var t=e.onwarn,i=e.oninfo,r=e.manifestString,n=e.customTagParsers,a=void 0===n?[]:n,s=e.customTagMappers,o=void 0===s?[]:s,u=e.experimentalLLHLS;var l=new b._b;if(t)l.on("warn",t);if(i)l.on("info",i);a.forEach((function(e){return l.addParser(e)}));o.forEach((function(e){return l.addTagMapper(e)}));l.push(r);l.end();var d=l.manifest;if(!u){["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach((function(e){if(d.hasOwnProperty(e))delete d[e]}));if(d.segments)d.segments.forEach((function(e){["parts","preloadHints"].forEach((function(t){if(e.hasOwnProperty(t))delete e[t]}))}))}if(!d.targetDuration){var c=10;if(d.segments&&d.segments.length)c=d.segments.reduce((function(e,t){return Math.max(e,t.duration)}),0);if(t)t("manifest has no targetDuration defaulting to "+c);d.targetDuration=c}var h=es(d);if(h.length&&!d.partTargetDuration){var f=h.reduce((function(e,t){return Math.max(e,t.duration)}),0);if(t){t("manifest has no partTargetDuration defaulting to "+f);ks.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")}d.partTargetDuration=f}return d};var ws=function(e,t){if(!e.mediaGroups)return;["AUDIO","SUBTITLES"].forEach((function(i){if(!e.mediaGroups[i])return;for(var r in e.mediaGroups[i])for(var n in e.mediaGroups[i][r]){var a=e.mediaGroups[i][r][n];t(a,i,r,n)}}))};var Is=function(e){var t=e.playlist,i=e.uri,r=e.id;t.id=r;t.playlistErrors_=0;if(i)t.uri=i;t.attributes=t.attributes||{}};var xs=function(e){var t=e.playlists.length;while(t--){var i=e.playlists[t];Is({playlist:i,id:Cs(t,i.uri)});i.resolvedUri=Ra(e.uri,i.uri);e.playlists[i.id]=i;e.playlists[i.uri]=i;if(!i.attributes.BANDWIDTH)ks.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}};var Ps=function(e){ws(e,(function(t){if(t.uri)t.resolvedUri=Ra(e.uri,t.uri)}))};var As=function(e,t){var i=Cs(0,t);var r={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:n().location.href,resolvedUri:n().location.href,playlists:[{uri:t,id:i,resolvedUri:t,attributes:{}}]};r.playlists[i]=r.playlists[0];r.playlists[t]=r.playlists[0];return r};var Ls=function(e,t){e.uri=t;for(var i=0;i<e.playlists.length;i++)if(!e.playlists[i].uri){var r="placeholder-uri-"+i;e.playlists[i].uri=r}var n=bs(e);ws(e,(function(t,i,r,a){var s="placeholder-uri-"+i+"-"+r+"-"+a;if(!t.playlists||!t.playlists.length){if(n&&"AUDIO"===i&&!t.uri)for(var u=0;u<e.playlists.length;u++){var l=e.playlists[u];if(l.attributes&&l.attributes.AUDIO&&l.attributes.AUDIO===r)return}t.playlists=[(0,o.Z)({},t)]}t.playlists.forEach((function(t,i){var r=Cs(i,s);if(t.uri)t.resolvedUri=t.resolvedUri||Ra(e.uri,t.uri);else{t.uri=0===i?s:r;t.resolvedUri=t.uri}t.id=t.id||r;t.attributes=t.attributes||{};e.playlists[t.id]=t;e.playlists[t.uri]=t}))}));xs(e);Ps(e)};var Os=Oa.mergeOptions,Ds=Oa.EventTarget;var Ms=function(e,t){if(t.endList||!t.serverControl)return e;var i={};if(t.serverControl.canBlockReload){var r=t.preloadSegment;var a=t.mediaSequence+t.segments.length;if(r){var s=r.parts||[];var o=ts(t)-1;if(o>-1&&o!==s.length-1)i._HLS_part=o;if(o>-1||s.length)a--}i._HLS_msn=a}if(t.serverControl&&t.serverControl.canSkipUntil)i._HLS_skip=t.serverControl.canSkipDateranges?"v2":"YES";if(Object.keys(i).length){var u=new(n().URL)(e);["_HLS_skip","_HLS_msn","_HLS_part"].forEach((function(e){if(!i.hasOwnProperty(e))return;u.searchParams.set(e,i[e])}));e=u.toString()}return e};var Rs=function(e,t){if(!e)return t;var i=Os(e,t);if(e.preloadHints&&!t.preloadHints)delete i.preloadHints;if(e.parts&&!t.parts)delete i.parts;else if(e.parts&&t.parts)for(var r=0;r<t.parts.length;r++)if(e.parts&&e.parts[r])i.parts[r]=Os(e.parts[r],t.parts[r]);if(!e.skipped&&t.skipped)i.skipped=false;if(e.preload&&!t.preload)i.preload=false;return i};var Us=function(e,t,i){var r=e.slice();var n=t.slice();i=i||0;var a=[];var s;for(var o=0;o<n.length;o++){var u=r[o+i];var l=n[o];if(u){s=u.map||s;a.push(Rs(u,l))}else{if(s&&!l.map)l.map=s;a.push(l)}}return a};var Bs=function(e,t){if(!e.resolvedUri&&e.uri)e.resolvedUri=Ra(t,e.uri);if(e.key&&!e.key.resolvedUri)e.key.resolvedUri=Ra(t,e.key.uri);if(e.map&&!e.map.resolvedUri)e.map.resolvedUri=Ra(t,e.map.uri);if(e.map&&e.map.key&&!e.map.key.resolvedUri)e.map.key.resolvedUri=Ra(t,e.map.key.uri);if(e.parts&&e.parts.length)e.parts.forEach((function(e){if(e.resolvedUri)return;e.resolvedUri=Ra(t,e.uri)}));if(e.preloadHints&&e.preloadHints.length)e.preloadHints.forEach((function(e){if(e.resolvedUri)return;e.resolvedUri=Ra(t,e.uri)}))};var Ns=function(e){var t=e.segments||[];var i=e.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints)for(var r=0;r<i.preloadHints.length;r++)if("MAP"===i.preloadHints[r].type)return t;i.duration=e.targetDuration;i.preload=true;t.push(i)}return t};var Fs=function(e,t){return e===t||e.segments&&t.segments&&e.segments.length===t.segments.length&&e.endList===t.endList&&e.mediaSequence===t.mediaSequence&&e.preloadSegment===t.preloadSegment};var js=function(e,t,i){if(void 0===i)i=Fs;var r=Os(e,{});var n=r.playlists[t.id];if(!n)return null;if(i(n,t))return null;t.segments=Ns(t);var a=Os(n,t);if(a.preloadSegment&&!t.preloadSegment)delete a.preloadSegment;if(n.segments){if(t.skip){t.segments=t.segments||[];for(var s=0;s<t.skip.skippedSegments;s++)t.segments.unshift({skipped:true})}a.segments=Us(n.segments,t.segments,t.mediaSequence-n.mediaSequence)}a.segments.forEach((function(e){Bs(e,a.resolvedUri)}));for(var o=0;o<r.playlists.length;o++)if(r.playlists[o].id===t.id)r.playlists[o]=a;r.playlists[t.id]=a;r.playlists[t.uri]=a;ws(e,(function(e,i,r,n){if(!e.playlists)return;for(var s=0;s<e.playlists.length;s++)if(t.id===e.playlists[s].id)e.playlists[s]=a}));return r};var Hs=function(e,t){var i=e.segments||[];var r=i[i.length-1];var n=r&&r.parts&&r.parts[r.parts.length-1];var a=n&&n.duration||r&&r.duration;if(t&&a)return 1e3*a;return 500*(e.partTargetDuration||e.targetDuration||10)};var qs=function(e){(0,c.Z)(t,e);function t(t,i,r){var n;if(void 0===r)r={};n=e.call(this)||this;if(!t)throw new Error("A non-empty playlist URL or object is required");n.logger_=Ba("PlaylistLoader");var a=r,s=a.withCredentials,o=void 0===s?false:s,u=a.handleManifestRedirects,l=void 0===u?false:u;n.src=t;n.vhs_=i;n.withCredentials=o;n.handleManifestRedirects=l;var c=i.options_;n.customTagParsers=c&&c.customTagParsers||[];n.customTagMappers=c&&c.customTagMappers||[];n.experimentalLLHLS=c&&c.experimentalLLHLS||false;if(Oa.browser.IE_VERSION)n.experimentalLLHLS=false;n.state="HAVE_NOTHING";n.handleMediaupdatetimeout_=n.handleMediaupdatetimeout_.bind((0,d.Z)(n));n.on("mediaupdatetimeout",n.handleMediaupdatetimeout_);return n}var i=t.prototype;i.handleMediaupdatetimeout_=function(){var e=this;if("HAVE_METADATA"!==this.state)return;var t=this.media();var i=Ra(this.master.uri,t.uri);if(this.experimentalLLHLS)i=Ms(i,t);this.state="HAVE_CURRENT_METADATA";this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials},(function(t,i){if(!e.request)return;if(t)return e.playlistRequestError(e.request,e.media(),"HAVE_METADATA");e.haveMetadata({playlistString:e.request.responseText,url:e.media().uri,id:e.media().id})}))};i.playlistRequestError=function(e,t,i){var r=t.uri,n=t.id;this.request=null;if(i)this.state=i;this.error={playlist:this.master.playlists[n],status:e.status,message:"HLS playlist request error at URL: "+r+".",responseText:e.responseText,code:e.status>=500?4:2};this.trigger("error")};i.parseManifest_=function(e){var t=this;var i=e.url,r=e.manifestString;return Es({onwarn:function(e){var r=e.message;return t.logger_("m3u8-parser warn for "+i+": "+r)},oninfo:function(e){var r=e.message;return t.logger_("m3u8-parser info for "+i+": "+r)},manifestString:r,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})};i.haveMetadata=function(e){var t=e.playlistString,i=e.playlistObject,r=e.url,n=e.id;this.request=null;this.state="HAVE_METADATA";var a=i||this.parseManifest_({url:r,manifestString:t});a.lastRequest=Date.now();Is({playlist:a,uri:r,id:n});var s=js(this.master,a);this.targetDuration=a.partTargetDuration||a.targetDuration;this.pendingMedia_=null;if(s){this.master=s;this.media_=this.master.playlists[n]}else this.trigger("playlistunchanged");this.updateMediaUpdateTimeout_(Hs(this.media(),!!s));this.trigger("loadedplaylist")};i.dispose=function(){this.trigger("dispose");this.stopRequest();n().clearTimeout(this.mediaUpdateTimeout);n().clearTimeout(this.finalRenditionTimeout);this.off()};i.stopRequest=function(){if(this.request){var e=this.request;this.request=null;e.onreadystatechange=null;e.abort()}};i.media=function(e,t){var i=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"===typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}n().clearTimeout(this.finalRenditionTimeout);if(t){var r=(e.partTargetDuration||e.targetDuration)/2*1e3||5*1e3;this.finalRenditionTimeout=n().setTimeout(this.media.bind(this,e,false),r);return}var a=this.state;var s=!this.media_||e.id!==this.media_.id;var o=this.master.playlists[e.id];if(o&&o.endList||e.endList&&e.segments.length){if(this.request){this.request.onreadystatechange=null;this.request.abort();this.request=null}this.state="HAVE_METADATA";this.media_=e;if(s){this.trigger("mediachanging");if("HAVE_MASTER"===a)this.trigger("loadedmetadata");else this.trigger("mediachange")}return}this.updateMediaUpdateTimeout_(Hs(e,true));if(!s)return;this.state="SWITCHING_MEDIA";if(this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null;this.request.abort();this.request=null}if(this.media_)this.trigger("mediachanging");this.pendingMedia_=e;this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(function(t,r){if(!i.request)return;e.lastRequest=Date.now();e.resolvedUri=Ua(i.handleManifestRedirects,e.resolvedUri,r);if(t)return i.playlistRequestError(i.request,e,a);i.haveMetadata({playlistString:r.responseText,url:e.uri,id:e.id});if("HAVE_MASTER"===a)i.trigger("loadedmetadata");else i.trigger("mediachange")}))};i.pause=function(){if(this.mediaUpdateTimeout){n().clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null}this.stopRequest();if("HAVE_NOTHING"===this.state)this.started=false;if("SWITCHING_MEDIA"===this.state)if(this.media_)this.state="HAVE_METADATA";else this.state="HAVE_MASTER";else if("HAVE_CURRENT_METADATA"===this.state)this.state="HAVE_METADATA"};i.load=function(e){var t=this;if(this.mediaUpdateTimeout){n().clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null}var i=this.media();if(e){var r=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5*1e3;this.mediaUpdateTimeout=n().setTimeout((function(){t.mediaUpdateTimeout=null;t.load()}),r);return}if(!this.started){this.start();return}if(i&&!i.endList)this.trigger("mediaupdatetimeout");else this.trigger("loadedplaylist")};i.updateMediaUpdateTimeout_=function(e){var t=this;if(this.mediaUpdateTimeout){n().clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null}if(!this.media()||this.media().endList)return;this.mediaUpdateTimeout=n().setTimeout((function(){t.mediaUpdateTimeout=null;t.trigger("mediaupdatetimeout");t.updateMediaUpdateTimeout_(e)}),e)};i.start=function(){var e=this;this.started=true;if("object"===typeof this.src){if(!this.src.uri)this.src.uri=n().location.href;this.src.resolvedUri=this.src.uri;setTimeout((function(){e.setupInitialPlaylist(e.src)}),0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(function(t,i){if(!e.request)return;e.request=null;if(t){e.error={status:i.status,message:"HLS playlist request error at URL: "+e.src+".",responseText:i.responseText,code:2};if("HAVE_NOTHING"===e.state)e.started=false;return e.trigger("error")}e.src=Ua(e.handleManifestRedirects,e.src,i);var r=e.parseManifest_({manifestString:i.responseText,url:e.src});e.setupInitialPlaylist(r)}))};i.srcUri=function(){return"string"===typeof this.src?this.src:this.src.uri};i.setupInitialPlaylist=function(e){this.state="HAVE_MASTER";if(e.playlists){this.master=e;Ls(this.master,this.srcUri());e.playlists.forEach((function(e){e.segments=Ns(e);e.segments.forEach((function(t){Bs(t,e.resolvedUri)}))}));this.trigger("loadedplaylist");if(!this.request)this.media(this.master.playlists[0]);return}var t=this.srcUri()||n().location.href;this.master=As(e,t);this.haveMetadata({playlistObject:e,url:t,id:this.master.playlists[0].id});this.trigger("loadedmetadata")};return t}(Ds);var Vs=Oa.xhr,Ws=Oa.mergeOptions;var zs=function(e,t,i,r){var n="arraybuffer"===e.responseType?e.response:e.responseText;if(!t&&n){e.responseTime=Date.now();e.roundTripTime=e.responseTime-e.requestTime;e.bytesReceived=n.byteLength||n.length;if(!e.bandwidth)e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3)}if(i.headers)e.responseHeaders=i.headers;if(t&&"ETIMEDOUT"===t.code)e.timedout=true;if(!t&&!e.aborted&&200!==i.statusCode&&206!==i.statusCode&&0!==i.statusCode)t=new Error("XHR Failed with a response of: "+(e&&(n||e.responseText)));r(t,e)};var Gs=function(){var e=function e(t,i){t=Ws({timeout:45e3},t);var r=e.beforeRequest||Oa.Vhs.xhr.beforeRequest;if(r&&"function"===typeof r){var n=r(t);if(n)t=n}var a=true===Oa.Vhs.xhr.original?Vs:Oa.Vhs.xhr;var s=a(t,(function(e,t){return zs(s,e,t,i)}));var o=s.abort;s.abort=function(){s.aborted=true;return o.apply(s,arguments)};s.uri=t.uri;s.requestTime=Date.now();return s};e.original=true;return e};var Ks=function(e){var t;var i=e.offset;if("bigint"===typeof e.offset||"bigint"===typeof e.length)t=n().BigInt(e.offset)+n().BigInt(e.length)-n().BigInt(1);else t=e.offset+e.length-1;return"bytes="+i+"-"+t};var Zs=function(e){var t={};if(e.byterange)t.Range=Ks(e.byterange);return t};var Qs=function(e,t){return e.start(t)+"-"+e.end(t)};var Xs=function(e,t){var i=e.toString(16);return"00".substring(0,2-i.length)+i+(t%2?" ":"")};var Ys=function(e){if(e>=32&&e<126)return String.fromCharCode(e);return"."};var $s=function(e){var t={};Object.keys(e).forEach((function(i){var r=e[i];if((0,C.Au)(r))t[i]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength};else t[i]=r}));return t};var Js=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")};var eo=function(e){return e.resolvedUri};var to=function(e){var t=Array.prototype.slice.call(e);var i=16;var r="";var n;var a;for(var s=0;s<t.length/i;s++){n=t.slice(s*i,s*i+i).map(Xs).join("");a=t.slice(s*i,s*i+i).map(Ys).join("");r+=n+" "+a+"\n"}return r};var io=function(e){var t=e.bytes;return to(t)};var ro=function(e){var t="";var i;for(i=0;i<e.length;i++)t+=Qs(e,i)+" ";return t};var no=Object.freeze({__proto__:null,createTransferableMessage:$s,initSegmentId:Js,segmentKeyId:eo,hexDump:to,tagDump:io,textRanges:ro});var ao=.25;var so=function(e,t){if(!t.dateTimeObject)return null;var i=t.videoTimingInfo.transmuxerPrependedSeconds;var r=t.videoTimingInfo.transmuxedPresentationStart;var n=r+i;var a=e-n;return new Date(t.dateTimeObject.getTime()+1e3*a)};var oo=function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds};var uo=function(e,t){var i;try{i=new Date(e)}catch(d){return null}if(!t||!t.segments||0===t.segments.length)return null;var r=t.segments[0];if(i<r.dateTimeObject)return null;for(var n=0;n<t.segments.length-1;n++){r=t.segments[n];var a=t.segments[n+1].dateTimeObject;if(i<a)break}var s=t.segments[t.segments.length-1];var o=s.dateTimeObject;var u=s.videoTimingInfo?oo(s.videoTimingInfo):s.duration+s.duration*ao;var l=new Date(o.getTime()+1e3*u);if(i>l)return null;if(i>o)r=s;return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:Ss.duration(t,t.mediaSequence+t.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"}};var lo=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;var i=0;var r;for(var n=0;n<t.segments.length;n++){r=t.segments[n];i=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:i+r.duration;if(e<=i)break}var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>i){if(e>i+a.duration*ao)return null;r=a}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:i-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}};var co=function(e,t){var i;var r;try{i=new Date(e);r=new Date(t)}catch(s){}var n=i.getTime();var a=r.getTime();return(a-n)/1e3};var ho=function(e){if(!e.segments||0===e.segments.length)return false;for(var t=0;t<e.segments.length;t++){var i=e.segments[t];if(!i.dateTimeObject)return false}return true};var fo=function(e){var t=e.playlist,i=e.time,r=void 0===i?void 0:i,n=e.callback;if(!n)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===r)return n({message:"getProgramTime: playlist and time must be provided"});var a=lo(r,t);if(!a)return n({message:"valid programTime was not found"});if("estimate"===a.type)return n({message:"Accurate programTime could not be determined."+" Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var s={mediaSeconds:r};var o=so(r,a.segment);if(o)s.programDateTime=o.toISOString();return n(null,s)};var po=function e(t){var i=t.programTime,r=t.playlist,n=t.retryCount,a=void 0===n?2:n,s=t.seekTo,o=t.pauseAfterSeek,u=void 0===o?true:o,l=t.tech,d=t.callback;if(!d)throw new Error("seekToProgramTime: callback must be provided");if("undefined"===typeof i||!r||!s)return d({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!r.endList&&!l.hasStarted_)return d({message:"player must be playing a live stream to start buffering"});if(!ho(r))return d({message:"programDateTime tags must be provided in the manifest "+r.resolvedUri});var c=uo(i,r);if(!c)return d({message:i+" was not found in the stream"});var h=c.segment;var f=co(h.dateTimeObject,i);if("estimate"===c.type){if(0===a)return d({message:i+" is not buffered yet. Try again"});s(c.estimatedStart+f);l.one("seeked",(function(){e({programTime:i,playlist:r,retryCount:a-1,seekTo:s,pauseAfterSeek:u,tech:l,callback:d})}));return}var p=h.start+f;var m=function(){return d(null,l.currentTime())};l.one("seeked",m);if(u)l.pause();s(p)};var mo=function(e,t){if(4===e.readyState)return t();return};var vo=function(e,t,i){var r=[];var n;var a=false;var s=function(e,t,r,n){t.abort();a=true;return i(e,t,r,n)};var o=function(e,t){if(a)return;if(e)return s(e,t,"",r);var i=t.responseText.substring(r&&r.byteLength||0,t.responseText.length);r=(0,C.lx)(r,(0,C.qX)(i,true));n=n||(0,x.c)(r);if(r.length<10||n&&r.length<n+2)return mo(t,(function(){return s(e,t,"",r)}));var o=(0,P.Xm)(r);if("ts"===o&&r.length<188)return mo(t,(function(){return s(e,t,"",r)}));if(!o&&r.length<376)return mo(t,(function(){return s(e,t,"",r)}));return s(null,t,o,r)};var u={uri:e,beforeSend:function(e){e.overrideMimeType("text/plain; charset=x-user-defined");e.addEventListener("progress",(function(t){t.total;t.loaded;return zs(e,null,{statusCode:e.status},o)}))}};var l=t(u,(function(e,t){return zs(l,e,t,o)}));return l};var go=Oa.EventTarget,_o=Oa.mergeOptions;var yo=function(e,t){if(!Fs(e,t))return false;if(e.sidx&&t.sidx&&(e.sidx.offset!==t.sidx.offset||e.sidx.length!==t.sidx.length))return false;else if(!e.sidx&&t.sidx||e.sidx&&!t.sidx)return false;if(e.segments&&!t.segments||!e.segments&&t.segments)return false;if(!e.segments&&!t.segments)return true;for(var i=0;i<e.segments.length;i++){var r=e.segments[i];var n=t.segments[i];if(r.uri!==n.uri)return false;if(!r.byterange&&!n.byterange)continue;var a=r.byterange;var s=n.byterange;if(a&&!s||!a&&s)return false;if(a.offset!==s.offset||a.length!==s.length)return false}return true};var To=function(e){var t=e.masterXml,i=e.srcUrl,r=e.clientOffset,n=e.sidxMapping,a=e.previousManifest;var s=(0,E.Qc)(t,{manifestUri:i,clientOffset:r,sidxMapping:n,previousManifest:a});Ls(s,i);return s};var bo=function(e,t,i){var r=true;var n=_o(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod,timelineStarts:t.timelineStarts});for(var a=0;a<t.playlists.length;a++){var s=t.playlists[a];if(s.sidx){var o=(0,E.mm)(s.sidx);if(i&&i[o]&&i[o].sidx)(0,E.jp)(s,i[o].sidx,s.sidx.resolvedUri)}var u=js(n,s,yo);if(u){n=u;r=false}}ws(t,(function(e,t,i,a){if(e.playlists&&e.playlists.length){var s=e.playlists[0].id;var o=js(n,e.playlists[0],yo);if(o){n=o;n.mediaGroups[t][i][a].playlists[0]=n.playlists[s];r=false}}}));if(t.minimumUpdatePeriod!==e.minimumUpdatePeriod)r=false;if(r)return null;return n};var So=function(e,t){var i=Boolean(!e.map&&!t.map);var r=i||Boolean(e.map&&t.map&&e.map.byterange.offset===t.map.byterange.offset&&e.map.byterange.length===t.map.byterange.length);return r&&e.uri===t.uri&&e.byterange.offset===t.byterange.offset&&e.byterange.length===t.byterange.length};var ko=function(e,t){var i={};for(var r in e){var n=e[r];var a=n.sidx;if(a){var s=(0,E.mm)(a);if(!t[s])break;var o=t[s].sidxInfo;if(So(o,a))i[s]=t[s]}}return i};var Co=function(e,t){var i=ko(e.playlists,t);var r=i;ws(e,(function(e,i,n,a){if(e.playlists&&e.playlists.length){var s=e.playlists;r=_o(r,ko(s,t))}}));return r};var Eo=function(e){(0,c.Z)(t,e);function t(t,i,r,n){var a;if(void 0===r)r={};a=e.call(this)||this;a.masterPlaylistLoader_=n||(0,d.Z)(a);if(!n)a.isMaster_=true;var s=r,o=s.withCredentials,u=void 0===o?false:o,l=s.handleManifestRedirects,c=void 0===l?false:l;a.vhs_=i;a.withCredentials=u;a.handleManifestRedirects=c;if(!t)throw new Error("A non-empty playlist URL or object is required");a.on("minimumUpdatePeriod",(function(){a.refreshXml_()}));a.on("mediaupdatetimeout",(function(){a.refreshMedia_(a.media().id)}));a.state="HAVE_NOTHING";a.loadedPlaylists_={};a.logger_=Ba("DashPlaylistLoader");if(a.isMaster_){a.masterPlaylistLoader_.srcUrl=t;a.masterPlaylistLoader_.sidxMapping_={}}else a.childPlaylist_=t;return a}var i=t.prototype;i.requestErrored_=function(e,t,i){if(!this.request)return true;this.request=null;if(e){this.error="object"===typeof e&&!(e instanceof Error)?e:{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2};if(i)this.state=i;this.trigger("error");return true}};i.addSidxSegments_=function(e,t,i){var r=this;var a=e.sidx&&(0,E.mm)(e.sidx);if(!e.sidx||!a||this.masterPlaylistLoader_.sidxMapping_[a]){this.mediaRequest_=n().setTimeout((function(){return i(false)}),0);return}var s=Ua(this.handleManifestRedirects,e.sidx.resolvedUri);var o=function(n,s){if(r.requestErrored_(n,s,t))return;var o=r.masterPlaylistLoader_.sidxMapping_;var u;try{u=I()((0,C.Ki)(s.response).subarray(8))}catch(l){r.requestErrored_(l,s,t);return}o[a]={sidxInfo:e.sidx,sidx:u};(0,E.jp)(e,u,e.sidx.resolvedUri);return i(true)};this.request=vo(s,this.vhs_.xhr,(function(t,i,n,a){if(t)return o(t,i);if(!n||"mp4"!==n)return o({status:i.status,message:"Unsupported "+(n||"unknown")+" container type for sidx segment at URL: "+s,response:"",playlist:e,internal:true,blacklistDuration:1/0,code:2},i);var u=e.sidx.byterange,l=u.offset,d=u.length;if(a.length>=d+l)return o(t,{response:a.subarray(l,l+d),status:i.status,uri:i.uri});r.request=r.vhs_.xhr({uri:s,responseType:"arraybuffer",headers:Zs({byterange:e.sidx.byterange})},o)}))};i.dispose=function(){this.trigger("dispose");this.stopRequest();this.loadedPlaylists_={};n().clearTimeout(this.minimumUpdatePeriodTimeout_);n().clearTimeout(this.mediaRequest_);n().clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;this.mediaRequest_=null;this.minimumUpdatePeriodTimeout_=null;if(this.masterPlaylistLoader_.createMupOnMedia_){this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_);this.masterPlaylistLoader_.createMupOnMedia_=null}this.off()};i.hasPendingRequest=function(){return this.request||this.mediaRequest_};i.stopRequest=function(){if(this.request){var e=this.request;this.request=null;e.onreadystatechange=null;e.abort()}};i.media=function(e){var t=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var i=this.state;if("string"===typeof e){if(!this.masterPlaylistLoader_.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.masterPlaylistLoader_.master.playlists[e]}var r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA";this.media_=e;if(r){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!r)return;if(this.media_)this.trigger("mediachanging");this.addSidxSegments_(e,i,(function(r){t.haveMetadata({startingState:i,playlist:e})}))};i.haveMetadata=function(e){var t=e.startingState,i=e.playlist;this.state="HAVE_METADATA";this.loadedPlaylists_[i.id]=i;this.mediaRequest_=null;this.refreshMedia_(i.id);if("HAVE_MASTER"===t)this.trigger("loadedmetadata");else this.trigger("mediachange")};i.pause=function(){if(this.masterPlaylistLoader_.createMupOnMedia_){this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_);this.masterPlaylistLoader_.createMupOnMedia_=null}this.stopRequest();n().clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;if(this.isMaster_){n().clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_);this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null}if("HAVE_NOTHING"===this.state)this.started=false};i.load=function(e){var t=this;n().clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;var i=this.media();if(e){var r=i?i.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=n().setTimeout((function(){return t.load()}),r);return}if(!this.started){this.start();return}if(i&&!i.endList){if(this.isMaster_&&!this.minimumUpdatePeriodTimeout_){this.trigger("minimumUpdatePeriod");this.updateMinimumUpdatePeriodTimeout_()}this.trigger("mediaupdatetimeout")}else this.trigger("loadedplaylist")};i.start=function(){var e=this;this.started=true;if(!this.isMaster_){this.mediaRequest_=n().setTimeout((function(){return e.haveMaster_()}),0);return}this.requestMaster_((function(t,i){e.haveMaster_();if(!e.hasPendingRequest()&&!e.media_)e.media(e.masterPlaylistLoader_.master.playlists[0])}))};i.requestMaster_=function(e){var t=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(function(i,r){if(t.requestErrored_(i,r)){if("HAVE_NOTHING"===t.state)t.started=false;return}var n=r.responseText!==t.masterPlaylistLoader_.masterXml_;t.masterPlaylistLoader_.masterXml_=r.responseText;if(r.responseHeaders&&r.responseHeaders.date)t.masterLoaded_=Date.parse(r.responseHeaders.date);else t.masterLoaded_=Date.now();t.masterPlaylistLoader_.srcUrl=Ua(t.handleManifestRedirects,t.masterPlaylistLoader_.srcUrl,r);if(n){t.handleMaster_();t.syncClientServerClock_((function(){return e(r,n)}));return}return e(r,n)}))};i.syncClientServerClock_=function(e){var t=this;var i=(0,E.LG)(this.masterPlaylistLoader_.masterXml_);if(null===i){this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now();return e()}if("DIRECT"===i.method){this.masterPlaylistLoader_.clientOffset_=i.value-Date.now();return e()}this.request=this.vhs_.xhr({uri:Ra(this.masterPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},(function(r,n){if(!t.request)return;if(r){t.masterPlaylistLoader_.clientOffset_=t.masterLoaded_-Date.now();return e()}var a;if("HEAD"===i.method)if(!n.responseHeaders||!n.responseHeaders.date)a=t.masterLoaded_;else a=Date.parse(n.responseHeaders.date);else a=Date.parse(n.responseText);t.masterPlaylistLoader_.clientOffset_=a-Date.now();e()}))};i.haveMaster_=function(){this.state="HAVE_MASTER";if(this.isMaster_)this.trigger("loadedplaylist");else if(!this.media_)this.media(this.childPlaylist_)};i.handleMaster_=function(){this.mediaRequest_=null;var e=this.masterPlaylistLoader_.master;var t=To({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_,previousManifest:e});if(e)t=bo(e,t,this.masterPlaylistLoader_.sidxMapping_);this.masterPlaylistLoader_.master=t?t:e;var i=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];if(i&&i!==this.masterPlaylistLoader_.srcUrl)this.masterPlaylistLoader_.srcUrl=i;if(!e||t&&t.minimumUpdatePeriod!==e.minimumUpdatePeriod)this.updateMinimumUpdatePeriodTimeout_();return Boolean(t)};i.updateMinimumUpdatePeriodTimeout_=function(){var e=this.masterPlaylistLoader_;if(e.createMupOnMedia_){e.off("loadedmetadata",e.createMupOnMedia_);e.createMupOnMedia_=null}if(e.minimumUpdatePeriodTimeout_){n().clearTimeout(e.minimumUpdatePeriodTimeout_);e.minimumUpdatePeriodTimeout_=null}var t=e.master&&e.master.minimumUpdatePeriod;if(0===t)if(e.media())t=1e3*e.media().targetDuration;else{e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_;e.one("loadedmetadata",e.createMupOnMedia_)}if("number"!==typeof t||t<=0){if(t<0)this.logger_("found invalid minimumUpdatePeriod of "+t+", not setting a timeout");return}this.createMUPTimeout_(t)};i.createMUPTimeout_=function(e){var t=this.masterPlaylistLoader_;t.minimumUpdatePeriodTimeout_=n().setTimeout((function(){t.minimumUpdatePeriodTimeout_=null;t.trigger("minimumUpdatePeriod");t.createMUPTimeout_(e)}),e)};i.refreshXml_=function(){var e=this;this.requestMaster_((function(t,i){if(!i)return;if(e.media_)e.media_=e.masterPlaylistLoader_.master.playlists[e.media_.id];e.masterPlaylistLoader_.sidxMapping_=Co(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.sidxMapping_);e.addSidxSegments_(e.media(),e.state,(function(t){e.refreshMedia_(e.media().id)}))}))};i.refreshMedia_=function(e){var t=this;if(!e)throw new Error("refreshMedia_ must take a media id");if(this.media_&&this.isMaster_)this.handleMaster_();var i=this.masterPlaylistLoader_.master.playlists;var r=!this.media_||this.media_!==i[e];if(r)this.media_=i[e];else this.trigger("playlistunchanged");if(!this.mediaUpdateTimeout){var a=function e(){if(t.media().endList)return;t.mediaUpdateTimeout=n().setTimeout((function(){t.trigger("mediaupdatetimeout");e()}),Hs(t.media(),Boolean(r)))};a()}this.trigger("loadedplaylist")};return t}(go);var wo={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};var Io=function(e){var t=new Uint8Array(new ArrayBuffer(e.length));for(var i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t.buffer};var xo=function(e){e.on=e.addEventListener;e.off=e.removeEventListener;return e};var Po=function(e){try{return URL.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch(i){var t=new BlobBuilder;t.append(e);return URL.createObjectURL(t.getBlob())}};var Ao=function(e){return function(){var t=Po(e);var i=xo(new Worker(t));i.objURL=t;var r=i.terminate;i.on=i.addEventListener;i.off=i.removeEventListener;i.terminate=function(){URL.revokeObjectURL(t);return r.call(this)};return i}};var Lo=function(e){return"var browserWorkerPolyFill = "+xo.toString()+";\n"+"browserWorkerPolyFill(self);\n"+e};var Oo=function(e){return e.toString().replace(/^function.+?{/,"").slice(0,-1)};var Do=Lo(Oo((function(){var e=function(){this.init=function(){var e={};this.on=function(t,i){if(!e[t])e[t]=[];e[t]=e[t].concat(i)};this.off=function(t,i){var r;if(!e[t])return false;r=e[t].indexOf(i);e[t]=e[t].slice();e[t].splice(r,1);return r>-1};this.trigger=function(t){var i,r,n,a;i=e[t];if(!i)return;if(2===arguments.length){n=i.length;for(r=0;r<n;++r)i[r].call(this,arguments[1])}else{a=[];r=arguments.length;for(r=1;r<arguments.length;++r)a.push(arguments[r]);n=i.length;for(r=0;r<n;++r)i[r].apply(this,a)}};this.dispose=function(){e={}}}};e.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}));this.on("done",(function(t){e.flush(t)}));this.on("partialdone",(function(t){e.partialFlush(t)}));this.on("endedtimeline",(function(t){e.endTimeline(t)}));this.on("reset",(function(t){e.reset(t)}));return e};e.prototype.push=function(e){this.trigger("data",e)};e.prototype.flush=function(e){this.trigger("done",e)};e.prototype.partialFlush=function(e){this.trigger("partialdone",e)};e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)};e.prototype.reset=function(e){this.trigger("reset",e)};var t=e;var r=Math.pow(2,32);var n=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);var i;if(t.getBigUint64){i=t.getBigUint64(0);if(i<Number.MAX_SAFE_INTEGER)return Number(i);return i}return t.getUint32(0)*r+t.getUint32(4)};var a={getUint64:n,MAX_UINT32:r};var s=a.MAX_UINT32;var o,u,l,d,c,h,f,p,m,v,g,_,y,T,b,S,k,C,E,w,I,x,P,A,L,O,D,M,R,U,B,N,F,j,H,q;(function(){var e;P={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if("undefined"===typeof Uint8Array)return;for(e in P)if(P.hasOwnProperty(e))P[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)];A=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);O=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);L=new Uint8Array([0,0,0,1]);D=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);M=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);R={video:D,audio:M};N=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);B=new Uint8Array([0,0,0,0,0,0,0,0]);F=new Uint8Array([0,0,0,0,0,0,0,0]);j=F;H=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);q=F;U=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();o=function(e){var t,i,r,n=[],a=0;for(t=1;t<arguments.length;t++)n.push(arguments[t]);t=n.length;while(t--)a+=n[t].byteLength;i=new Uint8Array(a+8);r=new DataView(i.buffer,i.byteOffset,i.byteLength);r.setUint32(0,i.byteLength);i.set(e,4);for(t=0,a=8;t<n.length;t++){i.set(n[t],a);a+=n[t].byteLength}return i};u=function(){return o(P.dinf,o(P.dref,N))};l=function(e){return o(P.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))};d=function(){return o(P.ftyp,A,L,A,O)};S=function(e){return o(P.hdlr,R[e])};c=function(e){return o(P.mdat,e)};b=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);if(e.samplerate){t[12]=e.samplerate>>>24&255;t[13]=e.samplerate>>>16&255;t[14]=e.samplerate>>>8&255;t[15]=255&e.samplerate}return o(P.mdhd,t)};T=function(e){return o(P.mdia,b(e),S(e.type),f(e))};h=function(e){return o(P.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))};f=function(e){return o(P.minf,"video"===e.type?o(P.vmhd,U):o(P.smhd,B),u(),C(e))};p=function(e,t){var i=[],r=t.length;while(r--)i[r]=w(t[r]);return o.apply(null,[P.moof,h(e)].concat(i))};m=function(e){var t=e.length,i=[];while(t--)i[t]=_(e[t]);return o.apply(null,[P.moov,g(4294967295)].concat(i).concat(v(e)))};v=function(e){var t=e.length,i=[];while(t--)i[t]=I(e[t]);return o.apply(null,[P.mvex].concat(i))};g=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o(P.mvhd,t)};k=function(e){var t,i,r=e.samples||[],n=new Uint8Array(4+r.length);for(i=0;i<r.length;i++){t=r[i].flags;n[i+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy}return o(P.sdtp,n)};C=function(e){return o(P.stbl,E(e),o(P.stts,q),o(P.stsc,j),o(P.stsz,H),o(P.stco,F))};(function(){var e,t;E=function(i){return o(P.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===i.type?e(i):t(i))};e=function(e){var t,i,r=e.sps||[],n=e.pps||[],a=[],s=[];for(t=0;t<r.length;t++){a.push((65280&r[t].byteLength)>>>8);a.push(255&r[t].byteLength);a=a.concat(Array.prototype.slice.call(r[t]))}for(t=0;t<n.length;t++){s.push((65280&n[t].byteLength)>>>8);s.push(255&n[t].byteLength);s=s.concat(Array.prototype.slice.call(n[t]))}i=[P.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o(P.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([r.length],a,[n.length],s))),o(P.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))];if(e.sarRatio){var u=e.sarRatio[0],l=e.sarRatio[1];i.push(o(P.pasp,new Uint8Array([(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u,(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l])))}return o.apply(null,i)};t=function(e){return o(P.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),l(e))}})();y=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return o(P.tkhd,t)};w=function(e){var t,i,r,n,a,u,l;t=o(P.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));u=Math.floor(e.baseMediaDecodeTime/s);l=Math.floor(e.baseMediaDecodeTime%s);i=o(P.tfdt,new Uint8Array([1,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,255&u,l>>>24&255,l>>>16&255,l>>>8&255,255&l]));a=32+20+8+16+8+8;if("audio"===e.type){r=x(e,a);return o(P.traf,t,i,r)}n=k(e);r=x(e,n.length+a);return o(P.traf,t,i,r,n)};_=function(e){e.duration=e.duration||4294967295;return o(P.trak,y(e),T(e))};I=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if("video"!==e.type)t[t.length-1]=0;return o(P.trex,t)};(function(){var e,t,i;i=function(e,t){var i=0,r=0,n=0,a=0;if(e.length){if(void 0!==e[0].duration)i=1;if(void 0!==e[0].size)r=2;if(void 0!==e[0].flags)n=4;if(void 0!==e[0].compositionTimeOffset)a=8}return[0,0,i|r|n|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]};t=function(e,t){var r,n,a,s,u,l;s=e.samples||[];t+=8+12+16*s.length;a=i(s,t);n=new Uint8Array(a.length+16*s.length);n.set(a);r=a.length;for(l=0;l<s.length;l++){u=s[l];n[r++]=(4278190080&u.duration)>>>24;n[r++]=(16711680&u.duration)>>>16;n[r++]=(65280&u.duration)>>>8;n[r++]=255&u.duration;n[r++]=(4278190080&u.size)>>>24;n[r++]=(16711680&u.size)>>>16;n[r++]=(65280&u.size)>>>8;n[r++]=255&u.size;n[r++]=u.flags.isLeading<<2|u.flags.dependsOn;n[r++]=u.flags.isDependedOn<<6|u.flags.hasRedundancy<<4|u.flags.paddingValue<<1|u.flags.isNonSyncSample;n[r++]=u.flags.degradationPriority&240<<8;n[r++]=15&u.flags.degradationPriority;n[r++]=(4278190080&u.compositionTimeOffset)>>>24;n[r++]=(16711680&u.compositionTimeOffset)>>>16;n[r++]=(65280&u.compositionTimeOffset)>>>8;n[r++]=255&u.compositionTimeOffset}return o(P.trun,n)};e=function(e,t){var r,n,a,s,u,l;s=e.samples||[];t+=8+12+8*s.length;a=i(s,t);r=new Uint8Array(a.length+8*s.length);r.set(a);n=a.length;for(l=0;l<s.length;l++){u=s[l];r[n++]=(4278190080&u.duration)>>>24;r[n++]=(16711680&u.duration)>>>16;r[n++]=(65280&u.duration)>>>8;r[n++]=255&u.duration;r[n++]=(4278190080&u.size)>>>24;r[n++]=(16711680&u.size)>>>16;r[n++]=(65280&u.size)>>>8;r[n++]=255&u.size}return o(P.trun,r)};x=function(i,r){if("audio"===i.type)return e(i,r);return t(i,r)}})();var V={ftyp:d,mdat:c,moof:p,moov:m,initSegment:function(e){var t,i=d(),r=m(e);t=new Uint8Array(i.byteLength+r.byteLength);t.set(i);t.set(r,i.byteLength);return t}};var W=function(e){var t,i,r=[],n=[];n.byteLength=0;n.nalCount=0;n.duration=0;r.byteLength=0;for(t=0;t<e.length;t++){i=e[t];if("access_unit_delimiter_rbsp"===i.nalUnitType){if(r.length){r.duration=i.dts-r.dts;n.byteLength+=r.byteLength;n.nalCount+=r.length;n.duration+=r.duration;n.push(r)}r=[i];r.byteLength=i.data.byteLength;r.pts=i.pts;r.dts=i.dts}else{if("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType)r.keyFrame=true;r.duration=i.dts-r.dts;r.byteLength+=i.data.byteLength;r.push(i)}}if(n.length&&(!r.duration||r.duration<=0))r.duration=n[n.length-1].duration;n.byteLength+=r.byteLength;n.nalCount+=r.length;n.duration+=r.duration;n.push(r);return n};var z=function(e){var t,i,r=[],n=[];r.byteLength=0;r.nalCount=0;r.duration=0;r.pts=e[0].pts;r.dts=e[0].dts;n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=e[0].pts;n.dts=e[0].dts;for(t=0;t<e.length;t++){i=e[t];if(i.keyFrame){if(r.length){n.push(r);n.byteLength+=r.byteLength;n.nalCount+=r.nalCount;n.duration+=r.duration}r=[i];r.nalCount=i.length;r.byteLength=i.byteLength;r.pts=i.pts;r.dts=i.dts;r.duration=i.duration}else{r.duration+=i.duration;r.nalCount+=i.length;r.byteLength+=i.byteLength;r.push(i)}}if(n.length&&r.duration<=0)r.duration=n[n.length-1].duration;n.byteLength+=r.byteLength;n.nalCount+=r.nalCount;n.duration+=r.duration;n.push(r);return n};var G=function(e){var t;if(!e[0][0].keyFrame&&e.length>1){t=e.shift();e.byteLength-=t.byteLength;e.nalCount-=t.nalCount;e[0][0].dts=t.dts;e[0][0].pts=t.pts;e[0][0].duration+=t.duration}return e};var K=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}};var Z=function(e,t){var i=K();i.dataOffset=t;i.compositionTimeOffset=e.pts-e.dts;i.duration=e.duration;i.size=4*e.length;i.size+=e.byteLength;if(e.keyFrame){i.flags.dependsOn=2;i.flags.isNonSyncSample=0}return i};var Q=function(e,t){var i,r,n,a,s,o=t||0,u=[];for(i=0;i<e.length;i++){a=e[i];for(r=0;r<a.length;r++){s=a[r];n=Z(s,o);o+=n.size;u.push(n)}}return u};var X=function(e){var t,i,r,n,a,s,o=0,u=e.byteLength,l=e.nalCount,d=u+4*l,c=new Uint8Array(d),h=new DataView(c.buffer);for(t=0;t<e.length;t++){n=e[t];for(i=0;i<n.length;i++){a=n[i];for(r=0;r<a.length;r++){s=a[r];h.setUint32(o,s.data.byteLength);o+=4;c.set(s.data,o);o+=s.data.byteLength}}}return c};var Y=function(e,t){var i,r=t||0,n=[];i=Z(e,r);n.push(i);return n};var $=function(e){var t,i,r=0,n=e.byteLength,a=e.length,s=n+4*a,o=new Uint8Array(s),u=new DataView(o.buffer);for(t=0;t<e.length;t++){i=e[t];u.setUint32(r,i.data.byteLength);r+=4;o.set(i.data,r);r+=i.data.byteLength}return o};var J={groupNalsIntoFrames:W,groupFramesIntoGops:z,extendFirstKeyFrame:G,generateSampleTable:Q,concatenateNalData:X,generateSampleTableForFrame:Y,concatenateNalDataForFrame:$};var ee=[33,16,5,32,164,27];var te=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252];var ie=function(e){var t=[];while(e--)t.push(0);return t};var re=function(e){return Object.keys(e).reduce((function(t,i){t[i]=new Uint8Array(e[i].reduce((function(e,t){return e.concat(t)}),[]));return t}),{})};var ne;var ae=function(){if(!ne){var e={96e3:[ee,[227,64],ie(154),[56]],88200:[ee,[231],ie(170),[56]],64e3:[ee,[248,192],ie(240),[56]],48e3:[ee,[255,192],ie(268),[55,148,128],ie(54),[112]],44100:[ee,[255,192],ie(268),[55,163,128],ie(84),[112]],32e3:[ee,[255,192],ie(268),[55,234],ie(226),[112]],24e3:[ee,[255,192],ie(268),[55,255,128],ie(268),[111,112],ie(126),[224]],16e3:[ee,[255,192],ie(268),[55,255,128],ie(268),[111,255],ie(269),[223,108],ie(195),[1,192]],12e3:[te,ie(268),[3,127,248],ie(268),[6,255,240],ie(268),[13,255,224],ie(268),[27,253,128],ie(259),[56]],11025:[te,ie(268),[3,127,248],ie(268),[6,255,240],ie(268),[13,255,224],ie(268),[27,255,192],ie(268),[55,175,128],ie(108),[112]],8e3:[te,ie(268),[3,121,16],ie(47),[7]]};ne=re(e)}return ne};var se,oe,ue,le,de,ce,he,fe=9e4;se=function(e){return e*fe};oe=function(e,t){return e*t};ue=function(e){return e/fe};le=function(e,t){return e/t};de=function(e,t){return se(le(e,t))};ce=function(e,t){return oe(ue(e),t)};he=function(e,t,i){return ue(i?e:e-t)};var pe={ONE_SECOND_IN_TS:fe,secondsToVideoTs:se,secondsToAudioTs:oe,videoTsToSeconds:ue,audioTsToSeconds:le,audioTsToVideoTs:de,videoTsToAudioTs:ce,metadataTsToSeconds:he};var me=function(e){var t,i,r=0;for(t=0;t<e.length;t++){i=e[t];r+=i.data.byteLength}return r};var ve=function(e,t,i,r){var n,a,s,o,u=0,l=0,d=0,c=0;if(!t.length)return;n=pe.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate);u=Math.ceil(pe.ONE_SECOND_IN_TS/(e.samplerate/1024));if(i&&r){l=n-Math.max(i,r);d=Math.floor(l/u);c=d*u}if(d<1||c>pe.ONE_SECOND_IN_TS/2)return;a=ae()[e.samplerate];if(!a)a=t[0].data;for(s=0;s<d;s++){o=t[0];t.splice(0,0,{data:a,dts:o.dts-u,pts:o.pts-u})}e.baseMediaDecodeTime-=Math.floor(pe.videoTsToAudioTs(c,e.samplerate));return c};var ge=function(e,t,i){if(t.minSegmentDts>=i)return e;t.minSegmentDts=1/0;return e.filter((function(e){if(e.dts>=i){t.minSegmentDts=Math.min(t.minSegmentDts,e.dts);t.minSegmentPts=t.minSegmentDts;return true}return false}))};var _e=function(e){var t,i,r=[];for(t=0;t<e.length;t++){i=e[t];r.push({size:i.data.byteLength,duration:1024})}return r};var ye=function(e){var t,i,r=0,n=new Uint8Array(me(e));for(t=0;t<e.length;t++){i=e[t];n.set(i.data,r);r+=i.data.byteLength}return n};var Te={prefixWithSilence:ve,trimAdtsFramesByEarliestDts:ge,generateSampleTable:_e,concatenateFrameData:ye};var be=pe.ONE_SECOND_IN_TS;var Se=function(e,t){if("number"===typeof t.pts){if(void 0===e.timelineStartInfo.pts)e.timelineStartInfo.pts=t.pts;if(void 0===e.minSegmentPts)e.minSegmentPts=t.pts;else e.minSegmentPts=Math.min(e.minSegmentPts,t.pts);if(void 0===e.maxSegmentPts)e.maxSegmentPts=t.pts;else e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)}if("number"===typeof t.dts){if(void 0===e.timelineStartInfo.dts)e.timelineStartInfo.dts=t.dts;if(void 0===e.minSegmentDts)e.minSegmentDts=t.dts;else e.minSegmentDts=Math.min(e.minSegmentDts,t.dts);if(void 0===e.maxSegmentDts)e.maxSegmentDts=t.dts;else e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts)}};var ke=function(e){delete e.minSegmentDts;delete e.maxSegmentDts;delete e.minSegmentPts;delete e.maxSegmentPts};var Ce=function(e,t){var i,r,n=e.minSegmentDts;if(!t)n-=e.timelineStartInfo.dts;i=e.timelineStartInfo.baseMediaDecodeTime;i+=n;i=Math.max(0,i);if("audio"===e.type){r=e.samplerate/be;i*=r;i=Math.floor(i)}return i};var Ee={clearDtsInfo:ke,calculateTrackBaseMediaDecodeTime:Ce,collectDtsInfo:Se};var we=4,Ie=128;var xe=function(e){var t=0,i={payloadType:-1,payloadSize:0},r=0,n=0;while(t<e.byteLength){if(e[t]===Ie)break;while(255===e[t]){r+=255;t++}r+=e[t++];while(255===e[t]){n+=255;t++}n+=e[t++];if(!i.payload&&r===we){var a=String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6]);if("GA94"===a){i.payloadType=r;i.payloadSize=n;i.payload=e.subarray(t,t+n);break}else i.payload=void 0}t+=n;r=0;n=0}return i};var Pe=function(e){if(181!==e.payload[0])return null;if(49!==(e.payload[1]<<8|e.payload[2]))return null;if("GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6]))return null;if(3!==e.payload[7])return null;return e.payload.subarray(8,e.payload.length-1)};var Ae=function(e,t){var i,r,n,a,s=[];if(!(64&t[0]))return s;r=31&t[0];for(i=0;i<r;i++){n=3*i;a={type:3&t[n+2],pts:e};if(4&t[n+2]){a.ccData=t[n+3]<<8|t[n+4];s.push(a)}}return s};var Le=function(e){var t,i,r=e.byteLength,n=[],a=1;while(a<r-2)if(0===e[a]&&0===e[a+1]&&3===e[a+2]){n.push(a+2);a+=2}else a++;if(0===n.length)return e;t=r-n.length;i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++){if(s===n[0]){s++;n.shift()}i[a]=e[s]}return i};var Oe={parseSei:xe,parseUserData:Pe,parseCaptionPackets:Ae,discardEmulationPreventionBytes:Le,USER_DATA_REGISTERED_ITU_T_T35:we};var De=function e(t){t=t||{};e.prototype.init.call(this);this.parse708captions_="boolean"===typeof t.parse708captions?t.parse708captions:true;this.captionPackets_=[];this.ccStreams_=[new ze(0,0),new ze(0,1),new ze(1,0),new ze(1,1)];if(this.parse708captions_)this.cc708Stream_=new Fe({captionServices:t.captionServices});this.reset();this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data"));e.on("partialdone",this.trigger.bind(this,"partialdone"));e.on("done",this.trigger.bind(this,"done"))}),this);if(this.parse708captions_){this.cc708Stream_.on("data",this.trigger.bind(this,"data"));this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone"));this.cc708Stream_.on("done",this.trigger.bind(this,"done"))}};De.prototype=new t;De.prototype.push=function(e){var t,i,r;if("sei_rbsp"!==e.nalUnitType)return;t=Oe.parseSei(e.escapedRBSP);if(!t.payload)return;if(t.payloadType!==Oe.USER_DATA_REGISTERED_ITU_T_T35)return;i=Oe.parseUserData(t);if(!i)return;if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=true;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_)this.ignoreNextEqualDts_=false;return}r=Oe.parseCaptionPackets(e.pts,i);this.captionPackets_=this.captionPackets_.concat(r);if(this.latestDts_!==e.dts)this.numSameDts_=0;this.numSameDts_++;this.latestDts_=e.dts};De.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)};De.prototype.flushStream=function(e){if(!this.captionPackets_.length){this.flushCCStreams(e);return}this.captionPackets_.forEach((function(e,t){e.presortIndex=t}));this.captionPackets_.sort((function(e,t){if(e.pts===t.pts)return e.presortIndex-t.presortIndex;return e.pts-t.pts}));this.captionPackets_.forEach((function(e){if(e.type<2)this.dispatchCea608Packet(e);else this.dispatchCea708Packet(e)}),this);this.captionPackets_.length=0;this.flushCCStreams(e)};De.prototype.flush=function(){return this.flushStream("flush")};De.prototype.partialFlush=function(){return this.flushStream("partialFlush")};De.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=false;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach((function(e){e.reset()}))};De.prototype.dispatchCea608Packet=function(e){if(this.setsTextOrXDSActive(e))this.activeCea608Channel_[e.type]=null;else if(this.setsChannel1Active(e))this.activeCea608Channel_[e.type]=0;else if(this.setsChannel2Active(e))this.activeCea608Channel_[e.type]=1;if(null===this.activeCea608Channel_[e.type])return;this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};De.prototype.setsChannel1Active=function(e){return 4096===(30720&e.ccData)};De.prototype.setsChannel2Active=function(e){return 6144===(30720&e.ccData)};De.prototype.setsTextOrXDSActive=function(e){return 256===(28928&e.ccData)||4138===(30974&e.ccData)||6186===(30974&e.ccData)};De.prototype.dispatchCea708Packet=function(e){if(this.parse708captions_)this.cc708Stream_.push(e)};var Me={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600};var Re=function(e){var t=Me[e]||e;if(4096&e&&e===t)return"";return String.fromCharCode(t)};var Ue=function(e){return 32<=e&&e<=127||160<=e&&e<=255};var Be=function(e){this.windowNum=e;this.reset()};Be.prototype.reset=function(){this.clearText();this.pendingNewLine=false;this.winAttr={};this.penAttr={};this.penLoc={};this.penColor={};this.visible=0;this.rowLock=0;this.columnLock=0;this.priority=0;this.relativePositioning=0;this.anchorVertical=0;this.anchorHorizontal=0;this.anchorPoint=0;this.rowCount=1;this.virtualRowCount=this.rowCount+1;this.columnCount=41;this.windowStyle=0;this.penStyle=0};Be.prototype.getText=function(){return this.rows.join("\n")};Be.prototype.clearText=function(){this.rows=[""];this.rowIdx=0};Be.prototype.newLine=function(e){if(this.rows.length>=this.virtualRowCount&&"function"===typeof this.beforeRowOverflow)this.beforeRowOverflow(e);if(this.rows.length>0){this.rows.push("");this.rowIdx++}while(this.rows.length>this.virtualRowCount){this.rows.shift();this.rowIdx--}};Be.prototype.isEmpty=function(){if(0===this.rows.length)return true;else if(1===this.rows.length)return""===this.rows[0];return false};Be.prototype.addText=function(e){this.rows[this.rowIdx]+=e};Be.prototype.backspace=function(){if(!this.isEmpty()){var e=this.rows[this.rowIdx];this.rows[this.rowIdx]=e.substr(0,e.length-1)}};var Ne=function(e,t,i){this.serviceNum=e;this.text="";this.currentWindow=new Be(-1);this.windows=[];this.stream=i;if("string"===typeof t)this.createTextDecoder(t)};Ne.prototype.init=function(e,t){this.startPts=e;for(var i=0;i<8;i++){this.windows[i]=new Be(i);if("function"===typeof t)this.windows[i].beforeRowOverflow=t}};Ne.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]};Ne.prototype.createTextDecoder=function(e){if("undefined"===typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(e)}catch(t){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+e+" encoding. "+t})}};var Fe=function e(t){t=t||{};e.prototype.init.call(this);var i=this;var r=t.captionServices||{};var n={};var a;Object.keys(r).forEach((function(e){a=r[e];if(/^SERVICE/.test(e))n[e]=a.encoding}));this.serviceEncodings=n;this.current708Packet=null;this.services={};this.push=function(e){if(3===e.type){i.new708Packet();i.add708Bytes(e)}else{if(null===i.current708Packet)i.new708Packet();i.add708Bytes(e)}}};Fe.prototype=new t;Fe.prototype.new708Packet=function(){if(null!==this.current708Packet)this.push708Packet();this.current708Packet={data:[],ptsVals:[]}};Fe.prototype.add708Bytes=function(e){var t=e.ccData;var i=t>>>8;var r=255&t;this.current708Packet.ptsVals.push(e.pts);this.current708Packet.data.push(i);this.current708Packet.data.push(r)};Fe.prototype.push708Packet=function(){var e=this.current708Packet;var t=e.data;var i=null;var r=null;var n=0;var a=t[n++];e.seq=a>>6;e.sizeCode=63&a;for(;n<t.length;n++){a=t[n++];i=a>>5;r=31&a;if(7===i&&r>0){a=t[n++];i=a}this.pushServiceBlock(i,n,r);if(r>0)n+=r-1}};Fe.prototype.pushServiceBlock=function(e,t,i){var r;var n=t;var a=this.current708Packet.data;var s=this.services[e];if(!s)s=this.initService(e,n);for(;n<t+i&&n<a.length;n++){r=a[n];if(Ue(r))n=this.handleText(n,s);else if(24===r)n=this.multiByteCharacter(n,s);else if(16===r)n=this.extendedCommands(n,s);else if(128<=r&&r<=135)n=this.setCurrentWindow(n,s);else if(152<=r&&r<=159)n=this.defineWindow(n,s);else if(136===r)n=this.clearWindows(n,s);else if(140===r)n=this.deleteWindows(n,s);else if(137===r)n=this.displayWindows(n,s);else if(138===r)n=this.hideWindows(n,s);else if(139===r)n=this.toggleWindows(n,s);else if(151===r)n=this.setWindowAttributes(n,s);else if(144===r)n=this.setPenAttributes(n,s);else if(145===r)n=this.setPenColor(n,s);else if(146===r)n=this.setPenLocation(n,s);else if(143===r)s=this.reset(n,s);else if(8===r)s.currentWindow.backspace();else if(12===r)s.currentWindow.clearText();else if(13===r)s.currentWindow.pendingNewLine=true;else if(14===r)s.currentWindow.clearText();else if(141===r)n++}};Fe.prototype.extendedCommands=function(e,t){var i=this.current708Packet.data;var r=i[++e];if(Ue(r))e=this.handleText(e,t,{isExtended:true});return e};Fe.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]};Fe.prototype.initService=function(e,t){var i="SERVICE"+e;var r=this;var n;if(i in this.serviceEncodings)n=this.serviceEncodings[i];this.services[e]=new Ne(e,n,r);this.services[e].init(this.getPts(t),(function(t){r.flushDisplayed(t,r.services[e])}));return this.services[e]};Fe.prototype.handleText=function(e,t,i){var r=i&&i.isExtended;var n=i&&i.isMultiByte;var a=this.current708Packet.data;var s=r?4096:0;var o=a[e];var u=a[e+1];var l=t.currentWindow;var d;var c;if(t.textDecoder_&&!r){if(n){c=[o,u];e++}else c=[o];d=t.textDecoder_.decode(new Uint8Array(c))}else d=Re(s|o);if(l.pendingNewLine&&!l.isEmpty())l.newLine(this.getPts(e));l.pendingNewLine=false;l.addText(d);return e};Fe.prototype.multiByteCharacter=function(e,t){var i=this.current708Packet.data;var r=i[e+1];var n=i[e+2];if(Ue(r)&&Ue(n))e=this.handleText(++e,t,{isMultiByte:true});return e};Fe.prototype.setCurrentWindow=function(e,t){var i=this.current708Packet.data;var r=i[e];var n=7&r;t.setCurrentWindow(n);return e};Fe.prototype.defineWindow=function(e,t){var i=this.current708Packet.data;var r=i[e];var n=7&r;t.setCurrentWindow(n);var a=t.currentWindow;r=i[++e];a.visible=(32&r)>>5;a.rowLock=(16&r)>>4;a.columnLock=(8&r)>>3;a.priority=7&r;r=i[++e];a.relativePositioning=(128&r)>>7;a.anchorVertical=127&r;r=i[++e];a.anchorHorizontal=r;r=i[++e];a.anchorPoint=(240&r)>>4;a.rowCount=15&r;r=i[++e];a.columnCount=63&r;r=i[++e];a.windowStyle=(56&r)>>3;a.penStyle=7&r;a.virtualRowCount=a.rowCount+1;return e};Fe.prototype.setWindowAttributes=function(e,t){var i=this.current708Packet.data;var r=i[e];var n=t.currentWindow.winAttr;r=i[++e];n.fillOpacity=(192&r)>>6;n.fillRed=(48&r)>>4;n.fillGreen=(12&r)>>2;n.fillBlue=3&r;r=i[++e];n.borderType=(192&r)>>6;n.borderRed=(48&r)>>4;n.borderGreen=(12&r)>>2;n.borderBlue=3&r;r=i[++e];n.borderType+=(128&r)>>5;n.wordWrap=(64&r)>>6;n.printDirection=(48&r)>>4;n.scrollDirection=(12&r)>>2;n.justify=3&r;r=i[++e];n.effectSpeed=(240&r)>>4;n.effectDirection=(12&r)>>2;n.displayEffect=3&r;return e};Fe.prototype.flushDisplayed=function(e,t){var i=[];for(var r=0;r<8;r++)if(t.windows[r].visible&&!t.windows[r].isEmpty())i.push(t.windows[r].getText());t.endPts=e;t.text=i.join("\n\n");this.pushCaption(t);t.startPts=e};Fe.prototype.pushCaption=function(e){if(""!==e.text){this.trigger("data",{startPts:e.startPts,endPts:e.endPts,text:e.text,stream:"cc708_"+e.serviceNum});e.text="";e.startPts=e.endPts}};Fe.prototype.displayWindows=function(e,t){var i=this.current708Packet.data;var r=i[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++)if(r&1<<a)t.windows[a].visible=1;return e};Fe.prototype.hideWindows=function(e,t){var i=this.current708Packet.data;var r=i[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++)if(r&1<<a)t.windows[a].visible=0;return e};Fe.prototype.toggleWindows=function(e,t){var i=this.current708Packet.data;var r=i[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++)if(r&1<<a)t.windows[a].visible^=1;return e};Fe.prototype.clearWindows=function(e,t){var i=this.current708Packet.data;var r=i[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++)if(r&1<<a)t.windows[a].clearText();return e};Fe.prototype.deleteWindows=function(e,t){var i=this.current708Packet.data;var r=i[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++)if(r&1<<a)t.windows[a].reset();return e};Fe.prototype.setPenAttributes=function(e,t){var i=this.current708Packet.data;var r=i[e];var n=t.currentWindow.penAttr;r=i[++e];n.textTag=(240&r)>>4;n.offset=(12&r)>>2;n.penSize=3&r;r=i[++e];n.italics=(128&r)>>7;n.underline=(64&r)>>6;n.edgeType=(56&r)>>3;n.fontStyle=7&r;return e};Fe.prototype.setPenColor=function(e,t){var i=this.current708Packet.data;var r=i[e];var n=t.currentWindow.penColor;r=i[++e];n.fgOpacity=(192&r)>>6;n.fgRed=(48&r)>>4;n.fgGreen=(12&r)>>2;n.fgBlue=3&r;r=i[++e];n.bgOpacity=(192&r)>>6;n.bgRed=(48&r)>>4;n.bgGreen=(12&r)>>2;n.bgBlue=3&r;r=i[++e];n.edgeRed=(48&r)>>4;n.edgeGreen=(12&r)>>2;n.edgeBlue=3&r;return e};Fe.prototype.setPenLocation=function(e,t){var i=this.current708Packet.data;var r=i[e];var n=t.currentWindow.penLoc;t.currentWindow.pendingNewLine=true;r=i[++e];n.row=15&r;r=i[++e];n.column=63&r;return e};Fe.prototype.reset=function(e,t){var i=this.getPts(e);this.flushDisplayed(i,t);return this.initService(t.serviceNum,e)};var je={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496};var He=function(e){if(null===e)return"";e=je[e]||e;return String.fromCharCode(e)};var qe=14;var Ve=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152];var We=function(){var e=[],t=qe+1;while(t--)e.push("");return e};var ze=function e(t,i){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=i||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,i,r,n,a;t=32639&e.ccData;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if(4096===(61440&t))this.lastControlCode_=t;else if(t!==this.PADDING_)this.lastControlCode_=null;r=t>>>8;n=255&t;if(t===this.PADDING_)return;else if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);i=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=i;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_)if("popOn"===this.mode_)this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1);else this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=We()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=We();else if(t===this.RESUME_DIRECT_CAPTIONING_){if("paintOn"!==this.mode_){this.flushDisplayed(e.pts);this.displayed_=We()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(r,n)){r=(3&r)<<8;a=He(r|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isExtCharacter(r,n)){if("popOn"===this.mode_)this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1);else this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);r=(3&r)<<8;a=He(r|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isMidRowCode(r,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if(14===(14&n))this.addFormatting(e.pts,["i"]);if(1===(1&n))this.addFormatting(e.pts,["u"])}else if(this.isOffsetControlCode(r,n))this.column_+=3&n;else if(this.isPAC(r,n)){var s=Ve.indexOf(7968&t);if("rollUp"===this.mode_){if(s-this.rollUpRows_+1<0)s=this.rollUpRows_-1;this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(1&n&&-1===this.formatting_.indexOf("u"))this.addFormatting(e.pts,["u"]);if(16===(16&t))this.column_=4*((14&t)>>1);if(this.isColorPAC(n))if(14===(14&n))this.addFormatting(e.pts,["i"])}else if(this.isNormalChar(r)){if(0===n)n=null;a=He(r);a+=He(n);this[this.mode_](e.pts,a);this.column_+=a.length}}};ze.prototype=new t;ze.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e,t){try{return e.trim()}catch(i){this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+t+"."});return""}}),this).join("\n").replace(/^\n+|\n+$/g,"");if(t.length)this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})};ze.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=We();this.nonDisplayed_=We();this.lastControlCode_=null;this.column_=0;this.row_=qe;this.rollUpRows_=2;this.formatting_=[]};ze.prototype.setConstants=function(){if(0===this.dataChannel_){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(1===this.dataChannel_){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=32|this.CONTROL_;this.END_OF_CAPTION_=47|this.CONTROL_;this.ROLL_UP_2_ROWS_=37|this.CONTROL_;this.ROLL_UP_3_ROWS_=38|this.CONTROL_;this.ROLL_UP_4_ROWS_=39|this.CONTROL_;this.CARRIAGE_RETURN_=45|this.CONTROL_;this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_;this.BACKSPACE_=33|this.CONTROL_;this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_;this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_};ze.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63};ze.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63};ze.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47};ze.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35};ze.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127};ze.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127};ze.prototype.isNormalChar=function(e){return e>=32&&e<=127};ze.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_){this.row_=qe;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=We();this.displayed_=We()}if(void 0!==t&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++){this.displayed_[t-i]=this.displayed_[this.row_-i];this.displayed_[this.row_-i]=""}if(void 0===t)t=this.row_;this.topRow_=t-this.rollUpRows_+1};ze.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,i)};ze.prototype.clearFormatting=function(e){if(!this.formatting_.length)return;var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[];this[this.mode_](e,t)};ze.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];i+=t;this.nonDisplayed_[this.row_]=i};ze.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};ze.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<qe+1;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""};ze.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};var Ge={CaptionStream:De,Cea608Stream:ze,Cea708Stream:Fe};var Ke={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};var Ze=8589934592;var Qe=4294967296;var Xe="shared";var Ye=function(e,t){var i=1;if(e>t)i=-1;while(Math.abs(t-e)>Qe)e+=i*Ze;return e};var $e=function e(t){var i,r;e.prototype.init.call(this);this.type_=t||Xe;this.push=function(e){if(this.type_!==Xe&&e.type!==this.type_)return;if(void 0===r)r=e.dts;e.dts=Ye(e.dts,r);e.pts=Ye(e.pts,r);i=e.dts;this.trigger("data",e)};this.flush=function(){r=i;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){r=void 0;i=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};$e.prototype=new t;var Je={TimestampRolloverStream:$e,handleRollover:Ye};var et,tt=function(e,t,i){var r,n="";for(r=t;r<i;r++)n+="%"+("00"+e[r].toString(16)).slice(-2);return n},it=function(e,t,i){return decodeURIComponent(tt(e,t,i))},rt=function(e,t,i){return unescape(tt(e,t,i))},nt=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},at={TXXX:function(e){var t;if(3!==e.data[0])return;for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=it(e.data,1,t);e.value=it(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value},WXXX:function(e){var t;if(3!==e.data[0])return;for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=it(e.data,1,t);e.url=it(e.data,t+1,e.data.length);break}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=rt(e.data,0,t);break}e.privateData=e.data.subarray(t+1);e.data=e.privateData}};et=function(e){var t,i={descriptor:e&&e.descriptor},r=0,n=[],a=0;et.prototype.init.call(this);this.dispatchType=Ke.METADATA_STREAM_TYPE.toString(16);if(i.descriptor)for(t=0;t<i.descriptor.length;t++)this.dispatchType+=("00"+i.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,s,o,u,l;if("timed-metadata"!==e.type)return;if(e.dataAlignmentIndicator){a=0;n.length=0}if(0===n.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}n.push(e);a+=e.data.byteLength;if(1===n.length){r=nt(e.data.subarray(6,10));r+=10}if(a<r)return;t={data:new Uint8Array(r),frames:[],pts:n[0].pts,dts:n[0].dts};for(u=0;u<r;){t.data.set(n[0].data.subarray(0,r-u),u);u+=n[0].data.byteLength;a-=n[0].data.byteLength;n.shift()}i=10;if(64&t.data[5]){i+=4;i+=nt(t.data.subarray(10,14));r-=nt(t.data.subarray(16,20))}do{s=nt(t.data.subarray(i+4,i+8));if(s<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});return}l=String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]);o={id:l,data:t.data.subarray(i+10,i+s+10)};o.key=o.id;if(at[o.id]){at[o.id](o);if("com.apple.streaming.transportStreamTimestamp"===o.owner){var d=o.data,c=(1&d[3])<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;c*=4;c+=3&d[7];o.timeStamp=c;if(void 0===t.pts&&void 0===t.dts){t.pts=o.timeStamp;t.dts=o.timeStamp}this.trigger("timestamp",o)}}t.frames.push(o);i+=10;i+=s}while(i<r);this.trigger("data",t)}};et.prototype=new t;var st=et;var ot=Je.TimestampRolloverStream;var ut,lt,dt;var ct=188,ht=71;ut=function(){var e=new Uint8Array(ct),t=0;ut.prototype.init.call(this);this.push=function(i){var r,n=0,a=ct;if(t){r=new Uint8Array(i.byteLength+t);r.set(e.subarray(0,t));r.set(i,t);t=0}else r=i;while(a<r.byteLength){if(r[n]===ht&&r[a]===ht){this.trigger("data",r.subarray(n,a));n+=ct;a+=ct;continue}n++;a++}if(n<r.byteLength){e.set(r.subarray(n),0);t=r.byteLength-n}};this.flush=function(){if(t===ct&&e[0]===ht){this.trigger("data",e);t=0}this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.reset=function(){t=0;this.trigger("reset")}};ut.prototype=new t;lt=function(){var e,t,i,r;lt.prototype.init.call(this);r=this;this.packetsWaitingForPmt=[];this.programMapTable=void 0;e=function(e,r){var n=0;if(r.payloadUnitStartIndicator)n+=e[n]+1;if("pat"===r.type)t(e.subarray(n),r);else i(e.subarray(n),r)};t=function(e,t){t.section_number=e[7];t.last_section_number=e[8];r.pmtPid=(31&e[10])<<8|e[11];t.pmtPid=r.pmtPid};i=function(e,t){var i,n,a,s;if(!(1&e[5]))return;r.programMapTable={video:null,audio:null,"timed-metadata":{}};i=(15&e[1])<<8|e[2];n=3+i-4;a=(15&e[10])<<8|e[11];s=12+a;while(s<n){var o=e[s];var u=(31&e[s+1])<<8|e[s+2];if(o===Ke.H264_STREAM_TYPE&&null===r.programMapTable.video)r.programMapTable.video=u;else if(o===Ke.ADTS_STREAM_TYPE&&null===r.programMapTable.audio)r.programMapTable.audio=u;else if(o===Ke.METADATA_STREAM_TYPE)r.programMapTable["timed-metadata"][u]=o;s+=((15&e[s+3])<<8|e[s+4])+5}t.programMapTable=r.programMapTable};this.push=function(t){var i={},r=4;i.payloadUnitStartIndicator=!!(64&t[1]);i.pid=31&t[1];i.pid<<=8;i.pid|=t[2];if((48&t[3])>>>4>1)r+=t[r]+1;if(0===i.pid){i.type="pat";e(t.subarray(r),i);this.trigger("data",i)}else if(i.pid===this.pmtPid){i.type="pmt";e(t.subarray(r),i);this.trigger("data",i);while(this.packetsWaitingForPmt.length)this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}else if(void 0===this.programMapTable)this.packetsWaitingForPmt.push([t,r,i]);else this.processPes_(t,r,i)};this.processPes_=function(e,t,i){if(i.pid===this.programMapTable.video)i.streamType=Ke.H264_STREAM_TYPE;else if(i.pid===this.programMapTable.audio)i.streamType=Ke.ADTS_STREAM_TYPE;else i.streamType=this.programMapTable["timed-metadata"][i.pid];i.type="pes";i.data=e.subarray(t);this.trigger("data",i)}};lt.prototype=new t;lt.STREAM_TYPES={h264:27,adts:15};dt=function(){var e,t=this,i=false,r={data:[],size:0},n={data:[],size:0},a={data:[],size:0},s=function(e,t){var i;var r=e[0]<<16|e[1]<<8|e[2];t.data=new Uint8Array;if(1!==r)return;t.packetLength=6+(e[4]<<8|e[5]);t.dataAlignmentIndicator=0!==(4&e[6]);i=e[7];if(192&i){t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3;t.pts*=4;t.pts+=(6&e[13])>>>1;t.dts=t.pts;if(64&i){t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3;t.dts*=4;t.dts+=(6&e[18])>>>1}}t.data=e.subarray(9+e[8])},o=function(e,i,r){var n,a=new Uint8Array(e.size),o={type:i},u=0,l=0,d=false;if(!e.data.length||e.size<9)return;o.trackId=e.data[0].pid;for(u=0;u<e.data.length;u++){n=e.data[u];a.set(n.data,l);l+=n.data.byteLength}s(a,o);d="video"===i||o.packetLength<=e.size;if(r||d){e.size=0;e.data.length=0}if(d)t.trigger("data",o)};dt.prototype.init.call(this);this.push=function(s){({pat:function(){},pes:function(){var e,t;switch(s.streamType){case Ke.H264_STREAM_TYPE:e=r;t="video";break;case Ke.ADTS_STREAM_TYPE:e=n;t="audio";break;case Ke.METADATA_STREAM_TYPE:e=a;t="timed-metadata";break;default:return}if(s.payloadUnitStartIndicator)o(e,t,true);e.data.push(s);e.size+=s.data.byteLength},pmt:function(){var r={type:"metadata",tracks:[]};e=s.programMapTable;if(null!==e.video)r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"});if(null!==e.audio)r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"});i=true;t.trigger("data",r)}})[s.type]()};this.reset=function(){r.size=0;r.data.length=0;n.size=0;n.data.length=0;this.trigger("reset")};this.flushStreams_=function(){o(r,"video");o(n,"audio");o(a,"timed-metadata")};this.flush=function(){if(!i&&e){var r={type:"metadata",tracks:[]};if(null!==e.video)r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"});if(null!==e.audio)r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"});t.trigger("data",r)}i=false;this.flushStreams_();this.trigger("done")}};dt.prototype=new t;var ft={PAT_PID:0,MP2T_PACKET_LENGTH:ct,TransportPacketStream:ut,TransportParseStream:lt,ElementaryStream:dt,TimestampRolloverStream:ot,CaptionStream:Ge.CaptionStream,Cea608Stream:Ge.Cea608Stream,Cea708Stream:Ge.Cea708Stream,MetadataStream:st};for(var pt in Ke)if(Ke.hasOwnProperty(pt))ft[pt]=Ke[pt];var mt=ft;var vt=pe.ONE_SECOND_IN_TS;var gt;var _t=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];gt=function(e){var t,i=0;gt.prototype.init.call(this);this.skipWarn_=function(e,t){this.trigger("log",{level:"warn",message:"adts skiping bytes "+e+" to "+t+" in frame "+i+" outside syncword"})};this.push=function(r){var n,a,s,o,u,l=0;if(!e)i=0;if("audio"!==r.type)return;if(t&&t.length){s=t;t=new Uint8Array(s.byteLength+r.data.byteLength);t.set(s);t.set(r.data,s.byteLength)}else t=r.data;var d;while(l+7<t.length){if(255!==t[l]||240!==(246&t[l+1])){if("number"!==typeof d)d=l;l++;continue}if("number"===typeof d){this.skipWarn_(d,l);d=null}a=2*(1&~t[l+1]);n=(3&t[l+3])<<11|t[l+4]<<3|(224&t[l+5])>>5;o=1024*((3&t[l+6])+1);u=o*vt/_t[(60&t[l+2])>>>2];if(t.byteLength-l<n)break;this.trigger("data",{pts:r.pts+i*u,dts:r.dts+i*u,sampleCount:o,audioobjecttype:(t[l+2]>>>6&3)+1,channelcount:(1&t[l+2])<<2|(192&t[l+3])>>>6,samplerate:_t[(60&t[l+2])>>>2],samplingfrequencyindex:(60&t[l+2])>>>2,samplesize:16,data:t.subarray(l+7+a,l+n)});i++;l+=n}if("number"===typeof d){this.skipWarn_(d,l);d=null}t=t.subarray(l)};this.flush=function(){i=0;this.trigger("done")};this.reset=function(){t=void 0;this.trigger("reset")};this.endTimeline=function(){t=void 0;this.trigger("endedtimeline")}};gt.prototype=new t;var yt=gt;var Tt;Tt=function(e){var t=e.byteLength,i=0,r=0;this.length=function(){return 8*t};this.bitsAvailable=function(){return 8*t+r};this.loadWord=function(){var n=e.byteLength-t,a=new Uint8Array(4),s=Math.min(4,t);if(0===s)throw new Error("no bytes available");a.set(e.subarray(n,n+s));i=new DataView(a.buffer).getUint32(0);r=8*s;t-=s};this.skipBits=function(e){var n;if(r>e){i<<=e;r-=e}else{e-=r;n=Math.floor(e/8);e-=8*n;t-=n;this.loadWord();i<<=e;r-=e}};this.readBits=function(e){var n=Math.min(r,e),a=i>>>32-n;r-=n;if(r>0)i<<=n;else if(t>0)this.loadWord();n=e-n;if(n>0)return a<<n|this.readBits(n);return a};this.skipLeadingZeros=function(){var e;for(e=0;e<r;++e)if(0!==(i&2147483648>>>e)){i<<=e;r-=e;return e}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e)return 1+e>>>1;return-1*(e>>>1)};this.readBoolean=function(){return 1===this.readBits(1)};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var bt=Tt;var St,kt;var Ct;kt=function(){var e,t,i=0;kt.prototype.init.call(this);this.push=function(r){var n;if(!t)t=r.data;else{n=new Uint8Array(t.byteLength+r.data.byteLength);n.set(t);n.set(r.data,t.byteLength);t=n}var a=t.byteLength;for(;i<a-3;i++)if(1===t[i+2]){e=i+5;break}while(e<a)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}else if(0!==t[e-2]){e++;break}if(i+3!==e-2)this.trigger("data",t.subarray(i+3,e-2));do{e++}while(1!==t[e]&&e<a);i=e-2;e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(i+3,e-2));i=e-2;e+=3;break;default:e+=3;break}t=t.subarray(i);e-=i;i=0};this.reset=function(){t=null;i=0;this.trigger("reset")};this.flush=function(){if(t&&t.byteLength>3)this.trigger("data",t.subarray(i+3));t=null;i=0;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")}};kt.prototype=new t;Ct={100:true,110:true,122:true,244:true,44:true,83:true,86:true,118:true,128:true,138:true,139:true,134:true};St=function(){var e,t,i,r,n,a,s,o=new kt;St.prototype.init.call(this);e=this;this.push=function(e){if("video"!==e.type)return;t=e.trackId;i=e.pts;r=e.dts;o.push(e)};o.on("data",(function(s){var o={trackId:t,pts:i,dts:r,data:s,nalUnitTypeCode:31&s[0]};switch(o.nalUnitTypeCode){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp";o.escapedRBSP=n(s.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp";o.escapedRBSP=n(s.subarray(1));o.config=a(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp";break}e.trigger("data",o)}));o.on("done",(function(){e.trigger("done")}));o.on("partialdone",(function(){e.trigger("partialdone")}));o.on("reset",(function(){e.trigger("reset")}));o.on("endedtimeline",(function(){e.trigger("endedtimeline")}));this.flush=function(){o.flush()};this.partialFlush=function(){o.partialFlush()};this.reset=function(){o.reset()};this.endTimeline=function(){o.endTimeline()};s=function(e,t){var i,r,n=8,a=8;for(i=0;i<e;i++){if(0!==a){r=t.readExpGolomb();a=(n+r+256)%256}n=0===a?n:a}};n=function(e){var t,i,r=e.byteLength,n=[],a=1;while(a<r-2)if(0===e[a]&&0===e[a+1]&&3===e[a+2]){n.push(a+2);a+=2}else a++;if(0===n.length)return e;t=r-n.length;i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++){if(s===n[0]){s++;n.shift()}i[a]=e[s]}return i};a=function(e){var t,i,r,n,a,o,u,l,d,c,h,f,p,m=0,v=0,g=0,_=0,y=[1,1];t=new bt(e);i=t.readUnsignedByte();n=t.readUnsignedByte();r=t.readUnsignedByte();t.skipUnsignedExpGolomb();if(Ct[i]){a=t.readUnsignedExpGolomb();if(3===a)t.skipBits(1);t.skipUnsignedExpGolomb();t.skipUnsignedExpGolomb();t.skipBits(1);if(t.readBoolean()){h=3!==a?8:12;for(p=0;p<h;p++)if(t.readBoolean())if(p<6)s(16,t);else s(64,t)}}t.skipUnsignedExpGolomb();o=t.readUnsignedExpGolomb();if(0===o)t.readUnsignedExpGolomb();else if(1===o){t.skipBits(1);t.skipExpGolomb();t.skipExpGolomb();u=t.readUnsignedExpGolomb();for(p=0;p<u;p++)t.skipExpGolomb()}t.skipUnsignedExpGolomb();t.skipBits(1);l=t.readUnsignedExpGolomb();d=t.readUnsignedExpGolomb();c=t.readBits(1);if(0===c)t.skipBits(1);t.skipBits(1);if(t.readBoolean()){m=t.readUnsignedExpGolomb();v=t.readUnsignedExpGolomb();g=t.readUnsignedExpGolomb();_=t.readUnsignedExpGolomb()}if(t.readBoolean())if(t.readBoolean()){f=t.readUnsignedByte();switch(f){case 1:y=[1,1];break;case 2:y=[12,11];break;case 3:y=[10,11];break;case 4:y=[16,11];break;case 5:y=[40,33];break;case 6:y=[24,11];break;case 7:y=[20,11];break;case 8:y=[32,11];break;case 9:y=[80,33];break;case 10:y=[18,11];break;case 11:y=[15,11];break;case 12:y=[64,33];break;case 13:y=[160,99];break;case 14:y=[4,3];break;case 15:y=[3,2];break;case 16:y=[2,1];break;case 255:y=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()];break}if(y)y[0]/y[1]}return{profileIdc:i,levelIdc:r,profileCompatibility:n,width:16*(l+1)-2*m-2*v,height:(2-c)*(d+1)*16-2*g-2*_,sarRatio:y}}};St.prototype=new t;var Et={H264Stream:St,NalByteStream:kt};var wt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var It=function(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],r=e[t+5],n=(16&r)>>4;i=i>=0?i:0;if(n)return i+20;return i+10};var xt=function e(t,i){if(t.length-i<10||t[i]!=="I".charCodeAt(0)||t[i+1]!=="D".charCodeAt(0)||t[i+2]!=="3".charCodeAt(0))return i;i+=It(t,i);return e(t,i)};var Pt=function(e){var t=xt(e,0);return e.length>=t+2&&255===(255&e[t])&&240===(240&e[t+1])&&16===(22&e[t+1])};var At=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]};var Lt=function(e,t,i){var r,n="";for(r=t;r<i;r++)n+="%"+("00"+e[r].toString(16)).slice(-2);return n};var Ot=function(e,t,i){return unescape(Lt(e,t,i))};var Dt=function(e,t){var i=(224&e[t+5])>>5,r=e[t+4]<<3,n=e[t+3]&3<<11;return n|r|i};var Mt=function(e,t){if(e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0))return"timed-metadata";else if(e[t]&255===255&&240===(240&e[t+1]))return"audio";return null};var Rt=function(e){var t=0;while(t+5<e.length){if(255!==e[t]||240!==(246&e[t+1])){t++;continue}return wt[(60&e[t+2])>>>2]}return null};var Ut=function(e){var t,i,r,n;t=10;if(64&e[5]){t+=4;t+=At(e.subarray(10,14))}do{i=At(e.subarray(t+4,t+8));if(i<1)return null;n=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]);if("PRIV"===n){r=e.subarray(t+10,t+i+10);for(var a=0;a<r.byteLength;a++)if(0===r[a]){var s=Ot(r,0,a);if("com.apple.streaming.transportStreamTimestamp"===s){var o=r.subarray(a+1);var u=(1&o[3])<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;u*=4;u+=3&o[7];return u}break}}t+=10;t+=i}while(t<e.byteLength);return null};var Bt={isLikelyAacData:Pt,parseId3TagSize:It,parseAdtsSize:Dt,parseType:Mt,parseSampleRate:Rt,parseAacTimestamp:Ut};var Nt;Nt=function(){var e=new Uint8Array,t=0;Nt.prototype.init.call(this);this.setTimestamp=function(e){t=e};this.push=function(i){var r,n,a,s,o=0,u=0;if(e.length){s=e.length;e=new Uint8Array(i.byteLength+s);e.set(e.subarray(0,s));e.set(i,s)}else e=i;while(e.length-u>=3){if(e[u]==="I".charCodeAt(0)&&e[u+1]==="D".charCodeAt(0)&&e[u+2]==="3".charCodeAt(0)){if(e.length-u<10)break;o=Bt.parseId3TagSize(e,u);if(u+o>e.length)break;n={type:"timed-metadata",data:e.subarray(u,u+o)};this.trigger("data",n);u+=o;continue}else if(255===(255&e[u])&&240===(240&e[u+1])){if(e.length-u<7)break;o=Bt.parseAdtsSize(e,u);if(u+o>e.length)break;a={type:"audio",data:e.subarray(u,u+o),pts:t,dts:t};this.trigger("data",a);u+=o;continue}u++}r=e.length-u;if(r>0)e=e.subarray(u);else e=new Uint8Array};this.reset=function(){e=new Uint8Array;this.trigger("reset")};this.endTimeline=function(){e=new Uint8Array;this.trigger("endedtimeline")}};Nt.prototype=new t;var Ft=Nt;var jt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"];var Ht=jt;var qt=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"];var Vt=qt;var Wt=Et.H264Stream;var zt=Bt.isLikelyAacData;var Gt=pe.ONE_SECOND_IN_TS;var Kt,Zt,Qt,Xt;var Yt=function(e,t){t.stream=e;this.trigger("log",t)};var $t=function(e,t){var i=Object.keys(t);for(var r=0;r<i.length;r++){var n=i[r];if("headOfPipeline"===n||!t[n].on)continue;t[n].on("log",Yt.bind(e,n))}};var Jt=function(e,t){var i;if(e.length!==t.length)return false;for(i=0;i<e.length;i++)if(e[i]!==t[i])return false;return true};var ei=function(e,t,i,r,n,a){var s=i-t,o=r-t,u=n-i;return{start:{dts:e,pts:e+s},end:{dts:e+o,pts:e+u},prependedContentDuration:a,baseMediaDecodeTime:e}};Zt=function(e,t){var i,r=[],n=0,a=0,s=1/0;t=t||{};i=t.firstSequenceNumber||0;Zt.prototype.init.call(this);this.push=function(t){Ee.collectDtsInfo(e,t);if(e)Ht.forEach((function(i){e[i]=t[i]}));r.push(t)};this.setEarliestDts=function(e){n=e};this.setVideoBaseMediaDecodeTime=function(e){s=e};this.setAudioAppendStart=function(e){a=e};this.flush=function(){var o,u,l,d,c,h,f;if(0===r.length){this.trigger("done","AudioSegmentStream");return}o=Te.trimAdtsFramesByEarliestDts(r,e,n);e.baseMediaDecodeTime=Ee.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);f=Te.prefixWithSilence(e,o,a,s);e.samples=Te.generateSampleTable(o);l=V.mdat(Te.concatenateFrameData(o));r=[];u=V.moof(i,[e]);d=new Uint8Array(u.byteLength+l.byteLength);i++;d.set(u);d.set(l,u.byteLength);Ee.clearDtsInfo(e);c=Math.ceil(1024*Gt/e.samplerate);if(o.length){h=o.length*c;this.trigger("segmentTimingInfo",ei(pe.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),o[0].dts,o[0].pts,o[0].dts+h,o[0].pts+h,f||0));this.trigger("timingInfo",{start:o[0].pts,end:o[0].pts+h})}this.trigger("data",{track:e,boxes:d});this.trigger("done","AudioSegmentStream")};this.reset=function(){Ee.clearDtsInfo(e);r=[];this.trigger("reset")}};Zt.prototype=new t;Kt=function(e,t){var i,r,n,a=[],s=[];t=t||{};i=t.firstSequenceNumber||0;Kt.prototype.init.call(this);delete e.minPTS;this.gopCache_=[];this.push=function(t){Ee.collectDtsInfo(e,t);if("seq_parameter_set_rbsp"===t.nalUnitType&&!r){r=t.config;e.sps=[t.data];Vt.forEach((function(t){e[t]=r[t]}),this)}if("pic_parameter_set_rbsp"===t.nalUnitType&&!n){n=t.data;e.pps=[t.data]}a.push(t)};this.flush=function(){var r,n,o,u,l,d,c,h,f=0;while(a.length){if("access_unit_delimiter_rbsp"===a[0].nalUnitType)break;a.shift()}if(0===a.length){this.resetStream_();this.trigger("done","VideoSegmentStream");return}r=J.groupNalsIntoFrames(a);o=J.groupFramesIntoGops(r);if(!o[0][0].keyFrame){n=this.getGopForFusion_(a[0],e);if(n){f=n.duration;o.unshift(n);o.byteLength+=n.byteLength;o.nalCount+=n.nalCount;o.pts=n.pts;o.dts=n.dts;o.duration+=n.duration}else o=J.extendFirstKeyFrame(o)}if(s.length){var p;if(t.alignGopsAtEnd)p=this.alignGopsAtEnd_(o);else p=this.alignGopsAtStart_(o);if(!p){this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);a=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}Ee.clearDtsInfo(e);o=p}Ee.collectDtsInfo(e,o);e.samples=J.generateSampleTable(o);l=V.mdat(J.concatenateNalData(o));e.baseMediaDecodeTime=Ee.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",o.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})));c=o[0];h=o[o.length-1];this.trigger("segmentTimingInfo",ei(e.baseMediaDecodeTime,c.dts,c.pts,h.dts+h.duration,h.pts+h.duration,f));this.trigger("timingInfo",{start:o[0].pts,end:o[o.length-1].pts+o[o.length-1].duration});this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);a=[];this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime);this.trigger("timelineStartInfo",e.timelineStartInfo);u=V.moof(i,[e]);d=new Uint8Array(u.byteLength+l.byteLength);i++;d.set(u);d.set(l,u.byteLength);this.trigger("data",{track:e,boxes:d});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.reset=function(){this.resetStream_();a=[];this.gopCache_.length=0;s.length=0;this.trigger("reset")};this.resetStream_=function(){Ee.clearDtsInfo(e);r=void 0;n=void 0};this.getGopForFusion_=function(t){var i,r,n,a,s,o=45e3,u=1e4,l=1/0;for(s=0;s<this.gopCache_.length;s++){a=this.gopCache_[s];n=a.gop;if(!(e.pps&&Jt(e.pps[0],a.pps[0]))||!(e.sps&&Jt(e.sps[0],a.sps[0])))continue;if(n.dts<e.timelineStartInfo.dts)continue;i=t.dts-n.dts-n.duration;if(i>=-u&&i<=o)if(!r||l>i){r=a;l=i}}if(r)return r.gop;return null};this.alignGopsAtStart_=function(e){var t,i,r,n,a,o,u,l;a=e.byteLength;o=e.nalCount;u=e.duration;t=i=0;while(t<s.length&&i<e.length){r=s[t];n=e[i];if(r.pts===n.pts)break;if(n.pts>r.pts){t++;continue}i++;a-=n.byteLength;o-=n.nalCount;u-=n.duration}if(0===i)return e;if(i===e.length)return null;l=e.slice(i);l.byteLength=a;l.duration=u;l.nalCount=o;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,i,r,n,a,o;t=s.length-1;i=e.length-1;a=null;o=false;while(t>=0&&i>=0){r=s[t];n=e[i];if(r.pts===n.pts){o=true;break}if(r.pts>n.pts){t--;continue}if(t===s.length-1)a=i;i--}if(!o&&null===a)return null;var u;if(o)u=i;else u=a;if(0===u)return e;var l=e.slice(u);var d=l.reduce((function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e}),{byteLength:0,duration:0,nalCount:0});l.byteLength=d.byteLength;l.duration=d.duration;l.nalCount=d.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){s=e}};Kt.prototype=new t;Xt=function(e,t){this.numberOfTracks=0;this.metadataStream=t;e=e||{};if("undefined"!==typeof e.remux)this.remuxTracks=!!e.remux;else this.remuxTracks=true;if("boolean"===typeof e.keepOriginalTimestamps)this.keepOriginalTimestamps=e.keepOriginalTimestamps;else this.keepOriginalTimestamps=false;this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;Xt.prototype.init.call(this);this.push=function(e){if(e.text)return this.pendingCaptions.push(e);if(e.frames)return this.pendingMetadata.push(e);this.pendingTracks.push(e.track);this.pendingBytes+=e.boxes.byteLength;if("video"===e.track.type){this.videoTrack=e.track;this.pendingBoxes.push(e.boxes)}if("audio"===e.track.type){this.audioTrack=e.track;this.pendingBoxes.unshift(e.boxes)}}};Xt.prototype=new t;Xt.prototype.flush=function(e){var t,i,r,n,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks)if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;else if(this.remuxTracks)return;else if(0===this.pendingTracks.length){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}if(this.videoTrack){o=this.videoTrack.timelineStartInfo.pts;Vt.forEach((function(e){s.info[e]=this.videoTrack[e]}),this)}else if(this.audioTrack){o=this.audioTrack.timelineStartInfo.pts;Ht.forEach((function(e){s.info[e]=this.audioTrack[e]}),this)}if(this.videoTrack||this.audioTrack){if(1===this.pendingTracks.length)s.type=this.pendingTracks[0].type;else s.type="combined";this.emittedTracks+=this.pendingTracks.length;r=V.initSegment(this.pendingTracks);s.initSegment=new Uint8Array(r.byteLength);s.initSegment.set(r);s.data=new Uint8Array(this.pendingBytes);for(n=0;n<this.pendingBoxes.length;n++){s.data.set(this.pendingBoxes[n],a);a+=this.pendingBoxes[n].byteLength}for(n=0;n<this.pendingCaptions.length;n++){t=this.pendingCaptions[n];t.startTime=pe.metadataTsToSeconds(t.startPts,o,this.keepOriginalTimestamps);t.endTime=pe.metadataTsToSeconds(t.endPts,o,this.keepOriginalTimestamps);s.captionStreams[t.stream]=true;s.captions.push(t)}for(n=0;n<this.pendingMetadata.length;n++){i=this.pendingMetadata[n];i.cueTime=pe.metadataTsToSeconds(i.pts,o,this.keepOriginalTimestamps);s.metadata.push(i)}s.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",s);for(n=0;n<s.captions.length;n++){t=s.captions[n];this.trigger("caption",t)}for(n=0;n<s.metadata.length;n++){i=s.metadata[n];this.trigger("id3Frame",i)}}if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};Xt.prototype.setRemux=function(e){this.remuxTracks=e};Qt=function(e){var t,i,r=this,n=true;Qt.prototype.init.call(this);e=e||{};this.baseMediaDecodeTime=e.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var n={};this.transmuxPipeline_=n;n.type="aac";n.metadataStream=new mt.MetadataStream;n.aacStream=new Ft;n.audioTimestampRolloverStream=new mt.TimestampRolloverStream("audio");n.timedMetadataTimestampRolloverStream=new mt.TimestampRolloverStream("timed-metadata");n.adtsStream=new yt;n.coalesceStream=new Xt(e,n.metadataStream);n.headOfPipeline=n.aacStream;n.aacStream.pipe(n.audioTimestampRolloverStream).pipe(n.adtsStream);n.aacStream.pipe(n.timedMetadataTimestampRolloverStream).pipe(n.metadataStream).pipe(n.coalesceStream);n.metadataStream.on("timestamp",(function(e){n.aacStream.setTimestamp(e.timeStamp)}));n.aacStream.on("data",(function(a){if("timed-metadata"!==a.type&&"audio"!==a.type||n.audioSegmentStream)return;i=i||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"};n.coalesceStream.numberOfTracks++;n.audioSegmentStream=new Zt(i,e);n.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream"));n.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream);r.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!t})}));n.coalesceStream.on("data",this.trigger.bind(this,"data"));n.coalesceStream.on("done",this.trigger.bind(this,"done"));$t(this,n)};this.setupTsPipeline=function(){var n={};this.transmuxPipeline_=n;n.type="ts";n.metadataStream=new mt.MetadataStream;n.packetStream=new mt.TransportPacketStream;n.parseStream=new mt.TransportParseStream;n.elementaryStream=new mt.ElementaryStream;n.timestampRolloverStream=new mt.TimestampRolloverStream;n.adtsStream=new yt;n.h264Stream=new Wt;n.captionStream=new mt.CaptionStream(e);n.coalesceStream=new Xt(e,n.metadataStream);n.headOfPipeline=n.packetStream;n.packetStream.pipe(n.parseStream).pipe(n.elementaryStream).pipe(n.timestampRolloverStream);n.timestampRolloverStream.pipe(n.h264Stream);n.timestampRolloverStream.pipe(n.adtsStream);n.timestampRolloverStream.pipe(n.metadataStream).pipe(n.coalesceStream);n.h264Stream.pipe(n.captionStream).pipe(n.coalesceStream);n.elementaryStream.on("data",(function(a){var s;if("metadata"===a.type){s=a.tracks.length;while(s--)if(!t&&"video"===a.tracks[s].type){t=a.tracks[s];t.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}else if(!i&&"audio"===a.tracks[s].type){i=a.tracks[s];i.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}if(t&&!n.videoSegmentStream){n.coalesceStream.numberOfTracks++;n.videoSegmentStream=new Kt(t,e);n.videoSegmentStream.on("log",r.getLogTrigger_("videoSegmentStream"));n.videoSegmentStream.on("timelineStartInfo",(function(t){if(i&&!e.keepOriginalTimestamps){i.timelineStartInfo=t;n.audioSegmentStream.setEarliestDts(t.dts-r.baseMediaDecodeTime)}}));n.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo"));n.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo"));n.videoSegmentStream.on("baseMediaDecodeTime",(function(e){if(i)n.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}));n.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo"));n.h264Stream.pipe(n.videoSegmentStream).pipe(n.coalesceStream)}if(i&&!n.audioSegmentStream){n.coalesceStream.numberOfTracks++;n.audioSegmentStream=new Zt(i,e);n.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream"));n.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));n.audioSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"audioSegmentTimingInfo"));n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream)}r.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!t})}}));n.coalesceStream.on("data",this.trigger.bind(this,"data"));n.coalesceStream.on("id3Frame",(function(e){e.dispatchType=n.metadataStream.dispatchType;r.trigger("id3Frame",e)}));n.coalesceStream.on("caption",this.trigger.bind(this,"caption"));n.coalesceStream.on("done",this.trigger.bind(this,"done"));$t(this,n)};this.setBaseMediaDecodeTime=function(r){var n=this.transmuxPipeline_;if(!e.keepOriginalTimestamps)this.baseMediaDecodeTime=r;if(i){i.timelineStartInfo.dts=void 0;i.timelineStartInfo.pts=void 0;Ee.clearDtsInfo(i);if(n.audioTimestampRolloverStream)n.audioTimestampRolloverStream.discontinuity()}if(t){if(n.videoSegmentStream)n.videoSegmentStream.gopCache_=[];t.timelineStartInfo.dts=void 0;t.timelineStartInfo.pts=void 0;Ee.clearDtsInfo(t);n.captionStream.reset()}if(n.timestampRolloverStream)n.timestampRolloverStream.discontinuity()};this.setAudioAppendStart=function(e){if(i)this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)};this.setRemux=function(t){var i=this.transmuxPipeline_;e.remux=t;if(i&&i.coalesceStream)i.coalesceStream.setRemux(t)};this.alignGopsWith=function(e){if(t&&this.transmuxPipeline_.videoSegmentStream)this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)};this.getLogTrigger_=function(e){var t=this;return function(i){i.stream=e;t.trigger("log",i)}};this.push=function(e){if(n){var t=zt(e);if(t&&"aac"!==this.transmuxPipeline_.type)this.setupAacPipeline();else if(!t&&"ts"!==this.transmuxPipeline_.type)this.setupTsPipeline();n=false}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){n=true;this.transmuxPipeline_.headOfPipeline.flush()};this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()};this.reset=function(){if(this.transmuxPipeline_.headOfPipeline)this.transmuxPipeline_.headOfPipeline.reset()};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream)this.transmuxPipeline_.captionStream.reset()}};Qt.prototype=new t;var ti={Transmuxer:Qt,VideoSegmentStream:Kt,AudioSegmentStream:Zt,AUDIO_PROPERTIES:Ht,VIDEO_PROPERTIES:Vt,generateSegmentTimingInfo:ei};var ii=function(e){return e>>>0};var ri=function(e){return("00"+e.toString(16)).slice(-2)};var ni={toUnsigned:ii,toHexString:ri};var ai=function(e){var t="";t+=String.fromCharCode(e[0]);t+=String.fromCharCode(e[1]);t+=String.fromCharCode(e[2]);t+=String.fromCharCode(e[3]);return t};var si=ai;var oi=ni.toUnsigned;var ui=function e(t,i){var r,n,a,s,o,u=[];if(!i.length)return null;for(r=0;r<t.byteLength;){n=oi(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]);a=si(t.subarray(r+4,r+8));s=n>1?r+n:t.byteLength;if(a===i[0])if(1===i.length)u.push(t.subarray(r+8,s));else{o=e(t.subarray(r+8,s),i.slice(1));if(o.length)u=u.concat(o)}r=s}return u};var li=ui;var di=ni.toUnsigned;var ci=a.getUint64;var hi=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4))};if(1===t.version)t.baseMediaDecodeTime=ci(e.subarray(4));else t.baseMediaDecodeTime=di(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);return t};var fi=hi;var pi=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}};var mi=pi;var vi=function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=1&i.flags[2],a=4&i.flags[2],s=1&i.flags[1],o=2&i.flags[1],u=4&i.flags[1],l=8&i.flags[1],d=r.getUint32(4),c=8;if(n){i.dataOffset=r.getInt32(c);c+=4}if(a&&d){t={flags:mi(e.subarray(c,c+4))};c+=4;if(s){t.duration=r.getUint32(c);c+=4}if(o){t.size=r.getUint32(c);c+=4}if(l){if(1===i.version)t.compositionTimeOffset=r.getInt32(c);else t.compositionTimeOffset=r.getUint32(c);c+=4}i.samples.push(t);d--}while(d--){t={};if(s){t.duration=r.getUint32(c);c+=4}if(o){t.size=r.getUint32(c);c+=4}if(u){t.flags=mi(e.subarray(c,c+4));c+=4}if(l){if(1===i.version)t.compositionTimeOffset=r.getInt32(c);else t.compositionTimeOffset=r.getUint32(c);c+=4}i.samples.push(t)}return i};var gi=vi;var _i=function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},n=1&r.flags[2],a=2&r.flags[2],s=8&r.flags[2],o=16&r.flags[2],u=32&r.flags[2],l=65536&r.flags[0],d=131072&r.flags[0];t=8;if(n){t+=4;r.baseDataOffset=i.getUint32(12);t+=4}if(a){r.sampleDescriptionIndex=i.getUint32(t);t+=4}if(s){r.defaultSampleDuration=i.getUint32(t);t+=4}if(o){r.defaultSampleSize=i.getUint32(t);t+=4}if(u)r.defaultSampleFlags=i.getUint32(t);if(l)r.durationIsEmpty=true;if(!n&&d)r.baseDataOffsetIsMoof=true;return r};var yi=_i;var Ti="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof i.g?i.g:"undefined"!==typeof self?self:{};var bi;if("undefined"!==typeof window)bi=window;else if("undefined"!==typeof Ti)bi=Ti;else if("undefined"!==typeof self)bi=self;else bi={};var Si=bi;var ki=Oe.discardEmulationPreventionBytes;var Ci=Ge.CaptionStream;var Ei=function(e,t){var i=e;for(var r=0;r<t.length;r++){var n=t[r];if(i<n.size)return n;i-=n.size}return null};var wi=function(e,t,i){var r,n,a,s,o=new DataView(e.buffer,e.byteOffset,e.byteLength),u={logs:[],seiNals:[]};for(n=0;n+4<e.length;n+=a){a=o.getUint32(n);n+=4;if(a<=0)continue;switch(31&e[n]){case 6:var l=e.subarray(n+1,n+1+a);var d=Ei(n,t);r={nalUnitType:"sei_rbsp",size:a,data:l,escapedRBSP:ki(l),trackId:i};if(d){r.pts=d.pts;r.dts=d.dts;s=d}else if(s){r.pts=s.pts;r.dts=s.dts}else{u.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+n+" for trackId "+i+". See mux.js#223."});break}u.seiNals.push(r);break}}return u};var Ii=function(e,t,i){var r=t;var n=i.defaultSampleDuration||0;var a=i.defaultSampleSize||0;var s=i.trackId;var o=[];e.forEach((function(e){var t=gi(e);var i=t.samples;i.forEach((function(e){if(void 0===e.duration)e.duration=n;if(void 0===e.size)e.size=a;e.trackId=s;e.dts=r;if(void 0===e.compositionTimeOffset)e.compositionTimeOffset=0;if("bigint"===typeof r){e.pts=r+Si.BigInt(e.compositionTimeOffset);r+=Si.BigInt(e.duration)}else{e.pts=r+e.compositionTimeOffset;r+=e.duration}}));o=o.concat(i)}));return o};var xi=function(e,t){var i=li(e,["moof","traf"]);var r=li(e,["mdat"]);var n={};var a=[];r.forEach((function(e,t){var r=i[t];a.push({mdat:e,traf:r})}));a.forEach((function(e){var i=e.mdat;var r=e.traf;var a=li(r,["tfhd"]);var s=yi(a[0]);var o=s.trackId;var u=li(r,["tfdt"]);var l=u.length>0?fi(u[0]).baseMediaDecodeTime:0;var d=li(r,["trun"]);var c;var h;if(t===o&&d.length>0){c=Ii(d,l,s);h=wi(i,c,o);if(!n[o])n[o]={seiNals:[],logs:[]};n[o].seiNals=n[o].seiNals.concat(h.seiNals);n[o].logs=n[o].logs.concat(h.logs)}}));return n};var Pi=function(e,t,i){var r;if(null===t)return null;r=xi(e,t);var n=r[t]||{};return{seiNals:n.seiNals,logs:n.logs,timescale:i}};var Ai=function(){var e=false;var t;var i;var r;var n;var a;var s;this.isInitialized=function(){return e};this.init=function(i){t=new Ci;e=true;s=i?i.isPartial:false;t.on("data",(function(e){e.startTime=e.startPts/n;e.endTime=e.endPts/n;a.captions.push(e);a.captionStreams[e.stream]=true}));t.on("log",(function(e){a.logs.push(e)}))};this.isNewInit=function(e,t){if(e&&0===e.length||t&&"object"===typeof t&&0===Object.keys(t).length)return false;return r!==e[0]||n!==t[r]};this.parse=function(e,t,s){var o;if(!this.isInitialized())return null;else if(!t||!s)return null;else if(this.isNewInit(t,s)){r=t[0];n=s[r]}else if(null===r||!n){i.push(e);return null}while(i.length>0){var u=i.shift();this.parse(u,t,s)}o=Pi(e,r,n);if(o&&o.logs)a.logs=a.logs.concat(o.logs);if(null===o||!o.seiNals){if(a.logs.length)return{logs:a.logs,captions:[],captionStreams:[]};return null}this.pushNals(o.seiNals);this.flushStream();return a};this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length)return null;e.forEach((function(e){t.push(e)}))};this.flushStream=function(){if(!this.isInitialized())return null;if(!s)t.flush();else t.partialFlush()};this.clearParsedCaptions=function(){a.captions=[];a.captionStreams={};a.logs=[]};this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){i=[];r=null;n=null;if(!a)a={captions:[],captionStreams:{},logs:[]};else this.clearParsedCaptions();this.resetCaptionStream()};this.reset()};var Li=Ai;var Oi=ni.toUnsigned;var Di=ni.toHexString;var Mi=a.getUint64;var Ri,Ui,Bi,Ni,Fi,ji;Ri=function(e){var t={},i=li(e,["moov","trak"]);return i.reduce((function(e,t){var i,r,n,a,s;i=li(t,["tkhd"])[0];if(!i)return null;r=i[0];n=0===r?12:20;a=Oi(i[n]<<24|i[n+1]<<16|i[n+2]<<8|i[n+3]);s=li(t,["mdia","mdhd"])[0];if(!s)return null;r=s[0];n=0===r?12:20;e[a]=Oi(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]);return e}),t)};Ui=function(e,t){var i;i=li(t,["moof","traf"]);var r=i.reduce((function(t,i){var r=li(i,["tfhd"])[0];var n=Oi(r[4]<<24|r[5]<<16|r[6]<<8|r[7]);var a=e[n]||9e4;var s=li(i,["tfdt"])[0];var o=new DataView(s.buffer,s.byteOffset,s.byteLength);var u;if(1===s[0])u=Mi(s.subarray(4,12));else u=o.getUint32(4);var l;if("bigint"===typeof u)l=u/Si.BigInt(a);else if("number"===typeof u&&!isNaN(u))l=u/a;if(l<Number.MAX_SAFE_INTEGER)l=Number(l);if(l<t)t=l;return t}),1/0);return"bigint"===typeof r||isFinite(r)?r:0};Bi=function(e,t){var i=li(t,["moof","traf"]);var r=0;var n=0;var a;if(i&&i.length){var s=li(i[0],["tfhd"])[0];var o=li(i[0],["trun"])[0];var u=li(i[0],["tfdt"])[0];if(s){var l=yi(s);a=l.trackId}if(u){var d=fi(u);r=d.baseMediaDecodeTime}if(o){var c=gi(o);if(c.samples&&c.samples.length)n=c.samples[0].compositionTimeOffset||0}}var h=e[a]||9e4;if("bigint"===typeof r){n=Si.BigInt(n);h=Si.BigInt(h)}var f=(r+n)/h;if("bigint"===typeof f&&f<Number.MAX_SAFE_INTEGER)f=Number(f);return f};Ni=function(e){var t=li(e,["moov","trak"]);var i=[];t.forEach((function(e){var t=li(e,["mdia","hdlr"]);var r=li(e,["tkhd"]);t.forEach((function(e,t){var n=si(e.subarray(8,12));var a=r[t];var s;var o;var u;if("vide"===n){s=new DataView(a.buffer,a.byteOffset,a.byteLength);o=s.getUint8(0);u=0===o?s.getUint32(12):s.getUint32(20);i.push(u)}}))}));return i};ji=function(e){var t=e[0];var i=0===t?12:20;return Oi(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])};Fi=function(e){var t=li(e,["moov","trak"]);var i=[];t.forEach((function(e){var t={};var r=li(e,["tkhd"])[0];var n,a;if(r){n=new DataView(r.buffer,r.byteOffset,r.byteLength);a=n.getUint8(0);t.id=0===a?n.getUint32(12):n.getUint32(20)}var s=li(e,["mdia","hdlr"])[0];if(s){var o=si(s.subarray(8,12));if("vide"===o)t.type="video";else if("soun"===o)t.type="audio";else t.type=o}var u=li(e,["mdia","minf","stbl","stsd"])[0];if(u){var l=u.subarray(8);t.codec=si(l.subarray(4,8));var d=li(l,[t.codec])[0];var c,h;if(d)if(/^[asm]vc[1-9]$/i.test(t.codec)){c=d.subarray(78);h=si(c.subarray(4,8));if("avcC"===h&&c.length>11){t.codec+=".";t.codec+=Di(c[9]);t.codec+=Di(c[10]);t.codec+=Di(c[11])}else t.codec="avc1.4d400d"}else if(/^mp4[a,v]$/i.test(t.codec)){c=d.subarray(28);h=si(c.subarray(4,8));if("esds"===h&&c.length>20&&0!==c[19]){t.codec+="."+Di(c[19]);t.codec+="."+Di(c[20]>>>2&63).replace(/^0/,"")}else t.codec="mp4a.40.2"}else t.codec=t.codec.toLowerCase()}var f=li(e,["mdia","mdhd"])[0];if(f)t.timescale=ji(f);i.push(t)}));return i};var Hi={findBox:li,parseType:si,timescale:Ri,startTime:Ui,compositionStartTime:Bi,videoTrackIds:Ni,tracks:Fi,getTimescaleFromMediaHeader:ji};var qi=function(e){var t=31&e[1];t<<=8;t|=e[2];return t};var Vi=function(e){return!!(64&e[1])};var Wi=function(e){var t=0;if((48&e[3])>>>4>1)t+=e[4]+1;return t};var zi=function(e,t){var i=qi(e);if(0===i)return"pat";else if(i===t)return"pmt";else if(t)return"pes";return null};var Gi=function(e){var t=Vi(e);var i=4+Wi(e);if(t)i+=e[i]+1;return(31&e[i+10])<<8|e[i+11]};var Ki=function(e){var t={};var i=Vi(e);var r=4+Wi(e);if(i)r+=e[r]+1;if(!(1&e[r+5]))return;var n,a,s;n=(15&e[r+1])<<8|e[r+2];a=3+n-4;s=(15&e[r+10])<<8|e[r+11];var o=12+s;while(o<a){var u=r+o;t[(31&e[u+1])<<8|e[u+2]]=e[u];o+=((15&e[u+3])<<8|e[u+4])+5}return t};var Zi=function(e,t){var i=qi(e);var r=t[i];switch(r){case Ke.H264_STREAM_TYPE:return"video";case Ke.ADTS_STREAM_TYPE:return"audio";case Ke.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}};var Qi=function(e){var t=Vi(e);if(!t)return null;var i=4+Wi(e);if(i>=e.byteLength)return null;var r=null;var n;n=e[i+7];if(192&n){r={};r.pts=(14&e[i+9])<<27|(255&e[i+10])<<20|(254&e[i+11])<<12|(255&e[i+12])<<5|(254&e[i+13])>>>3;r.pts*=4;r.pts+=(6&e[i+13])>>>1;r.dts=r.pts;if(64&n){r.dts=(14&e[i+14])<<27|(255&e[i+15])<<20|(254&e[i+16])<<12|(255&e[i+17])<<5|(254&e[i+18])>>>3;r.dts*=4;r.dts+=(6&e[i+18])>>>1}}return r};var Xi=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};var Yi=function(e){var t=4+Wi(e);var i=e.subarray(t);var r=0;var n=0;var a=false;var s;for(;n<i.byteLength-3;n++)if(1===i[n+2]){r=n+5;break}while(r<i.byteLength)switch(i[r]){case 0:if(0!==i[r-1]){r+=2;break}else if(0!==i[r-2]){r++;break}if(n+3!==r-2){s=Xi(31&i[n+3]);if("slice_layer_without_partitioning_rbsp_idr"===s)a=true}do{r++}while(1!==i[r]&&r<i.length);n=r-2;r+=3;break;case 1:if(0!==i[r-1]||0!==i[r-2]){r+=3;break}s=Xi(31&i[n+3]);if("slice_layer_without_partitioning_rbsp_idr"===s)a=true;n=r-2;r+=3;break;default:r+=3;break}i=i.subarray(n);r-=n;n=0;if(i&&i.byteLength>3){s=Xi(31&i[n+3]);if("slice_layer_without_partitioning_rbsp_idr"===s)a=true}return a};var $i={parseType:zi,parsePat:Gi,parsePmt:Ki,parsePayloadUnitStartIndicator:Vi,parsePesType:Zi,parsePesTime:Qi,videoPacketContainsKeyFrame:Yi};var Ji=Je.handleRollover;var er={};er.ts=$i;er.aac=Bt;var tr=pe.ONE_SECOND_IN_TS;var ir=188,rr=71;var nr=function(e,t){var i,r,n=0,a=ir;while(a<e.byteLength){if(e[n]===rr&&e[a]===rr){i=e.subarray(n,a);r=er.ts.parseType(i,t.pid);switch(r){case"pat":t.pid=er.ts.parsePat(i);break;case"pmt":var s=er.ts.parsePmt(i);t.table=t.table||{};Object.keys(s).forEach((function(e){t.table[e]=s[e]}));break}n+=ir;a+=ir;continue}n++;a++}};var ar=function(e,t,i){var r,n,a,s,o,u=0,l=ir;var d=false;while(l<=e.byteLength){if(e[u]===rr&&(e[l]===rr||l===e.byteLength)){r=e.subarray(u,l);n=er.ts.parseType(r,t.pid);switch(n){case"pes":a=er.ts.parsePesType(r,t.table);s=er.ts.parsePayloadUnitStartIndicator(r);if("audio"===a&&s){o=er.ts.parsePesTime(r);if(o){o.type="audio";i.audio.push(o);d=true}}break}if(d)break;u+=ir;l+=ir;continue}u++;l++}l=e.byteLength;u=l-ir;d=false;while(u>=0){if(e[u]===rr&&(e[l]===rr||l===e.byteLength)){r=e.subarray(u,l);n=er.ts.parseType(r,t.pid);switch(n){case"pes":a=er.ts.parsePesType(r,t.table);s=er.ts.parsePayloadUnitStartIndicator(r);if("audio"===a&&s){o=er.ts.parsePesTime(r);if(o){o.type="audio";i.audio.push(o);d=true}}break}if(d)break;u-=ir;l-=ir;continue}u--;l--}};var sr=function(e,t,i){var r,n,a,s,o,u,l,d,c=0,h=ir;var f=false;var p={data:[],size:0};while(h<e.byteLength){if(e[c]===rr&&e[h]===rr){r=e.subarray(c,h);n=er.ts.parseType(r,t.pid);switch(n){case"pes":a=er.ts.parsePesType(r,t.table);s=er.ts.parsePayloadUnitStartIndicator(r);if("video"===a){if(s&&!f){o=er.ts.parsePesTime(r);if(o){o.type="video";i.video.push(o);f=true}}if(!i.firstKeyFrame){if(s)if(0!==p.size){u=new Uint8Array(p.size);l=0;while(p.data.length){d=p.data.shift();u.set(d,l);l+=d.byteLength}if(er.ts.videoPacketContainsKeyFrame(u)){var m=er.ts.parsePesTime(u);if(m){i.firstKeyFrame=m;i.firstKeyFrame.type="video"}else console.warn("Failed to extract PTS/DTS from PES at first keyframe. "+"This could be an unusual TS segment, or else mux.js did not "+"parse your TS segment correctly. If you know your TS "+"segments do contain PTS/DTS on keyframes please file a bug "+"report! You can try ffprobe to double check for yourself.")}p.size=0}p.data.push(r);p.size+=r.byteLength}}break}if(f&&i.firstKeyFrame)break;c+=ir;h+=ir;continue}c++;h++}h=e.byteLength;c=h-ir;f=false;while(c>=0){if(e[c]===rr&&e[h]===rr){r=e.subarray(c,h);n=er.ts.parseType(r,t.pid);switch(n){case"pes":a=er.ts.parsePesType(r,t.table);s=er.ts.parsePayloadUnitStartIndicator(r);if("video"===a&&s){o=er.ts.parsePesTime(r);if(o){o.type="video";i.video.push(o);f=true}}break}if(f)break;c-=ir;h-=ir;continue}c--;h--}};var or=function(e,t){if(e.audio&&e.audio.length){var i=t;if("undefined"===typeof i||isNaN(i))i=e.audio[0].dts;e.audio.forEach((function(e){e.dts=Ji(e.dts,i);e.pts=Ji(e.pts,i);e.dtsTime=e.dts/tr;e.ptsTime=e.pts/tr}))}if(e.video&&e.video.length){var r=t;if("undefined"===typeof r||isNaN(r))r=e.video[0].dts;e.video.forEach((function(e){e.dts=Ji(e.dts,r);e.pts=Ji(e.pts,r);e.dtsTime=e.dts/tr;e.ptsTime=e.pts/tr}));if(e.firstKeyFrame){var n=e.firstKeyFrame;n.dts=Ji(n.dts,r);n.pts=Ji(n.pts,r);n.dtsTime=n.dts/tr;n.ptsTime=n.pts/tr}}};var ur=function(e){var t,i=false,r=0,n=null,a=null,s=0,o=0;while(e.length-o>=3){var u=er.aac.parseType(e,o);switch(u){case"timed-metadata":if(e.length-o<10){i=true;break}s=er.aac.parseId3TagSize(e,o);if(s>e.length){i=true;break}if(null===a){t=e.subarray(o,o+s);a=er.aac.parseAacTimestamp(t)}o+=s;break;case"audio":if(e.length-o<7){i=true;break}s=er.aac.parseAdtsSize(e,o);if(s>e.length){i=true;break}if(null===n){t=e.subarray(o,o+s);n=er.aac.parseSampleRate(t)}r++;o+=s;break;default:o++;break}if(i)return null}if(null===n||null===a)return null;var l=tr/n;var d={audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*r*l,pts:a+1024*r*l}]};return d};var lr=function(e){var t={pid:null,table:null};var i={};nr(e,t);for(var r in t.table)if(t.table.hasOwnProperty(r)){var n=t.table[r];switch(n){case Ke.H264_STREAM_TYPE:i.video=[];sr(e,t,i);if(0===i.video.length)delete i.video;break;case Ke.ADTS_STREAM_TYPE:i.audio=[];ar(e,t,i);if(0===i.audio.length)delete i.audio;break}}return i};var dr=function(e,t){var i=er.aac.isLikelyAacData(e);var r;if(i)r=ur(e);else r=lr(e);if(!r||!r.audio&&!r.video)return null;or(r,t);return r};var cr={inspect:dr,parseAudioPes_:ar};var hr=function(e,t){t.on("data",(function(t){var i=t.initSegment;t.initSegment={data:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength};var r=t.data;t.data=r.buffer;e.postMessage({action:"data",segment:t,byteOffset:r.byteOffset,byteLength:r.byteLength},[t.data])}));t.on("done",(function(t){e.postMessage({action:"done"})}));t.on("gopInfo",(function(t){e.postMessage({action:"gopInfo",gopInfo:t})}));t.on("videoSegmentTimingInfo",(function(t){var i={start:{decode:pe.videoTsToSeconds(t.start.dts),presentation:pe.videoTsToSeconds(t.start.pts)},end:{decode:pe.videoTsToSeconds(t.end.dts),presentation:pe.videoTsToSeconds(t.end.pts)},baseMediaDecodeTime:pe.videoTsToSeconds(t.baseMediaDecodeTime)};if(t.prependedContentDuration)i.prependedContentDuration=pe.videoTsToSeconds(t.prependedContentDuration);e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:i})}));t.on("audioSegmentTimingInfo",(function(t){var i={start:{decode:pe.videoTsToSeconds(t.start.dts),presentation:pe.videoTsToSeconds(t.start.pts)},end:{decode:pe.videoTsToSeconds(t.end.dts),presentation:pe.videoTsToSeconds(t.end.pts)},baseMediaDecodeTime:pe.videoTsToSeconds(t.baseMediaDecodeTime)};if(t.prependedContentDuration)i.prependedContentDuration=pe.videoTsToSeconds(t.prependedContentDuration);e.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:i})}));t.on("id3Frame",(function(t){e.postMessage({action:"id3Frame",id3Frame:t})}));t.on("caption",(function(t){e.postMessage({action:"caption",caption:t})}));t.on("trackinfo",(function(t){e.postMessage({action:"trackinfo",trackInfo:t})}));t.on("audioTimingInfo",(function(t){e.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:pe.videoTsToSeconds(t.start),end:pe.videoTsToSeconds(t.end)}})}));t.on("videoTimingInfo",(function(t){e.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:pe.videoTsToSeconds(t.start),end:pe.videoTsToSeconds(t.end)}})}));t.on("log",(function(t){e.postMessage({action:"log",log:t})}))};var fr=function(){function e(e,t){this.options=t||{};this.self=e;this.init()}var t=e.prototype;t.init=function(){if(this.transmuxer)this.transmuxer.dispose();this.transmuxer=new ti.Transmuxer(this.options);hr(this.self,this.transmuxer)};t.pushMp4Captions=function(e){if(!this.captionParser){this.captionParser=new Li;this.captionParser.init()}var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);var i=this.captionParser.parse(t,e.trackIds,e.timescales);this.self.postMessage({action:"mp4Captions",captions:i&&i.captions||[],logs:i&&i.logs||[],data:t.buffer},[t.buffer])};t.probeMp4StartTime=function(e){var t=e.timescales,i=e.data;var r=Hi.startTime(t,i);this.self.postMessage({action:"probeMp4StartTime",startTime:r,data:i},[i.buffer])};t.probeMp4Tracks=function(e){var t=e.data;var i=Hi.tracks(t);this.self.postMessage({action:"probeMp4Tracks",tracks:i,data:t},[t.buffer])};t.probeTs=function(e){var t=e.data,i=e.baseStartTime;var r="number"===typeof i&&!isNaN(i)?i*pe.ONE_SECOND_IN_TS:void 0;var n=cr.inspect(t,r);var a=null;if(n){a={hasVideo:n.video&&2===n.video.length||false,hasAudio:n.audio&&2===n.audio.length||false};if(a.hasVideo)a.videoStart=n.video[0].ptsTime;if(a.hasAudio)a.audioStart=n.audio[0].ptsTime}this.self.postMessage({action:"probeTs",result:a,data:t},[t.buffer])};t.clearAllMp4Captions=function(){if(this.captionParser)this.captionParser.clearAllCaptions()};t.clearParsedMp4Captions=function(){if(this.captionParser)this.captionParser.clearParsedCaptions()};t.push=function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)};t.reset=function(){this.transmuxer.reset()};t.setTimestampOffset=function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(pe.secondsToVideoTs(t)))};t.setAudioAppendStart=function(e){this.transmuxer.setAudioAppendStart(Math.ceil(pe.secondsToVideoTs(e.appendStart)))};t.setRemux=function(e){this.transmuxer.setRemux(e.remux)};t.flush=function(e){this.transmuxer.flush();self.postMessage({action:"done",type:"transmuxed"})};t.endTimeline=function(){this.transmuxer.endTimeline();self.postMessage({action:"endedtimeline",type:"transmuxed"})};t.alignGopsWith=function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())};return e}();self.onmessage=function(e){if("init"===e.data.action&&e.data.options){this.messageHandlers=new fr(self,e.data.options);return}if(!this.messageHandlers)this.messageHandlers=new fr(self);if(e.data&&e.data.action&&"init"!==e.data.action)if(this.messageHandlers[e.data.action])this.messageHandlers[e.data.action](e.data)}})));var Mo=Ao(Do);var Ro=function(e,t,i){var r=e.data.segment,n=r.type,a=r.initSegment,s=r.captions,o=r.captionStreams,u=r.metadata,l=r.videoFrameDtsTime,d=r.videoFramePtsTime;t.buffer.push({captions:s,captionStreams:o,metadata:u});var c=e.data.segment.boxes||{data:e.data.segment.data};var h={type:n,data:new Uint8Array(c.data,c.data.byteOffset,c.data.byteLength),initSegment:new Uint8Array(a.data,a.byteOffset,a.byteLength)};if("undefined"!==typeof l)h.videoFrameDtsTime=l;if("undefined"!==typeof d)h.videoFramePtsTime=d;i(h)};var Uo=function(e){var t=e.transmuxedData,i=e.callback;t.buffer=[];i(t)};var Bo=function(e,t){t.gopInfo=e.data.gopInfo};var No=function(e){var t=e.transmuxer,i=e.bytes,r=e.audioAppendStart,n=e.gopsToAlignWith,a=e.remux,s=e.onData,o=e.onTrackInfo,u=e.onAudioTimingInfo,l=e.onVideoTimingInfo,d=e.onVideoSegmentTimingInfo,c=e.onAudioSegmentTimingInfo,h=e.onId3,f=e.onCaptions,p=e.onDone,m=e.onEndedTimeline,v=e.onTransmuxerLog,g=e.isEndOfTimeline;var _={buffer:[]};var y=g;var T=function(i){if(t.currentTransmux!==e)return;if("data"===i.data.action)Ro(i,_,s);if("trackinfo"===i.data.action)o(i.data.trackInfo);if("gopInfo"===i.data.action)Bo(i,_);if("audioTimingInfo"===i.data.action)u(i.data.audioTimingInfo);if("videoTimingInfo"===i.data.action)l(i.data.videoTimingInfo);if("videoSegmentTimingInfo"===i.data.action)d(i.data.videoSegmentTimingInfo);if("audioSegmentTimingInfo"===i.data.action)c(i.data.audioSegmentTimingInfo);if("id3Frame"===i.data.action)h([i.data.id3Frame],i.data.id3Frame.dispatchType);if("caption"===i.data.action)f(i.data.caption);if("endedtimeline"===i.data.action){y=false;m()}if("log"===i.data.action)v(i.data.log);if("transmuxed"!==i.data.type)return;if(y)return;t.onmessage=null;Uo({transmuxedData:_,callback:p});Fo(t)};t.onmessage=T;if(r)t.postMessage({action:"setAudioAppendStart",appendStart:r});if(Array.isArray(n))t.postMessage({action:"alignGopsWith",gopsToAlignWith:n});if("undefined"!==typeof a)t.postMessage({action:"setRemux",remux:a});if(i.byteLength){var b=i instanceof ArrayBuffer?i:i.buffer;var S=i instanceof ArrayBuffer?0:i.byteOffset;t.postMessage({action:"push",data:b,byteOffset:S,byteLength:i.byteLength},[b])}if(g)t.postMessage({action:"endTimeline"});t.postMessage({action:"flush"})};var Fo=function(e){e.currentTransmux=null;if(e.transmuxQueue.length){e.currentTransmux=e.transmuxQueue.shift();if("function"===typeof e.currentTransmux)e.currentTransmux();else No(e.currentTransmux)}};var jo=function(e,t){e.postMessage({action:t});Fo(e)};var Ho=function(e,t){if(!t.currentTransmux){t.currentTransmux=e;jo(t,e);return}t.transmuxQueue.push(jo.bind(null,t,e))};var qo=function(e){Ho("reset",e)};var Vo=function(e){Ho("endTimeline",e)};var Wo=function(e){if(!e.transmuxer.currentTransmux){e.transmuxer.currentTransmux=e;No(e);return}e.transmuxer.transmuxQueue.push(e)};var zo=function(e){var t=new Mo;t.currentTransmux=null;t.transmuxQueue=[];var i=t.terminate;t.terminate=function(){t.currentTransmux=null;t.transmuxQueue.length=0;return i.call(t)};t.postMessage({action:"init",options:e});return t};var Go={reset:qo,endTimeline:Vo,transmux:Wo,createTransmuxer:zo};var Ko=function(e){var t=e.transmuxer;var i=e.endAction||e.action;var r=e.callback;var n=(0,o.Z)({},e,{endAction:null,transmuxer:null,callback:null});var a=function n(a){if(a.data.action!==i)return;t.removeEventListener("message",n);if(a.data.data){a.data.data=new Uint8Array(a.data.data,e.byteOffset||0,e.byteLength||a.data.data.byteLength);if(e.data)e.data=a.data.data}r(a.data)};t.addEventListener("message",a);if(e.data){var s=e.data instanceof ArrayBuffer;n.byteOffset=s?0:e.data.byteOffset;n.byteLength=e.data.byteLength;var u=[s?e.data:e.data.buffer];t.postMessage(n,u)}else t.postMessage(n)};var Zo={FAILURE:2,TIMEOUT:-101,ABORTED:-102};var Qo=function(e){e.forEach((function(e){e.abort()}))};var Xo=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}};var Yo=function(e){var t=e.target;var i=Date.now()-t.requestTime;var r={bandwidth:1/0,bytesReceived:0,roundTripTime:i||0};r.bytesReceived=e.loaded;r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3);return r};var $o=function(e,t){if(t.timedout)return{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:Zo.TIMEOUT,xhr:t};if(t.aborted)return{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:Zo.ABORTED,xhr:t};if(e)return{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Zo.FAILURE,xhr:t};if("arraybuffer"===t.responseType&&0===t.response.byteLength)return{status:t.status,message:"Empty HLS response at URL: "+t.uri,code:Zo.FAILURE,xhr:t};return null};var Jo=function(e,t,i){return function(r,n){var a=n.response;var s=$o(r,n);if(s)return i(s,e);if(16!==a.byteLength)return i({status:n.status,message:"Invalid HLS key at URL: "+n.uri,code:Zo.FAILURE,xhr:n},e);var o=new DataView(a);var u=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]);for(var l=0;l<t.length;l++)t[l].bytes=u;return i(null,e)}};var eu=function(e,t){var i=(0,P.Xm)(e.map.bytes);if("mp4"!==i){var r=e.map.resolvedUri||e.map.uri;return t({internal:true,message:"Found unsupported "+(i||"unknown")+" container for initialization segment at URL: "+r,code:Zo.FAILURE})}Ko({action:"probeMp4Tracks",data:e.map.bytes,transmuxer:e.transmuxer,callback:function(i){var r=i.tracks,n=i.data;e.map.bytes=n;r.forEach((function(t){e.map.tracks=e.map.tracks||{};if(e.map.tracks[t.type])return;e.map.tracks[t.type]=t;if("number"===typeof t.id&&t.timescale){e.map.timescales=e.map.timescales||{};e.map.timescales[t.id]=t.timescale}}));return t(null)}})};var tu=function(e){var t=e.segment,i=e.finishProcessingFn;return function(e,r){var n=$o(e,r);if(n)return i(n,t);var a=new Uint8Array(r.response);if(t.map.key){t.map.encryptedBytes=a;return i(null,t)}t.map.bytes=a;eu(t,(function(e){if(e){e.xhr=r;e.status=r.status;return i(e,t)}i(null,t)}))}};var iu=function(e){var t=e.segment,i=e.finishProcessingFn,r=e.responseType;return function(e,n){var a=$o(e,n);if(a)return i(a,t);var s="arraybuffer"===r||!n.responseText?n.response:Io(n.responseText.substring(t.lastReachedChar||0));t.stats=Xo(n);if(t.key)t.encryptedBytes=new Uint8Array(s);else t.bytes=new Uint8Array(s);return i(null,t)}};var ru=function(e){var t=e.segment,i=e.bytes,r=e.trackInfoFn,n=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,s=e.audioSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,h=e.doneFn,f=e.onTransmuxerLog;var p=t.map&&t.map.tracks||{};var m=Boolean(p.audio&&p.video);var v=n.bind(null,t,"audio","start");var g=n.bind(null,t,"audio","end");var _=n.bind(null,t,"video","start");var y=n.bind(null,t,"video","end");var T=function(){return Wo({bytes:i,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,remux:m,onData:function(e){e.type="combined"===e.type?"video":e.type;c(t,e)},onTrackInfo:function(e){if(r){if(m)e.isMuxed=true;r(t,e)}},onAudioTimingInfo:function(e){if(v&&"undefined"!==typeof e.start){v(e.start);v=null}if(g&&"undefined"!==typeof e.end)g(e.end)},onVideoTimingInfo:function(e){if(_&&"undefined"!==typeof e.start){_(e.start);_=null}if(y&&"undefined"!==typeof e.end)y(e.end)},onVideoSegmentTimingInfo:function(e){a(e)},onAudioSegmentTimingInfo:function(e){s(e)},onId3:function(e,i){o(t,e,i)},onCaptions:function(e){u(t,[e])},isEndOfTimeline:l,onEndedTimeline:function(){d()},onTransmuxerLog:f,onDone:function(e){if(!h)return;e.type="combined"===e.type?"video":e.type;h(null,t,e)}})};Ko({action:"probeTs",transmuxer:t.transmuxer,data:i,baseStartTime:t.baseStartTime,callback:function(e){t.bytes=i=e.data;var n=e.result;if(n){r(t,{hasAudio:n.hasAudio,hasVideo:n.hasVideo,isMuxed:m});r=null;if(n.hasAudio&&!m)v(n.audioStart);if(n.hasVideo)_(n.videoStart);v=null;_=null}T()}})};var nu=function(e){var t=e.segment,i=e.bytes,r=e.trackInfoFn,n=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,s=e.audioSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,h=e.doneFn,f=e.onTransmuxerLog;var p=new Uint8Array(i);if((0,P.cz)(p)){t.isFmp4=true;var m=t.map.tracks;var v={isFmp4:true,hasVideo:!!m.video,hasAudio:!!m.audio};if(m.audio&&m.audio.codec&&"enca"!==m.audio.codec)v.audioCodec=m.audio.codec;if(m.video&&m.video.codec&&"encv"!==m.video.codec)v.videoCodec=m.video.codec;if(m.video&&m.audio)v.isMuxed=true;r(t,v);var g=function(e){c(t,{data:p,type:v.hasAudio&&!v.isMuxed?"audio":"video"});if(e&&e.length)u(t,e);h(null,t,{})};Ko({action:"probeMp4StartTime",timescales:t.map.timescales,data:p,transmuxer:t.transmuxer,callback:function(e){var r=e.data,a=e.startTime;i=r.buffer;t.bytes=p=r;if(v.hasAudio&&!v.isMuxed)n(t,"audio","start",a);if(v.hasVideo)n(t,"video","start",a);if(!m.video||!r.byteLength||!t.transmuxer){g();return}Ko({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:t.transmuxer,data:p,timescales:t.map.timescales,trackIds:[m.video.id],callback:function(e){i=e.data.buffer;t.bytes=p=e.data;e.logs.forEach((function(e){f(Oa.mergeOptions(e,{stream:"mp4CaptionParser"}))}));g(e.captions)}})}});return}if(!t.transmuxer){h(null,t,{});return}if("undefined"===typeof t.container)t.container=(0,P.Xm)(p);if("ts"!==t.container&&"aac"!==t.container){r(t,{hasAudio:false,hasVideo:false});h(null,t,{});return}ru({segment:t,bytes:i,trackInfoFn:r,timingInfoFn:n,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:h,onTransmuxerLog:f})};var au=function(e,t){var i=e.id,r=e.key,n=e.encryptedBytes,a=e.decryptionWorker;var s=function e(r){if(r.data.source===i){a.removeEventListener("message",e);var n=r.data.decrypted;t(new Uint8Array(n.bytes,n.byteOffset,n.byteLength))}};a.addEventListener("message",s);var o;if(r.bytes.slice)o=r.bytes.slice();else o=new Uint32Array(Array.prototype.slice.call(r.bytes));a.postMessage($s({source:i,encrypted:n,key:o,iv:r.iv}),[n.buffer,o.buffer])};var su=function(e){var t=e.decryptionWorker,i=e.segment,r=e.trackInfoFn,n=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,s=e.audioSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,h=e.doneFn,f=e.onTransmuxerLog;au({id:i.requestId,key:i.key,encryptedBytes:i.encryptedBytes,decryptionWorker:t},(function(e){i.bytes=e;nu({segment:i,bytes:i.bytes,trackInfoFn:r,timingInfoFn:n,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:h,onTransmuxerLog:f})}))};var ou=function(e){var t=e.activeXhrs,i=e.decryptionWorker,r=e.trackInfoFn,n=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,s=e.audioSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,h=e.doneFn,f=e.onTransmuxerLog;var p=0;var m=false;return function(e,v){if(m)return;if(e){m=true;Qo(t);return h(e,v)}p+=1;if(p===t.length){var g=function(){if(v.encryptedBytes)return su({decryptionWorker:i,segment:v,trackInfoFn:r,timingInfoFn:n,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:h,onTransmuxerLog:f});nu({segment:v,bytes:v.bytes,trackInfoFn:r,timingInfoFn:n,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:h,onTransmuxerLog:f})};v.endOfAllRequests=Date.now();if(v.map&&v.map.encryptedBytes&&!v.map.bytes)return au({decryptionWorker:i,id:v.requestId+"-init",encryptedBytes:v.map.encryptedBytes,key:v.map.key},(function(e){v.map.bytes=e;eu(v,(function(e){if(e){Qo(t);return h(e,v)}g()}))}));g()}}};var uu=function(e){var t=e.loadendState,i=e.abortFn;return function(e){var r=e.target;if(r.aborted&&i&&!t.calledAbortFn){i();t.calledAbortFn=true}}};var lu=function(e){var t=e.segment,i=e.progressFn;e.trackInfoFn;e.timingInfoFn;e.videoSegmentTimingInfoFn;e.audioSegmentTimingInfoFn;e.id3Fn;e.captionsFn;e.isEndOfTimeline;e.endedTimelineFn;e.dataFn;return function(e){var r=e.target;if(r.aborted)return;t.stats=Oa.mergeOptions(t.stats,Yo(e));if(!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived)t.stats.firstBytesReceivedAt=Date.now();return i(e,t)}};var du=function(e){var t=e.xhr,i=e.xhrOptions,r=e.decryptionWorker,n=e.segment,a=e.abortFn,s=e.progressFn,o=e.trackInfoFn,u=e.timingInfoFn,l=e.videoSegmentTimingInfoFn,d=e.audioSegmentTimingInfoFn,c=e.id3Fn,h=e.captionsFn,f=e.isEndOfTimeline,p=e.endedTimelineFn,m=e.dataFn,v=e.doneFn,g=e.onTransmuxerLog;var _=[];var y=ou({activeXhrs:_,decryptionWorker:r,trackInfoFn:o,timingInfoFn:u,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:c,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:p,dataFn:m,doneFn:v,onTransmuxerLog:g});if(n.key&&!n.key.bytes){var T=[n.key];if(n.map&&!n.map.bytes&&n.map.key&&n.map.key.resolvedUri===n.key.resolvedUri)T.push(n.map.key);var b=Oa.mergeOptions(i,{uri:n.key.resolvedUri,responseType:"arraybuffer"});var S=Jo(n,T,y);var k=t(b,S);_.push(k)}if(n.map&&!n.map.bytes){var C=n.map.key&&(!n.key||n.key.resolvedUri!==n.map.key.resolvedUri);if(C){var E=Oa.mergeOptions(i,{uri:n.map.key.resolvedUri,responseType:"arraybuffer"});var w=Jo(n,[n.map.key],y);var I=t(E,w);_.push(I)}var x=Oa.mergeOptions(i,{uri:n.map.resolvedUri,responseType:"arraybuffer",headers:Zs(n.map)});var P=tu({segment:n,finishProcessingFn:y});var A=t(x,P);_.push(A)}var L=Oa.mergeOptions(i,{uri:n.part&&n.part.resolvedUri||n.resolvedUri,responseType:"arraybuffer",headers:Zs(n)});var O=iu({segment:n,finishProcessingFn:y,responseType:L.responseType});var D=t(L,O);D.addEventListener("progress",lu({segment:n,progressFn:s,trackInfoFn:o,timingInfoFn:u,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:c,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:p,dataFn:m}));_.push(D);var M={};_.forEach((function(e){e.addEventListener("loadend",uu({loadendState:M,abortFn:a}))}));return function(){return Qo(_)}};var cu=Ba("CodecUtils");var hu=function(e){var t=e.attributes||{};if(t.CODECS)return(0,S.kS)(t.CODECS)};var fu=function(e,t){var i=t.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&i.AUDIO&&e.mediaGroups.AUDIO[i.AUDIO]};var pu=function(e,t){if(!fu(e,t))return true;var i=t.attributes||{};var r=e.mediaGroups.AUDIO[i.AUDIO];for(var n in r)if(!r[n].uri&&!r[n].playlists)return true;return false};var mu=function(e){var t={};e.forEach((function(e){var i=e.mediaType,r=e.type,n=e.details;t[i]=t[i]||[];t[i].push((0,S.ws)(""+r+n))}));Object.keys(t).forEach((function(e){if(t[e].length>1){cu("multiple "+e+" codecs found as attributes: "+t[e].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.");t[e]=null;return}t[e]=t[e][0]}));return t};var vu=function(e){var t=0;if(e.audio)t++;if(e.video)t++;return t};var gu=function(e,t){var i=t.attributes||{};var r=mu(hu(t)||[]);if(fu(e,t)&&!r.audio)if(!pu(e,t)){var n=mu((0,S.Jg)(e,i.AUDIO)||[]);if(n.audio)r.audio=n.audio}return r};var _u=Ba("PlaylistSelector");var yu=function(e){if(!e||!e.playlist)return;var t=e.playlist;return JSON.stringify({id:t.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:t.attributes&&t.attributes.CODECS||""})};var Tu=function(e,t){if(!e)return"";var i=n().getComputedStyle(e);if(!i)return"";return i[t]};var bu=function(e,t){var i=e.slice();e.sort((function(e,r){var n=t(e,r);if(0===n)return i.indexOf(e)-i.indexOf(r);return n}))};var Su=function(e,t){var i;var r;if(e.attributes.BANDWIDTH)i=e.attributes.BANDWIDTH;i=i||n().Number.MAX_VALUE;if(t.attributes.BANDWIDTH)r=t.attributes.BANDWIDTH;r=r||n().Number.MAX_VALUE;return i-r};var ku=function(e,t){var i;var r;if(e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width)i=e.attributes.RESOLUTION.width;i=i||n().Number.MAX_VALUE;if(t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width)r=t.attributes.RESOLUTION.width;r=r||n().Number.MAX_VALUE;if(i===r&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH)return e.attributes.BANDWIDTH-t.attributes.BANDWIDTH;return i-r};var Cu=function(e,t,i,r,a,s){if(!e)return;var o={bandwidth:t,width:i,height:r,limitRenditionByPlayerDimensions:a};var u=e.playlists;if(Ss.isAudioOnly(e)){u=s.getAudioTrackPlaylists_();o.audioOnly=true}var l=u.map((function(e){var t;var i=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width;var r=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;t=e.attributes&&e.attributes.BANDWIDTH;t=t||n().Number.MAX_VALUE;return{bandwidth:t,width:i,height:r,playlist:e}}));bu(l,(function(e,t){return e.bandwidth-t.bandwidth}));l=l.filter((function(e){return!Ss.isIncompatible(e.playlist)}));var d=l.filter((function(e){return Ss.isEnabled(e.playlist)}));if(!d.length)d=l.filter((function(e){return!Ss.isDisabled(e.playlist)}));var c=d.filter((function(e){return e.bandwidth*wo.BANDWIDTH_VARIANCE<t}));var h=c[c.length-1];var f=c.filter((function(e){return e.bandwidth===h.bandwidth}))[0];if(false===a){var p=f||d[0]||l[0];if(p&&p.playlist){var m="sortedPlaylistReps";if(f)m="bandwidthBestRep";if(d[0])m="enabledPlaylistReps";_u("choosing "+yu(p)+" using "+m+" with options",o);return p.playlist}_u("could not choose a playlist with options",o);return null}var v=c.filter((function(e){return e.width&&e.height}));bu(v,(function(e,t){return e.width-t.width}));var g=v.filter((function(e){return e.width===i&&e.height===r}));h=g[g.length-1];var _=g.filter((function(e){return e.bandwidth===h.bandwidth}))[0];var y;var T;var b;if(!_){y=v.filter((function(e){return e.width>i||e.height>r}));T=y.filter((function(e){return e.width===y[0].width&&e.height===y[0].height}));h=T[T.length-1];b=T.filter((function(e){return e.bandwidth===h.bandwidth}))[0]}var S;if(s.experimentalLeastPixelDiffSelector){var k=v.map((function(e){e.pixelDiff=Math.abs(e.width-i)+Math.abs(e.height-r);return e}));bu(k,(function(e,t){if(e.pixelDiff===t.pixelDiff)return t.bandwidth-e.bandwidth;return e.pixelDiff-t.pixelDiff}));S=k[0]}var C=S||b||_||f||d[0]||l[0];if(C&&C.playlist){var E="sortedPlaylistReps";if(S)E="leastPixelDiffRep";else if(b)E="resolutionPlusOneRep";else if(_)E="resolutionBestRep";else if(f)E="bandwidthBestRep";else if(d[0])E="enabledPlaylistReps";_u("choosing "+yu(C)+" using "+E+" with options",o);return C.playlist}_u("could not choose a playlist with options",o);return null};var Eu=function(){var e=this.useDevicePixelRatio?n().devicePixelRatio||1:1;return Cu(this.playlists.master,this.systemBandwidth,parseInt(Tu(this.tech_.el(),"width"),10)*e,parseInt(Tu(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)};var wu=function(e){var t=-1;var i=-1;if(e<0||e>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var r=this.useDevicePixelRatio?n().devicePixelRatio||1:1;if(t<0){t=this.systemBandwidth;i=this.systemBandwidth}if(this.systemBandwidth>0&&this.systemBandwidth!==i){t=e*this.systemBandwidth+(1-e)*t;i=this.systemBandwidth}return Cu(this.playlists.master,t,parseInt(Tu(this.tech_.el(),"width"),10)*r,parseInt(Tu(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}};var Iu=function(e){var t=e.master,i=e.currentTime,r=e.bandwidth,n=e.duration,a=e.segmentDuration,s=e.timeUntilRebuffer,o=e.currentTimeline,u=e.syncController;var l=t.playlists.filter((function(e){return!Ss.isIncompatible(e)}));var d=l.filter(Ss.isEnabled);if(!d.length)d=l.filter((function(e){return!Ss.isDisabled(e)}));var c=d.filter(Ss.hasAttribute.bind(null,"BANDWIDTH"));var h=c.map((function(e){var t=u.getSyncPoint(e,n,o,i);var l=t?1:2;var d=Ss.estimateSegmentRequestTime(a,r,e);var c=d*l-s;return{playlist:e,rebufferingImpact:c}}));var f=h.filter((function(e){return e.rebufferingImpact<=0}));bu(f,(function(e,t){return Su(t.playlist,e.playlist)}));if(f.length)return f[0];bu(h,(function(e,t){return e.rebufferingImpact-t.rebufferingImpact}));return h[0]||null};var xu=function(){var e=this;var t=this.playlists.master.playlists.filter(Ss.isEnabled);bu(t,(function(e,t){return Su(e,t)}));var i=t.filter((function(t){return!!gu(e.playlists.master,t).video}));return i[0]||null};var Pu=function(e){var t=0;var i;if(e.bytes){i=new Uint8Array(e.bytes);e.segments.forEach((function(e){i.set(e,t);t+=e.byteLength}))}return i};var Au=function(e,t,i){if(!e[i]){t.trigger({type:"usage",name:"vhs-608"});t.trigger({type:"usage",name:"hls-608"});var r=i;if(/^cc708_/.test(i))r="SERVICE"+i.split("_")[1];var n=t.textTracks().getTrackById(r);if(n)e[i]=n;else{var a=t.options_.vhs&&t.options_.vhs.captionServices||{};var s=i;var o=i;var u=false;var l=a[r];if(l){s=l.label;o=l.language;u=l["default"]}e[i]=t.addRemoteTextTrack({kind:"captions",id:r,default:u,label:s,language:o},false).track}}};var Lu=function(e){var t=e.inbandTextTracks,i=e.captionArray,r=e.timestampOffset;if(!i)return;var a=n().WebKitDataCue||n().VTTCue;i.forEach((function(e){var i=e.stream;t[i].addCue(new a(e.startTime+r,e.endTime+r,e.text))}))};var Ou=function(e){Object.defineProperties(e.frame,{id:{get:function(){Oa.log.warn("cue.frame.id is deprecated. Use cue.value.key instead.");return e.value.key}},value:{get:function(){Oa.log.warn("cue.frame.value is deprecated. Use cue.value.data instead.");return e.value.data}},privateData:{get:function(){Oa.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead.");return e.value.data}}})};var Du=function(e){var t=e.inbandTextTracks,i=e.metadataArray,r=e.timestampOffset,a=e.videoDuration;if(!i)return;var s=n().WebKitDataCue||n().VTTCue;var o=t.metadataTrack_;if(!o)return;i.forEach((function(e){var t=e.cueTime+r;if("number"!==typeof t||n().isNaN(t)||t<0||!(t<1/0))return;e.frames.forEach((function(e){var i=new s(t,t,e.value||e.url||e.data||"");i.frame=e;i.value=e;Ou(i);o.addCue(i)}))}));if(!o.cues||!o.cues.length)return;var u=o.cues;var l=[];for(var d=0;d<u.length;d++)if(u[d])l.push(u[d]);var c=l.reduce((function(e,t){var i=e[t.startTime]||[];i.push(t);e[t.startTime]=i;return e}),{});var h=Object.keys(c).sort((function(e,t){return Number(e)-Number(t)}));h.forEach((function(e,t){var i=c[e];var r=Number(h[t+1])||a;i.forEach((function(e){e.endTime=r}))}))};var Mu=function(e,t,i){if(e.metadataTrack_)return;e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},false).track;e.metadataTrack_.inBandMetadataTrackDispatchType=t};var Ru=function(e,t,i){var r;var n;if(!i)return;if(!i.cues)return;r=i.cues.length;while(r--){n=i.cues[r];if(n.startTime>=e&&n.endTime<=t)i.removeCue(n)}};var Uu=function(e){var t=e.cues;if(!t)return;for(var i=0;i<t.length;i++){var r=[];var n=0;for(var a=0;a<t.length;a++)if(t[i].startTime===t[a].startTime&&t[i].endTime===t[a].endTime&&t[i].text===t[a].text){n++;if(n>1)r.push(t[a])}if(r.length)r.forEach((function(t){return e.removeCue(t)}))}};var Bu=function(e,t,i){if("undefined"===typeof t||null===t||!e.length)return[];var r=Math.ceil((t-i+3)*A.ONE_SECOND_IN_TS);var n;for(n=0;n<e.length;n++)if(e[n].pts>r)break;return e.slice(n)};var Nu=function(e,t,i){if(!t.length)return e;if(i)return t.slice();var r=t[0].pts;var n=0;for(n;n<e.length;n++)if(e[n].pts>=r)break;return e.slice(0,n).concat(t)};var Fu=function(e,t,i,r){var n=Math.ceil((t-r)*A.ONE_SECOND_IN_TS);var a=Math.ceil((i-r)*A.ONE_SECOND_IN_TS);var s=e.slice();var o=e.length;while(o--)if(e[o].pts<=a)break;if(-1===o)return s;var u=o+1;while(u--)if(e[u].pts<=n)break;u=Math.max(u,0);s.splice(u,o-u+1);return s};var ju=function(e,t){if(!e&&!t||!e&&t||e&&!t)return false;if(e===t)return true;var i=Object.keys(e).sort();var r=Object.keys(t).sort();if(i.length!==r.length)return false;for(var n=0;n<i.length;n++){var a=i[n];if(a!==r[n])return false;if(e[a]!==t[a])return false}return true};var Hu=22;var qu=function(e,t,i){t=t||[];var r=[];var n=0;for(var a=0;a<t.length;a++){var s=t[a];if(e===s.timeline){r.push(a);n+=s.duration;if(n>i)return a}}if(0===r.length)return 0;return r[r.length-1]};var Vu=1;var Wu=500;var zu=function(e){return"number"===typeof e&&isFinite(e)};var Gu=1/60;var Ku=function(e,t,i){if("main"!==e||!t||!i)return null;if(!i.hasAudio&&!i.hasVideo)return"Neither audio nor video found in segment.";if(t.hasVideo&&!i.hasVideo)return"Only audio found in segment when we expected video."+" We can't switch to audio only from a stream that had video."+" To get rid of this message, please add codec information to the manifest.";if(!t.hasVideo&&i.hasVideo)return"Video found in segment when we expected only audio."+" We can't switch to a stream with video from an audio only stream."+" To get rid of this message, please add codec information to the manifest.";return null};var Zu=function(e,t,i){var r=t-wo.BACK_BUFFER_LENGTH;if(e.length)r=Math.max(r,e.start(0));var n=t-i;return Math.min(n,r)};var Qu=function(e){var t=e.startOfSegment,i=e.duration,r=e.segment,n=e.part,a=e.playlist,s=a.mediaSequence,o=a.id,u=a.segments,l=void 0===u?[]:u,d=e.mediaIndex,c=e.partIndex,h=e.timeline;var f=l.length-1;var p="mediaIndex/partIndex increment";if(e.getMediaInfoForTime)p="getMediaInfoForTime ("+e.getMediaInfoForTime+")";else if(e.isSyncRequest)p="getSyncSegmentCandidate (isSyncRequest)";if(e.independent)p+=" with independent "+e.independent;var m="number"===typeof c;var v=e.segment.uri?"segment":"pre-segment";var g=m?ts({preloadSegment:r})-1:0;return v+" ["+(s+d)+"/"+(s+f)+"]"+(m?" part ["+c+"/"+g+"]":"")+" segment start/end ["+r.start+" => "+r.end+"]"+(m?" part start/end ["+n.start+" => "+n.end+"]":"")+" startOfSegment ["+t+"]"+" duration ["+i+"]"+" timeline ["+h+"]"+" selected by ["+p+"]"+" playlist ["+o+"]"};var Xu=function(e){return e+"TimingInfo"};var Yu=function(e){var t=e.segmentTimeline,i=e.currentTimeline,r=e.startOfSegment,n=e.buffered,a=e.overrideCheck;if(!a&&t===i)return null;if(t<i)return r;return n.length?n.end(n.length-1):r};var $u=function(e){var t=e.timelineChangeController,i=e.currentTimeline,r=e.segmentTimeline,n=e.loaderType,a=e.audioDisabled;if(i===r)return false;if("audio"===n){var s=t.lastTimelineChange({type:"main"});return!s||s.to!==r}if("main"===n&&a){var o=t.pendingTimelineChange({type:"audio"});if(o&&o.to===r)return false;return true}return false};var Ju=function(e){var t=0;["video","audio"].forEach((function(i){var r=e[i+"TimingInfo"];if(!r)return;var a=r.start,s=r.end;var o;if("bigint"===typeof a||"bigint"===typeof s)o=n().BigInt(s)-n().BigInt(a);else if("number"===typeof a&&"number"===typeof s)o=s-a;if("undefined"!==typeof o&&o>t)t=o}));if("bigint"===typeof t&&t<Number.MAX_SAFE_INTEGER)t=Number(t);return t};var el=function(e){var t=e.segmentDuration,i=e.maxDuration;if(!t)return false;return Math.round(t)>i+Na};var tl=function(e,t){if("hls"!==t)return null;var i=Ju({audioTimingInfo:e.audioTimingInfo,videoTimingInfo:e.videoTimingInfo});if(!i)return null;var r=e.playlist.targetDuration;var n=el({segmentDuration:i,maxDuration:2*r});var a=el({segmentDuration:i,maxDuration:r});var s="Segment with index "+e.mediaIndex+" "+"from playlist "+e.playlist.id+" "+"has a duration of "+i+" "+"when the reported duration is "+e.duration+" "+"and the target duration is "+r+". "+"For HLS content, a duration in excess of the target duration may result in "+"playback issues. See the HLS specification section on EXT-X-TARGETDURATION for "+"more details: "+"https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";if(n||a)return{severity:n?"warn":"info",message:s};return null};var il=function(e){(0,c.Z)(t,e);function t(t,i){var r;r=e.call(this)||this;if(!t)throw new TypeError("Initialization settings are required");if("function"!==typeof t.currentTime)throw new TypeError("No currentTime getter specified");if(!t.mediaSource)throw new TypeError("No MediaSource specified");r.bandwidth=t.bandwidth;r.throughput={rate:0,count:0};r.roundTrip=NaN;r.resetStats_();r.mediaIndex=null;r.partIndex=null;r.hasPlayed_=t.hasPlayed;r.currentTime_=t.currentTime;r.seekable_=t.seekable;r.seeking_=t.seeking;r.duration_=t.duration;r.mediaSource_=t.mediaSource;r.vhs_=t.vhs;r.loaderType_=t.loaderType;r.currentMediaInfo_=void 0;r.startingMediaInfo_=void 0;r.segmentMetadataTrack_=t.segmentMetadataTrack;r.goalBufferLength_=t.goalBufferLength;r.sourceType_=t.sourceType;r.sourceUpdater_=t.sourceUpdater;r.inbandTextTracks_=t.inbandTextTracks;r.state_="INIT";r.timelineChangeController_=t.timelineChangeController;r.shouldSaveSegmentTimingInfo_=true;r.parse708captions_=t.parse708captions;r.useDtsForTimestampOffset_=t.useDtsForTimestampOffset;r.captionServices_=t.captionServices;r.experimentalExactManifestTimings=t.experimentalExactManifestTimings;r.checkBufferTimeout_=null;r.error_=void 0;r.currentTimeline_=-1;r.pendingSegment_=null;r.xhrOptions_=null;r.pendingSegments_=[];r.audioDisabled_=false;r.isPendingTimestampOffset_=false;r.gopBuffer_=[];r.timeMapping_=0;r.safeAppend_=Oa.browser.IE_VERSION>=11;r.appendInitSegment_={audio:true,video:true};r.playlistOfLastInitSegment_={audio:null,video:null};r.callQueue_=[];r.loadQueue_=[];r.metadataQueue_={id3:[],caption:[]};r.waitingOnRemove_=false;r.quotaExceededErrorRetryTimeout_=null;r.activeInitSegmentId_=null;r.initSegments_={};r.cacheEncryptionKeys_=t.cacheEncryptionKeys;r.keyCache_={};r.decrypter_=t.decrypter;r.syncController_=t.syncController;r.syncPoint_={segmentIndex:0,time:0};r.transmuxer_=r.createTransmuxer_();r.triggerSyncInfoUpdate_=function(){return r.trigger("syncinfoupdate")};r.syncController_.on("syncinfoupdate",r.triggerSyncInfoUpdate_);r.mediaSource_.addEventListener("sourceopen",(function(){if(!r.isEndOfStream_())r.ended_=false}));r.fetchAtBuffer_=false;r.logger_=Ba("SegmentLoader["+r.loaderType_+"]");Object.defineProperty((0,d.Z)(r),"state",{get:function(){return this.state_},set:function(e){if(e!==this.state_){this.logger_(this.state_+" -> "+e);this.state_=e;this.trigger("statechange")}}});r.sourceUpdater_.on("ready",(function(){if(r.hasEnoughInfoToAppend_())r.processCallQueue_()}));if("main"===r.loaderType_)r.timelineChangeController_.on("pendingtimelinechange",(function(){if(r.hasEnoughInfoToAppend_())r.processCallQueue_()}));if("audio"===r.loaderType_)r.timelineChangeController_.on("timelinechange",(function(){if(r.hasEnoughInfoToLoad_())r.processLoadQueue_();if(r.hasEnoughInfoToAppend_())r.processCallQueue_()}));return r}var i=t.prototype;i.createTransmuxer_=function(){return Go.createTransmuxer({remux:false,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:true,parse708captions:this.parse708captions_,captionServices:this.captionServices_})};i.resetStats_=function(){this.mediaBytesTransferred=0;this.mediaRequests=0;this.mediaRequestsAborted=0;this.mediaRequestsTimedout=0;this.mediaRequestsErrored=0;this.mediaTransferDuration=0;this.mediaSecondsLoaded=0;this.mediaAppends=0};i.dispose=function(){this.trigger("dispose");this.state="DISPOSED";this.pause();this.abort_();if(this.transmuxer_)this.transmuxer_.terminate();this.resetStats_();if(this.checkBufferTimeout_)n().clearTimeout(this.checkBufferTimeout_);if(this.syncController_&&this.triggerSyncInfoUpdate_)this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_);this.off()};i.setAudio=function(e){this.audioDisabled_=!e;if(e)this.appendInitSegment_.audio=true;else this.sourceUpdater_.removeAudio(0,this.duration_())};i.abort=function(){if("WAITING"!==this.state){if(this.pendingSegment_)this.pendingSegment_=null;return}this.abort_();this.state="READY";if(!this.paused())this.monitorBuffer_()};i.abort_=function(){if(this.pendingSegment_&&this.pendingSegment_.abortRequests)this.pendingSegment_.abortRequests();this.pendingSegment_=null;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);this.waitingOnRemove_=false;n().clearTimeout(this.quotaExceededErrorRetryTimeout_);this.quotaExceededErrorRetryTimeout_=null};i.checkForAbort_=function(e){if("APPENDING"===this.state&&!this.pendingSegment_){this.state="READY";return true}if(!this.pendingSegment_||this.pendingSegment_.requestId!==e)return true;return false};i.error=function(e){if("undefined"!==typeof e){this.logger_("error occurred:",e);this.error_=e}this.pendingSegment_=null;return this.error_};i.endOfStream=function(){this.ended_=true;if(this.transmuxer_)Go.reset(this.transmuxer_);this.gopBuffer_.length=0;this.pause();this.trigger("ended")};i.buffered_=function(){var e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return Oa.createTimeRanges();if("main"===this.loaderType_){var t=e.hasAudio,i=e.hasVideo,r=e.isMuxed;if(i&&t&&!this.audioDisabled_&&!r)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()};i.initSegmentForMap=function(e,t){if(void 0===t)t=false;if(!e)return null;var i=Js(e);var r=this.initSegments_[i];if(t&&!r&&e.bytes)this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales};return r||e};i.segmentKey=function(e,t){if(void 0===t)t=false;if(!e)return null;var i=eo(e);var r=this.keyCache_[i];if(this.cacheEncryptionKeys_&&t&&!r&&e.bytes)this.keyCache_[i]=r={resolvedUri:e.resolvedUri,bytes:e.bytes};var n={resolvedUri:(r||e).resolvedUri};if(r)n.bytes=r.bytes;return n};i.couldBeginLoading_=function(){return this.playlist_&&!this.paused()};i.load=function(){this.monitorBuffer_();if(!this.playlist_)return;if("INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state)return;this.state="READY"};i.init_=function(){this.state="READY";this.resetEverything();return this.monitorBuffer_()};i.playlist=function(e,t){if(void 0===t)t={};if(!e)return;var i=this.playlist_;var r=this.pendingSegment_;this.playlist_=e;this.xhrOptions_=t;if("INIT"===this.state){e.syncInfo={mediaSequence:e.mediaSequence,time:0};if("main"===this.loaderType_)this.syncController_.setDateTimeMappingForStart(e)}var n=null;if(i)if(i.id)n=i.id;else if(i.uri)n=i.uri;this.logger_("playlist update ["+n+" => "+(e.id||e.uri)+"]");this.trigger("syncinfoupdate");if("INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==e.uri){if(null!==this.mediaIndex)if(!e.endList)this.resetLoader();else this.resyncLoader();this.currentMediaInfo_=void 0;this.trigger("playlistupdate");return}var a=e.mediaSequence-i.mediaSequence;this.logger_("live window shift ["+a+"]");if(null!==this.mediaIndex){this.mediaIndex-=a;if(this.mediaIndex<0){this.mediaIndex=null;this.partIndex=null}else{var s=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!s.parts||!s.parts.length||!s.parts[this.partIndex])){var o=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists.");this.resetLoader();this.mediaIndex=o}}}if(r){r.mediaIndex-=a;if(r.mediaIndex<0){r.mediaIndex=null;r.partIndex=null}else{if(r.mediaIndex>=0)r.segment=e.segments[r.mediaIndex];if(r.partIndex>=0&&r.segment.parts)r.part=r.segment.parts[r.partIndex]}}this.syncController_.saveExpiredSegmentInfo(i,e)};i.pause=function(){if(this.checkBufferTimeout_){n().clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=null}};i.paused=function(){return null===this.checkBufferTimeout_};i.resetEverything=function(e){this.ended_=false;this.appendInitSegment_={audio:true,video:true};this.resetLoader();this.remove(0,1/0,e);if(this.transmuxer_){this.transmuxer_.postMessage({action:"clearAllMp4Captions"});this.transmuxer_.postMessage({action:"reset"})}};i.resetLoader=function(){this.fetchAtBuffer_=false;this.resyncLoader()};i.resyncLoader=function(){if(this.transmuxer_)Go.reset(this.transmuxer_);this.mediaIndex=null;this.partIndex=null;this.syncPoint_=null;this.isPendingTimestampOffset_=false;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.abort();if(this.transmuxer_)this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})};i.remove=function(e,t,i,r){if(void 0===i)i=function(){};if(void 0===r)r=false;if(t===1/0)t=this.duration_();if(t<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}var n=1;var a=function(){n--;if(0===n)i()};if(r||!this.audioDisabled_){n++;this.sourceUpdater_.removeAudio(e,t,a)}if(r||"main"===this.loaderType_){this.gopBuffer_=Fu(this.gopBuffer_,e,t,this.timeMapping_);n++;this.sourceUpdater_.removeVideo(e,t,a)}for(var s in this.inbandTextTracks_)Ru(e,t,this.inbandTextTracks_[s]);Ru(e,t,this.segmentMetadataTrack_);a()};i.monitorBuffer_=function(){if(this.checkBufferTimeout_)n().clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=n().setTimeout(this.monitorBufferTick_.bind(this),1)};i.monitorBufferTick_=function(){if("READY"===this.state)this.fillBuffer_();if(this.checkBufferTimeout_)n().clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=n().setTimeout(this.monitorBufferTick_.bind(this),Wu)};i.fillBuffer_=function(){if(this.sourceUpdater_.updating())return;var e=this.chooseNextRequest_();if(!e)return;if("number"===typeof e.timestampOffset){this.isPendingTimestampOffset_=false;this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})}this.loadSegment_(e)};i.isEndOfStream_=function(e,t,i){if(void 0===e)e=this.mediaIndex;if(void 0===t)t=this.playlist_;if(void 0===i)i=this.partIndex;if(!t||!this.mediaSource_)return false;var r="number"===typeof e&&t.segments[e];var n=e+1===t.segments.length;var a=!r||!r.parts||i+1===r.parts.length;return t.endList&&"open"===this.mediaSource_.readyState&&n&&a};i.chooseNextRequest_=function(){var e=this.buffered_();var t=Qa(e)||0;var i=Xa(e,this.currentTime_());var r=!this.hasPlayed_()&&i>=1;var n=i>=this.goalBufferLength_();var a=this.playlist_.segments;if(!a.length||r||n)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var s={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(s.isSyncRequest)s.mediaIndex=qu(this.currentTimeline_,a,t);else if(null!==this.mediaIndex){var o=a[this.mediaIndex];var u="number"===typeof this.partIndex?this.partIndex:-1;s.startOfSegment=o.end?o.end:t;if(o.parts&&o.parts[u+1]){s.mediaIndex=this.mediaIndex;s.partIndex=u+1}else s.mediaIndex=this.mediaIndex+1}else{var l=Ss.getMediaInfoForTime({experimentalExactManifestTimings:this.experimentalExactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?t:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),d=l.segmentIndex,c=l.startTime,h=l.partIndex;s.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+t:"currentTime "+this.currentTime_();s.mediaIndex=d;s.startOfSegment=c;s.partIndex=h}var f=a[s.mediaIndex];var p=f&&"number"===typeof s.partIndex&&f.parts&&f.parts[s.partIndex];if(!f||"number"===typeof s.partIndex&&!p)return null;if("number"!==typeof s.partIndex&&f.parts){s.partIndex=0;p=f.parts[0]}if(!i&&p&&!p.independent)if(0===s.partIndex){var m=a[s.mediaIndex-1];var v=m.parts&&m.parts.length&&m.parts[m.parts.length-1];if(v&&v.independent){s.mediaIndex-=1;s.partIndex=m.parts.length-1;s.independent="previous segment"}}else if(f.parts[s.partIndex-1].independent){s.partIndex-=1;s.independent="previous part"}var g=this.mediaSource_&&"ended"===this.mediaSource_.readyState;if(s.mediaIndex>=a.length-1&&g&&!this.seeking_())return null;return this.generateSegmentInfo_(s)};i.generateSegmentInfo_=function(e){var t=e.independent,i=e.playlist,r=e.mediaIndex,n=e.startOfSegment,a=e.isSyncRequest,s=e.partIndex,o=e.forceTimestampOffset,u=e.getMediaInfoForTime;var l=i.segments[r];var d="number"===typeof s&&l.parts[s];var c={requestId:"segment-loader-"+Math.random(),uri:d&&d.resolvedUri||l.resolvedUri,mediaIndex:r,partIndex:d?s:null,isSyncRequest:a,startOfSegment:n,playlist:i,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:l.timeline,duration:d&&d.duration||l.duration,segment:l,part:d,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:u,independent:t};var h="undefined"!==typeof o?o:this.isPendingTimestampOffset_;c.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:l.timeline,currentTimeline:this.currentTimeline_,startOfSegment:n,buffered:this.buffered_(),overrideCheck:h});var f=Qa(this.sourceUpdater_.audioBuffered());if("number"===typeof f)c.audioAppendStart=f-this.sourceUpdater_.audioTimestampOffset();if(this.sourceUpdater_.videoBuffered().length)c.gopsToAlignWith=Bu(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_);return c};i.timestampOffsetForSegment_=function(e){return Yu(e)};i.earlyAbortWhenNeeded_=function(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;var t=this.currentTime_();var i=e.bandwidth;var r=this.pendingSegment_.duration;var n=Ss.estimateSegmentRequestTime(r,i,this.playlist_,e.bytesReceived);var a=Ga(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(n<=a)return;var s=Iu({master:this.vhs_.playlists.master,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!s)return;var o=n-a;var u=o-s.rebufferingImpact;var l=.5;if(a<=Na)l=1;if(!s.playlist||s.playlist.uri===this.playlist_.uri||u<l)return;this.bandwidth=s.playlist.attributes.BANDWIDTH*wo.BANDWIDTH_VARIANCE+1;this.trigger("earlyabort")};i.handleAbort_=function(e){this.logger_("Aborting "+Qu(e));this.mediaRequestsAborted+=1};i.handleProgress_=function(e,t){this.earlyAbortWhenNeeded_(t.stats);if(this.checkForAbort_(t.requestId))return;this.trigger("progress")};i.handleTrackInfo_=function(e,t){this.earlyAbortWhenNeeded_(e.stats);if(this.checkForAbort_(e.requestId))return;if(this.checkForIllegalMediaSwitch(t))return;t=t||{};if(!ju(this.currentMediaInfo_,t)){this.appendInitSegment_={audio:true,video:true};this.startingMediaInfo_=t;this.currentMediaInfo_=t;this.logger_("trackinfo update",t);this.trigger("trackinfo")}if(this.checkForAbort_(e.requestId))return;this.pendingSegment_.trackInfo=t;if(this.hasEnoughInfoToAppend_())this.processCallQueue_()};i.handleTimingInfo_=function(e,t,i,r){this.earlyAbortWhenNeeded_(e.stats);if(this.checkForAbort_(e.requestId))return;var n=this.pendingSegment_;var a=Xu(t);n[a]=n[a]||{};n[a][i]=r;this.logger_("timinginfo: "+t+" - "+i+" - "+r);if(this.hasEnoughInfoToAppend_())this.processCallQueue_()};i.handleCaptions_=function(e,t){var i=this;this.earlyAbortWhenNeeded_(e.stats);if(this.checkForAbort_(e.requestId))return;if(0===t.length){this.logger_("SegmentLoader received no captions from a caption event");return}var r=this.pendingSegment_;if(!r.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));return}var n=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();var a={};t.forEach((function(e){a[e.stream]=a[e.stream]||{startTime:1/0,captions:[],endTime:0};var t=a[e.stream];t.startTime=Math.min(t.startTime,e.startTime+n);t.endTime=Math.max(t.endTime,e.endTime+n);t.captions.push(e)}));Object.keys(a).forEach((function(e){var t=a[e],r=t.startTime,s=t.endTime,o=t.captions;var u=i.inbandTextTracks_;i.logger_("adding cues from "+r+" -> "+s+" for "+e);Au(u,i.vhs_.tech_,e);Ru(r,s,u[e]);Lu({captionArray:o,inbandTextTracks:u,timestampOffset:n})}));if(this.transmuxer_)this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})};i.handleId3_=function(e,t,i){this.earlyAbortWhenNeeded_(e.stats);if(this.checkForAbort_(e.requestId))return;var r=this.pendingSegment_;if(!r.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,i));return}var n=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();Mu(this.inbandTextTracks_,i,this.vhs_.tech_);Du({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:n,videoDuration:this.duration_()})};i.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach((function(e){return e()}));this.metadataQueue_.caption.forEach((function(e){return e()}));this.metadataQueue_.id3=[];this.metadataQueue_.caption=[]};i.processCallQueue_=function(){var e=this.callQueue_;this.callQueue_=[];e.forEach((function(e){return e()}))};i.processLoadQueue_=function(){var e=this.loadQueue_;this.loadQueue_=[];e.forEach((function(e){return e()}))};i.hasEnoughInfoToLoad_=function(){if("audio"!==this.loaderType_)return true;var e=this.pendingSegment_;if(!e)return false;if(!this.getCurrentMediaInfo_())return true;if($u({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))return false;return true};i.getCurrentMediaInfo_=function(e){if(void 0===e)e=this.pendingSegment_;return e&&e.trackInfo||this.currentMediaInfo_};i.getMediaInfo_=function(e){if(void 0===e)e=this.pendingSegment_;return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_};i.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready())return false;if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return false;var e=this.pendingSegment_;var t=this.getCurrentMediaInfo_();if(!e||!t)return false;var i=t.hasAudio,r=t.hasVideo,n=t.isMuxed;if(r&&!e.videoTimingInfo)return false;if(i&&!this.audioDisabled_&&!n&&!e.audioTimingInfo)return false;if($u({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))return false;return true};i.handleData_=function(e,t){this.earlyAbortWhenNeeded_(e.stats);if(this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,t));return}var i=this.pendingSegment_;this.setTimeMapping_(i.timeline);this.updateMediaSecondsLoaded_(i.part||i.segment);if("closed"===this.mediaSource_.readyState)return;if(e.map){e.map=this.initSegmentForMap(e.map,true);i.segment.map=e.map}if(e.key)this.segmentKey(e.key,true);i.isFmp4=e.isFmp4;i.timingInfo=i.timingInfo||{};if(i.isFmp4){this.trigger("fmp4");i.timingInfo.start=i[Xu(t.type)].start}else{var r=this.getCurrentMediaInfo_();var n="main"===this.loaderType_&&r&&r.hasVideo;var a;if(n)a=i.videoTimingInfo.start;i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:n,firstVideoFrameTimeForData:a,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}this.updateAppendInitSegmentStatus(i,t.type);this.updateSourceBufferTimestampOffset_(i);if(i.isSyncRequest){this.updateTimingInfoEnd_(i);this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:"main"===this.loaderType_});var s=this.chooseNextRequest_();if(s.mediaIndex!==i.mediaIndex||s.partIndex!==i.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}i.hasAppendedData_=true;this.processMetadataQueue_();this.appendData_(i,t)};i.updateAppendInitSegmentStatus=function(e,t){if("main"===this.loaderType_&&"number"===typeof e.timestampOffset&&!e.changedTimestampOffset)this.appendInitSegment_={audio:true,video:true};if(this.playlistOfLastInitSegment_[t]!==e.playlist)this.appendInitSegment_[t]=true};i.getInitSegmentAndUpdateState_=function(e){var t=e.type,i=e.initSegment,r=e.map,n=e.playlist;if(r){var a=Js(r);if(this.activeInitSegmentId_===a)return null;i=this.initSegmentForMap(r,true).bytes;this.activeInitSegmentId_=a}if(i&&this.appendInitSegment_[t]){this.playlistOfLastInitSegment_[t]=n;this.appendInitSegment_[t]=false;this.activeInitSegmentId_=null;return i}return null};i.handleQuotaExceededError_=function(e,t){var i=this;var r=e.segmentInfo,a=e.type,s=e.bytes;var o=this.sourceUpdater_.audioBuffered();var u=this.sourceUpdater_.videoBuffered();if(o.length>1)this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Ka(o).join(", "));if(u.length>1)this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Ka(u).join(", "));var l=o.length?o.start(0):0;var d=o.length?o.end(o.length-1):0;var c=u.length?u.start(0):0;var h=u.length?u.end(u.length-1):0;if(d-l<=Vu&&h-c<=Vu){this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to "+"buffer, triggering an error. "+"Appended byte length: "+s.byteLength+", "+"audio buffer: "+Ka(o).join(", ")+", "+"video buffer: "+Ka(u).join(", ")+", ");this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0});this.trigger("error");return}this.waitingOnRemove_=true;this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:r,type:a,bytes:s}));var f=this.currentTime_();var p=f-Vu;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+p);this.remove(0,p,(function(){i.logger_("On QUOTA_EXCEEDED_ERR, retrying append in "+Vu+"s");i.waitingOnRemove_=false;i.quotaExceededErrorRetryTimeout_=n().setTimeout((function(){i.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue");i.quotaExceededErrorRetryTimeout_=null;i.processCallQueue_()}),1e3*Vu)}),true)};i.handleAppendError_=function(e,t){var i=e.segmentInfo,r=e.type,n=e.bytes;if(!t)return;if(t.code===Hu){this.handleQuotaExceededError_({segmentInfo:i,type:r,bytes:n});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",t);this.error(r+" append of "+n.length+"b failed for segment "+"#"+i.mediaIndex+" in playlist "+i.playlist.id);this.trigger("appenderror")};i.appendToSourceBuffer_=function(e){var t=e.segmentInfo,i=e.type,r=e.initSegment,n=e.data,a=e.bytes;if(!a){var s=[n];var o=n.byteLength;if(r){s.unshift(r);o+=r.byteLength}a=Pu({bytes:o,segments:s})}this.sourceUpdater_.appendBuffer({segmentInfo:t,type:i,bytes:a},this.handleAppendError_.bind(this,{segmentInfo:t,type:i,bytes:a}))};i.handleSegmentTimingInfo_=function(e,t,i){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId)return;var r=this.pendingSegment_.segment;var n=e+"TimingInfo";if(!r[n])r[n]={};r[n].transmuxerPrependedSeconds=i.prependedContentDuration||0;r[n].transmuxedPresentationStart=i.start.presentation;r[n].transmuxedDecodeStart=i.start.decode;r[n].transmuxedPresentationEnd=i.end.presentation;r[n].transmuxedDecodeEnd=i.end.decode;r[n].baseMediaDecodeTime=i.baseMediaDecodeTime};i.appendData_=function(e,t){var i=t.type,r=t.data;if(!r||!r.byteLength)return;if("audio"===i&&this.audioDisabled_)return;var n=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:n,data:r})};i.loadSegment_=function(e){var t=this;this.state="WAITING";this.pendingSegment_=e;this.trimBackBuffer_(e);if("number"===typeof e.timestampOffset)if(this.transmuxer_)this.transmuxer_.postMessage({action:"clearAllMp4Captions"});if(!this.hasEnoughInfoToLoad_()){this.loadQueue_.push((function(){var i=(0,o.Z)({},e,{forceTimestampOffset:true});(0,o.Z)(e,t.generateSegmentInfo_(i));t.isPendingTimestampOffset_=false;t.updateTransmuxerAndRequestSegment_(e)}));return}this.updateTransmuxerAndRequestSegment_(e)};i.updateTransmuxerAndRequestSegment_=function(e){var t=this;if(this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)){this.gopBuffer_.length=0;e.gopsToAlignWith=[];this.timeMapping_=0;this.transmuxer_.postMessage({action:"reset"});this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset})}var i=this.createSimplifiedSegmentObj_(e);var r=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex);var n=null!==this.mediaIndex;var a=e.timeline!==this.currentTimeline_&&e.timeline>0;var s=r||n&&a;this.logger_("Requesting "+Qu(e));if(i.map&&!i.map.bytes){this.logger_("going to request init segment.");this.appendInitSegment_={video:true,audio:true}}e.abortRequests=du({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:s,endedTimelineFn:function(){t.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function(i){var r=i.message,n=i.level,a=i.stream;t.logger_(Qu(e)+" logged from transmuxer stream "+a+" as a "+n+": "+r)}})};i.trimBackBuffer_=function(e){var t=Zu(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);if(t>0)this.remove(0,t)};i.createSimplifiedSegmentObj_=function(e){var t=e.segment;var i=e.part;var r={resolvedUri:i?i.resolvedUri:t.resolvedUri,byterange:i?i.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part};var n=e.playlist.segments[e.mediaIndex-1];if(n&&n.timeline===t.timeline)if(n.videoTimingInfo)r.baseStartTime=n.videoTimingInfo.transmuxedDecodeEnd;else if(n.audioTimingInfo)r.baseStartTime=n.audioTimingInfo.transmuxedDecodeEnd;if(t.key){var a=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);r.key=this.segmentKey(t.key);r.key.iv=a}if(t.map)r.map=this.initSegmentForMap(t.map);return r};i.saveTransferStats_=function(e){this.mediaRequests+=1;if(e){this.mediaBytesTransferred+=e.bytesReceived;this.mediaTransferDuration+=e.roundTripTime}};i.saveBandwidthRelatedStats_=function(e,t){this.pendingSegment_.byteLength=t.bytesReceived;if(e<Gu){this.logger_("Ignoring segment's bandwidth because its duration of "+e+" is less than the min to record "+Gu);return}this.bandwidth=t.bandwidth;this.roundTrip=t.roundTripTime};i.handleTimeout_=function(){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate")};i.segmentRequestFinished_=function(e,t,i){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));return}this.saveTransferStats_(t.stats);if(!this.pendingSegment_)return;if(t.requestId!==this.pendingSegment_.requestId)return;if(e){this.pendingSegment_=null;this.state="READY";if(e.code===Zo.ABORTED)return;this.pause();if(e.code===Zo.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1;this.error(e);this.trigger("error");return}var r=this.pendingSegment_;this.saveBandwidthRelatedStats_(r.duration,t.stats);r.endOfAllRequests=t.endOfAllRequests;if(i.gopInfo)this.gopBuffer_=Nu(this.gopBuffer_,i.gopInfo,this.safeAppend_);this.state="APPENDING";this.trigger("appending");this.waitForAppendsToComplete_(r)};i.setTimeMapping_=function(e){var t=this.syncController_.mappingForTimeline(e);if(null!==t)this.timeMapping_=t};i.updateMediaSecondsLoaded_=function(e){if("number"===typeof e.start&&"number"===typeof e.end)this.mediaSecondsLoaded+=e.end-e.start;else this.mediaSecondsLoaded+=e.duration};i.shouldUpdateTransmuxerTimestampOffset_=function(e){if(null===e)return false;if("main"===this.loaderType_&&e!==this.sourceUpdater_.videoTimestampOffset())return true;if(!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset())return true;return false};i.trueSegmentStart_=function(e){var t=e.currentStart,i=e.playlist,r=e.mediaIndex,n=e.firstVideoFrameTimeForData,a=e.currentVideoTimestampOffset,s=e.useVideoTimingInfo,o=e.videoTimingInfo,u=e.audioTimingInfo;if("undefined"!==typeof t)return t;if(!s)return u.start;var l=i.segments[r-1];if(0===r||!l||"undefined"===typeof l.start||l.end!==n+a)return n;return o.start};i.waitForAppendsToComplete_=function(e){var t=this.getCurrentMediaInfo_(e);if(!t){this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0});this.trigger("error");return}var i=t.hasAudio,r=t.hasVideo,n=t.isMuxed;var a="main"===this.loaderType_&&r;var s=!this.audioDisabled_&&i&&!n;e.waitingOnAppends=0;if(!e.hasAppendedData_){if(!e.timingInfo&&"number"===typeof e.timestampOffset)this.isPendingTimestampOffset_=true;e.timingInfo={start:0};e.waitingOnAppends++;if(!this.isPendingTimestampOffset_){this.updateSourceBufferTimestampOffset_(e);this.processMetadataQueue_()}this.checkAppendsDone_(e);return}if(a)e.waitingOnAppends++;if(s)e.waitingOnAppends++;if(a)this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e));if(s)this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))};i.checkAppendsDone_=function(e){if(this.checkForAbort_(e.requestId))return;e.waitingOnAppends--;if(0===e.waitingOnAppends)this.handleAppendsDone_()};i.checkForIllegalMediaSwitch=function(e){var t=Ku(this.loaderType_,this.getCurrentMediaInfo_(),e);if(t){this.error({message:t,blacklistDuration:1/0});this.trigger("error");return true}return false};i.updateSourceBufferTimestampOffset_=function(e){if(null===e.timestampOffset||"number"!==typeof e.timingInfo.start||e.changedTimestampOffset||"main"!==this.loaderType_)return;var t=false;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo});e.changedTimestampOffset=true;if(e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()){this.sourceUpdater_.videoTimestampOffset(e.timestampOffset);t=true}if(e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()){this.sourceUpdater_.audioTimestampOffset(e.timestampOffset);t=true}if(t)this.trigger("timestampoffset")};i.getSegmentStartTimeForTimestampOffsetCalculation_=function(e){var t=e.videoTimingInfo,i=e.audioTimingInfo,r=e.timingInfo;if(!this.useDtsForTimestampOffset_)return r.start;if(t&&"number"===typeof t.transmuxedDecodeStart)return t.transmuxedDecodeStart;if(i&&"number"===typeof i.transmuxedDecodeStart)return i.transmuxedDecodeStart;return r.start};i.updateTimingInfoEnd_=function(e){e.timingInfo=e.timingInfo||{};var t=this.getMediaInfo_();var i="main"===this.loaderType_&&t&&t.hasVideo;var r=i&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;if(!r)return;e.timingInfo.end="number"===typeof r.end?r.end:r.start+e.duration};i.handleAppendsDone_=function(){if(this.pendingSegment_)this.trigger("appendsdone");if(!this.pendingSegment_){this.state="READY";if(!this.paused())this.monitorBuffer_();return}var e=this.pendingSegment_;this.updateTimingInfoEnd_(e);if(this.shouldSaveSegmentTimingInfo_)this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:"main"===this.loaderType_});var t=tl(e,this.sourceType_);if(t)if("warn"===t.severity)Oa.log.warn(t.message);else this.logger_(t.message);this.recordThroughput_(e);this.pendingSegment_=null;this.state="READY";if(e.isSyncRequest){this.trigger("syncinfoupdate");if(!e.hasAppendedData_){this.logger_("Throwing away un-appended sync request "+Qu(e));return}}this.logger_("Appended "+Qu(e));this.addSegmentMetadataCue_(e);this.fetchAtBuffer_=true;if(this.currentTimeline_!==e.timeline){this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline});if("main"===this.loaderType_&&!this.audioDisabled_)this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})}this.currentTimeline_=e.timeline;this.trigger("syncinfoupdate");var i=e.segment;var r=e.part;var n=i.end&&this.currentTime_()-i.end>3*e.playlist.targetDuration;var a=r&&r.end&&this.currentTime_()-r.end>3*e.playlist.partTargetDuration;if(n||a){this.logger_("bad "+(n?"segment":"part")+" "+Qu(e));this.resetEverything();return}var s=null!==this.mediaIndex;if(s)this.trigger("bandwidthupdate");this.trigger("progress");this.mediaIndex=e.mediaIndex;this.partIndex=e.partIndex;if(this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex))this.endOfStream();this.trigger("appended");if(e.hasAppendedData_)this.mediaAppends++;if(!this.paused())this.monitorBuffer_()};i.recordThroughput_=function(e){if(e.duration<Gu){this.logger_("Ignoring segment's throughput because its duration of "+e.duration+" is less than the min to record "+Gu);return}var t=this.throughput.rate;var i=Date.now()-e.endOfAllRequests+1;var r=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(r-t)/++this.throughput.count};i.addSegmentMetadataCue_=function(e){if(!this.segmentMetadataTrack_)return;var t=e.segment;var i=t.start;var r=t.end;if(!zu(i)||!zu(r))return;Ru(i,r,this.segmentMetadataTrack_);var a=n().WebKitDataCue||n().VTTCue;var s={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:i,end:r};var o=JSON.stringify(s);var u=new a(i,r,o);u.value=s;this.segmentMetadataTrack_.addCue(u)};return t}(Oa.EventTarget);function rl(){}var nl=function(e){if("string"!==typeof e)return e;return e.replace(/./,(function(e){return e.toUpperCase()}))};var al=["video","audio"];var sl=function(e,t){var i=t[e+"Buffer"];return i&&i.updating||t.queuePending[e]};var ol=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];if("mediaSource"===r.type)return null;if(r.type===e)return i}return null};var ul=function e(t,i){if(0===i.queue.length)return;var r=0;var n=i.queue[r];if("mediaSource"===n.type){if(!i.updating()&&"closed"!==i.mediaSource.readyState){i.queue.shift();n.action(i);if(n.doneFn)n.doneFn();e("audio",i);e("video",i)}return}if("mediaSource"===t)return;if(!i.ready()||"closed"===i.mediaSource.readyState||sl(t,i))return;if(n.type!==t){r=ol(t,i.queue);if(null===r)return;n=i.queue[r]}i.queue.splice(r,1);i.queuePending[t]=n;n.action(t,i);if(!n.doneFn){i.queuePending[t]=null;e(t,i);return}};var ll=function(e,t){var i=t[e+"Buffer"];var r=nl(e);if(!i)return;i.removeEventListener("updateend",t["on"+r+"UpdateEnd_"]);i.removeEventListener("error",t["on"+r+"Error_"]);t.codecs[e]=null;t[e+"Buffer"]=null};var dl=function(e,t){return e&&t&&-1!==Array.prototype.indexOf.call(e.sourceBuffers,t)};var cl={appendBuffer:function(e,t,i){return function(r,n){var a=n[r+"Buffer"];if(!dl(n.mediaSource,a))return;n.logger_("Appending segment "+t.mediaIndex+"'s "+e.length+" bytes to "+r+"Buffer");try{a.appendBuffer(e)}catch(s){n.logger_("Error with code "+s.code+" "+(s.code===Hu?"(QUOTA_EXCEEDED_ERR) ":"")+"when appending segment "+t.mediaIndex+" to "+r+"Buffer");n.queuePending[r]=null;i(s)}}},remove:function(e,t){return function(i,r){var n=r[i+"Buffer"];if(!dl(r.mediaSource,n))return;r.logger_("Removing "+e+" to "+t+" from "+i+"Buffer");try{n.remove(e,t)}catch(a){r.logger_("Remove "+e+" to "+t+" from "+i+"Buffer failed")}}},timestampOffset:function(e){return function(t,i){var r=i[t+"Buffer"];if(!dl(i.mediaSource,r))return;i.logger_("Setting "+t+"timestampOffset to "+e);r.timestampOffset=e}},callback:function(e){return function(t,i){e()}},endOfStream:function(e){return function(t){if("open"!==t.mediaSource.readyState)return;t.logger_("Calling mediaSource endOfStream("+(e||"")+")");try{t.mediaSource.endOfStream(e)}catch(i){Oa.log.warn("Failed to call media source endOfStream",i)}}},duration:function(e){return function(t){t.logger_("Setting mediaSource duration to "+e);try{t.mediaSource.duration=e}catch(i){Oa.log.warn("Failed to set media source duration",i)}}},abort:function(){return function(e,t){if("open"!==t.mediaSource.readyState)return;var i=t[e+"Buffer"];if(!dl(t.mediaSource,i))return;t.logger_("calling abort on "+e+"Buffer");try{i.abort()}catch(r){Oa.log.warn("Failed to abort on "+e+"Buffer",r)}}},addSourceBuffer:function(e,t){return function(i){var r=nl(e);var n=(0,S._5)(t);i.logger_("Adding "+e+"Buffer with codec "+t+" to mediaSource");var a=i.mediaSource.addSourceBuffer(n);a.addEventListener("updateend",i["on"+r+"UpdateEnd_"]);a.addEventListener("error",i["on"+r+"Error_"]);i.codecs[e]=t;i[e+"Buffer"]=a}},removeSourceBuffer:function(e){return function(t){var i=t[e+"Buffer"];ll(e,t);if(!dl(t.mediaSource,i))return;t.logger_("Removing "+e+"Buffer with codec "+t.codecs[e]+" from mediaSource");try{t.mediaSource.removeSourceBuffer(i)}catch(r){Oa.log.warn("Failed to removeSourceBuffer "+e+"Buffer",r)}}},changeType:function(e){return function(t,i){var r=i[t+"Buffer"];var n=(0,S._5)(e);if(!dl(i.mediaSource,r))return;if(i.codecs[t]===e)return;i.logger_("changing "+t+"Buffer codec from "+i.codecs[t]+" to "+e);r.changeType(n);i.codecs[t]=e}}};var hl=function(e){var t=e.type,i=e.sourceUpdater,r=e.action,n=e.doneFn,a=e.name;i.queue.push({type:t,action:r,doneFn:n,name:a});ul(t,i)};var fl=function(e,t){return function(i){if(t.queuePending[e]){var r=t.queuePending[e].doneFn;t.queuePending[e]=null;if(r)r(t[e+"Error_"])}ul(e,t)}};var pl=function(e){(0,c.Z)(t,e);function t(t){var i;i=e.call(this)||this;i.mediaSource=t;i.sourceopenListener_=function(){return ul("mediaSource",(0,d.Z)(i))};i.mediaSource.addEventListener("sourceopen",i.sourceopenListener_);i.logger_=Ba("SourceUpdater");i.audioTimestampOffset_=0;i.videoTimestampOffset_=0;i.queue=[];i.queuePending={audio:null,video:null};i.delayedAudioAppendQueue_=[];i.videoAppendQueued_=false;i.codecs={};i.onVideoUpdateEnd_=fl("video",(0,d.Z)(i));i.onAudioUpdateEnd_=fl("audio",(0,d.Z)(i));i.onVideoError_=function(e){i.videoError_=e};i.onAudioError_=function(e){i.audioError_=e};i.createdSourceBuffers_=false;i.initializedEme_=false;i.triggeredReady_=false;return i}var i=t.prototype;i.initializedEme=function(){this.initializedEme_=true;this.triggerReady()};i.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_};i.hasInitializedAnyEme=function(){return this.initializedEme_};i.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()};i.createSourceBuffers=function(e){if(this.hasCreatedSourceBuffers())return;this.addOrChangeSourceBuffers(e);this.createdSourceBuffers_=true;this.trigger("createdsourcebuffers");this.triggerReady()};i.triggerReady=function(){if(this.ready()&&!this.triggeredReady_){this.triggeredReady_=true;this.trigger("ready")}};i.addSourceBuffer=function(e,t){hl({type:"mediaSource",sourceUpdater:this,action:cl.addSourceBuffer(e,t),name:"addSourceBuffer"})};i.abort=function(e){hl({type:e,sourceUpdater:this,action:cl.abort(e),name:"abort"})};i.removeSourceBuffer=function(e){if(!this.canRemoveSourceBuffer()){Oa.log.error("removeSourceBuffer is not supported!");return}hl({type:"mediaSource",sourceUpdater:this,action:cl.removeSourceBuffer(e),name:"removeSourceBuffer"})};i.canRemoveSourceBuffer=function(){return!Oa.browser.IE_VERSION&&!Oa.browser.IS_FIREFOX&&n().MediaSource&&n().MediaSource.prototype&&"function"===typeof n().MediaSource.prototype.removeSourceBuffer};t.canChangeType=function(){return n().SourceBuffer&&n().SourceBuffer.prototype&&"function"===typeof n().SourceBuffer.prototype.changeType};i.canChangeType=function(){return this.constructor.canChangeType()};i.changeType=function(e,t){if(!this.canChangeType()){Oa.log.error("changeType is not supported!");return}hl({type:e,sourceUpdater:this,action:cl.changeType(t),name:"changeType"})};i.addOrChangeSourceBuffers=function(e){var t=this;if(!e||"object"!==typeof e||0===Object.keys(e).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach((function(i){var r=e[i];if(!t.hasCreatedSourceBuffers())return t.addSourceBuffer(i,r);if(t.canChangeType())t.changeType(i,r)}))};i.appendBuffer=function(e,t){var i=this;var r=e.segmentInfo,n=e.type,a=e.bytes;this.processedAppend_=true;if("audio"===n&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,t]);this.logger_("delayed audio append of "+a.length+" until video append");return}var s=t;hl({type:n,sourceUpdater:this,action:cl.appendBuffer(a,r||{mediaIndex:-1},s),doneFn:t,name:"appendBuffer"});if("video"===n){this.videoAppendQueued_=true;if(!this.delayedAudioAppendQueue_.length)return;var o=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+o.length+" appendBuffers");this.delayedAudioAppendQueue_.length=0;o.forEach((function(e){i.appendBuffer.apply(i,e)}))}};i.audioBuffered=function(){if(!dl(this.mediaSource,this.audioBuffer))return Oa.createTimeRange();return this.audioBuffer.buffered?this.audioBuffer.buffered:Oa.createTimeRange()};i.videoBuffered=function(){if(!dl(this.mediaSource,this.videoBuffer))return Oa.createTimeRange();return this.videoBuffer.buffered?this.videoBuffer.buffered:Oa.createTimeRange()};i.buffered=function(){var e=dl(this.mediaSource,this.videoBuffer)?this.videoBuffer:null;var t=dl(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;if(t&&!e)return this.audioBuffered();if(e&&!t)return this.videoBuffered();return Wa(this.audioBuffered(),this.videoBuffered())};i.setDuration=function(e,t){if(void 0===t)t=rl;hl({type:"mediaSource",sourceUpdater:this,action:cl.duration(e),name:"duration",doneFn:t})};i.endOfStream=function(e,t){if(void 0===e)e=null;if(void 0===t)t=rl;if("string"!==typeof e)e=void 0;hl({type:"mediaSource",sourceUpdater:this,action:cl.endOfStream(e),name:"endOfStream",doneFn:t})};i.removeAudio=function(e,t,i){if(void 0===i)i=rl;if(!this.audioBuffered().length||0===this.audioBuffered().end(0)){i();return}hl({type:"audio",sourceUpdater:this,action:cl.remove(e,t),doneFn:i,name:"remove"})};i.removeVideo=function(e,t,i){if(void 0===i)i=rl;if(!this.videoBuffered().length||0===this.videoBuffered().end(0)){i();return}hl({type:"video",sourceUpdater:this,action:cl.remove(e,t),doneFn:i,name:"remove"})};i.updating=function(){if(sl("audio",this)||sl("video",this))return true;return false};i.audioTimestampOffset=function(e){if("undefined"!==typeof e&&this.audioBuffer&&this.audioTimestampOffset_!==e){hl({type:"audio",sourceUpdater:this,action:cl.timestampOffset(e),name:"timestampOffset"});this.audioTimestampOffset_=e}return this.audioTimestampOffset_};i.videoTimestampOffset=function(e){if("undefined"!==typeof e&&this.videoBuffer&&this.videoTimestampOffset!==e){hl({type:"video",sourceUpdater:this,action:cl.timestampOffset(e),name:"timestampOffset"});this.videoTimestampOffset_=e}return this.videoTimestampOffset_};i.audioQueueCallback=function(e){if(!this.audioBuffer)return;hl({type:"audio",sourceUpdater:this,action:cl.callback(e),name:"callback"})};i.videoQueueCallback=function(e){if(!this.videoBuffer)return;hl({type:"video",sourceUpdater:this,action:cl.callback(e),name:"callback"})};i.dispose=function(){var e=this;this.trigger("dispose");al.forEach((function(t){e.abort(t);if(e.canRemoveSourceBuffer())e.removeSourceBuffer(t);else e[t+"QueueCallback"]((function(){return ll(t,e)}))}));this.videoAppendQueued_=false;this.delayedAudioAppendQueue_.length=0;if(this.sourceopenListener_)this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_);this.off()};return t}(Oa.EventTarget);var ml=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))};var vl=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)})));var gl=function(e){(0,c.Z)(t,e);function t(t,i){var r;if(void 0===i)i={};r=e.call(this,t,i)||this;r.mediaSource_=null;r.subtitlesTrack_=null;r.loaderType_="subtitle";r.featuresNativeTextTracks_=t.featuresNativeTextTracks;r.shouldSaveSegmentTimingInfo_=false;return r}var i=t.prototype;i.createTransmuxer_=function(){return null};i.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Oa.createTimeRanges();var e=this.subtitlesTrack_.cues;var t=e[0].startTime;var i=e[e.length-1].startTime;return Oa.createTimeRanges([[t,i]])};i.initSegmentForMap=function(e,t){if(void 0===t)t=false;if(!e)return null;var i=Js(e);var r=this.initSegments_[i];if(t&&!r&&e.bytes){var n=vl.byteLength+e.bytes.byteLength;var a=new Uint8Array(n);a.set(e.bytes);a.set(vl,e.bytes.byteLength);this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return r||e};i.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()};i.init_=function(){this.state="READY";this.resetEverything();return this.monitorBuffer_()};i.track=function(e){if("undefined"===typeof e)return this.subtitlesTrack_;this.subtitlesTrack_=e;if("INIT"===this.state&&this.couldBeginLoading_())this.init_();return this.subtitlesTrack_};i.remove=function(e,t){Ru(e,t,this.subtitlesTrack_)};i.fillBuffer_=function(){var e=this;var t=this.chooseNextRequest_();if(!t)return;if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){var i=function(){e.state="READY";if(!e.paused())e.monitorBuffer_()};this.syncController_.one("timestampoffset",i);this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(t)};i.timestampOffsetForSegment_=function(){return null};i.chooseNextRequest_=function(){return this.skipEmptySegments_(e.prototype.chooseNextRequest_.call(this))};i.skipEmptySegments_=function(e){while(e&&e.segment.empty){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e};i.stopForError=function(e){this.error(e);this.state="READY";this.pause();this.trigger("error")};i.segmentRequestFinished_=function(e,t,i){var r=this;if(!this.subtitlesTrack_){this.state="READY";return}this.saveTransferStats_(t.stats);if(!this.pendingSegment_){this.state="READY";this.mediaRequestsAborted+=1;return}if(e){if(e.code===Zo.TIMEOUT)this.handleTimeout_();if(e.code===Zo.ABORTED)this.mediaRequestsAborted+=1;else this.mediaRequestsErrored+=1;this.stopForError(e);return}var a=this.pendingSegment_;this.saveBandwidthRelatedStats_(a.duration,t.stats);this.state="APPENDING";this.trigger("appending");var s=a.segment;if(s.map)s.map.bytes=t.map.bytes;a.bytes=t.bytes;if("function"!==typeof n().WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var o;var u=function(){r.subtitlesTrack_.tech_.off("vttjsloaded",o);r.stopForError({message:"Error loading vtt.js"});return};o=function(){r.subtitlesTrack_.tech_.off("vttjserror",u);r.segmentRequestFinished_(e,t,i)};this.state="WAITING_ON_VTTJS";this.subtitlesTrack_.tech_.one("vttjsloaded",o);this.subtitlesTrack_.tech_.one("vttjserror",u);return}s.requested=true;try{this.parseVTTCues_(a)}catch(l){this.stopForError({message:l.message});return}this.updateTimeMapping_(a,this.syncController_.timelines[a.timeline],this.playlist_);if(a.cues.length)a.timingInfo={start:a.cues[0].startTime,end:a.cues[a.cues.length-1].endTime};else a.timingInfo={start:a.startOfSegment,end:a.startOfSegment+a.duration};if(a.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}a.byteLength=a.bytes.byteLength;this.mediaSecondsLoaded+=s.duration;a.cues.forEach((function(e){r.subtitlesTrack_.addCue(r.featuresNativeTextTracks_?new(n().VTTCue)(e.startTime,e.endTime,e.text):e)}));Uu(this.subtitlesTrack_);this.handleAppendsDone_()};i.handleData_=function(){};i.updateTimingInfoEnd_=function(){};i.parseVTTCues_=function(e){var t;var i=false;if("function"===typeof n().TextDecoder)t=new(n().TextDecoder)("utf8");else{t=n().WebVTT.StringDecoder();i=true}var r=new(n().WebVTT.Parser)(n(),n().vttjs,t);e.cues=[];e.timestampmap={MPEGTS:0,LOCAL:0};r.oncue=e.cues.push.bind(e.cues);r.ontimestampmap=function(t){e.timestampmap=t};r.onparsingerror=function(e){Oa.log.warn("Error encountered when parsing cues: "+e.message)};if(e.segment.map){var a=e.segment.map.bytes;if(i)a=ml(a);r.parse(a)}var s=e.bytes;if(i)s=ml(s);r.parse(s);r.flush()};i.updateTimeMapping_=function(e,t,i){var r=e.segment;if(!t)return;if(!e.cues.length){r.empty=true;return}var n=e.timestampmap;var a=n.MPEGTS/A.ONE_SECOND_IN_TS-n.LOCAL+t.mapping;e.cues.forEach((function(e){e.startTime+=a;e.endTime+=a}));if(!i.syncInfo){var s=e.cues[0].startTime;var o=e.cues[e.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(s,o-r.duration)}}};return t}(il);var _l=function(e,t){var i=e.cues;for(var r=0;r<i.length;r++){var n=i[r];if(t>=n.adStartTime&&t<=n.adEndTime)return n}return null};var yl=function(e,t,i){if(void 0===i)i=0;if(!e.segments)return;var r=i;var a;for(var s=0;s<e.segments.length;s++){var o=e.segments[s];if(!a)a=_l(t,r+o.duration/2);if(a){if("cueIn"in o){a.endTime=r;a.adEndTime=r;r+=o.duration;a=null;continue}if(r<a.endTime){r+=o.duration;continue}a.endTime+=o.duration}else{if("cueOut"in o){a=new(n().VTTCue)(r,r+o.duration,o.cueOut);a.adStartTime=r;a.adEndTime=r+parseFloat(o.cueOut);t.addCue(a)}if("cueOutCont"in o){var u=o.cueOutCont.split("/").map(parseFloat),l=u[0],d=u[1];a=new(n().VTTCue)(r,r+o.duration,"");a.adStartTime=r-l;a.adEndTime=a.adStartTime+d;t.addCue(a)}}r+=o.duration}};var Tl=86400;var bl=[{name:"VOD",run:function(e,t,i,r,n){if(i!==1/0){var a={time:0,segmentIndex:0,partIndex:null};return a}return null}},{name:"ProgramDateTime",run:function(e,t,i,r,n){if(!Object.keys(e.timelineToDatetimeMappings).length)return null;var a=null;var s=null;var o=Ja(t);n=n||0;for(var u=0;u<o.length;u++){var l=t.endList||0===n?u:o.length-(u+1);var d=o[l];var c=d.segment;var h=e.timelineToDatetimeMappings[c.timeline];if(!h||!c.dateTimeObject)continue;var f=c.dateTimeObject.getTime()/1e3;var p=f+h;if(c.parts&&"number"===typeof d.partIndex)for(var m=0;m<d.partIndex;m++)p+=c.parts[m].duration;var v=Math.abs(n-p);if(null!==s&&(0===v||s<v))break;s=v;a={time:p,segmentIndex:d.segmentIndex,partIndex:d.partIndex}}return a}},{name:"Segment",run:function(e,t,i,r,n){var a=null;var s=null;n=n||0;var o=Ja(t);for(var u=0;u<o.length;u++){var l=t.endList||0===n?u:o.length-(u+1);var d=o[l];var c=d.segment;var h=d.part&&d.part.start||c&&c.start;if(c.timeline===r&&"undefined"!==typeof h){var f=Math.abs(n-h);if(null!==s&&s<f)break;if(!a||null===s||s>=f){s=f;a={time:h,segmentIndex:d.segmentIndex,partIndex:d.partIndex}}}}return a}},{name:"Discontinuity",run:function(e,t,i,r,n){var a=null;n=n||0;if(t.discontinuityStarts&&t.discontinuityStarts.length){var s=null;for(var o=0;o<t.discontinuityStarts.length;o++){var u=t.discontinuityStarts[o];var l=t.discontinuitySequence+o+1;var d=e.discontinuities[l];if(d){var c=Math.abs(n-d.time);if(null!==s&&s<c)break;if(!a||null===s||s>=c){s=c;a={time:d.time,segmentIndex:u,partIndex:null}}}}}return a}},{name:"Playlist",run:function(e,t,i,r,n){if(t.syncInfo){var a={time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence,partIndex:null};return a}return null}}];var Sl=function(e){(0,c.Z)(t,e);function t(t){var i;i=e.call(this)||this;i.timelines=[];i.discontinuities=[];i.timelineToDatetimeMappings={};i.logger_=Ba("SyncController");return i}var i=t.prototype;i.getSyncPoint=function(e,t,i,r){var n=this.runStrategies_(e,t,i,r);if(!n.length)return null;return this.selectSyncPoint_(n,{key:"time",value:r})};i.getExpiredTime=function(e,t){if(!e||!e.segments)return null;var i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;var r=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});if(r.segmentIndex>0)r.time*=-1;return Math.abs(r.time+os({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:r.segmentIndex,endIndex:0}))};i.runStrategies_=function(e,t,i,r){var n=[];for(var a=0;a<bl.length;a++){var s=bl[a];var o=s.run(this,e,t,i,r);if(o){o.strategy=s.name;n.push({strategy:s.name,syncPoint:o})}}return n};i.selectSyncPoint_=function(e,t){var i=e[0].syncPoint;var r=Math.abs(e[0].syncPoint[t.key]-t.value);var n=e[0].strategy;for(var a=1;a<e.length;a++){var s=Math.abs(e[a].syncPoint[t.key]-t.value);if(s<r){r=s;i=e[a].syncPoint;n=e[a].strategy}}this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy"+" ["+n+"]: [time:"+i.time+","+" segmentIndex:"+i.segmentIndex+("number"===typeof i.partIndex?",partIndex:"+i.partIndex:"")+"]");return i};i.saveExpiredSegmentInfo=function(e,t){var i=t.mediaSequence-e.mediaSequence;if(i>Tl){Oa.log.warn("Not saving expired segment info. Media sequence gap "+i+" is too large.");return}for(var r=i-1;r>=0;r--){var n=e.segments[r];if(n&&"undefined"!==typeof n.start){t.syncInfo={mediaSequence:e.mediaSequence+r,time:n.start};this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+","+" mediaSequence: "+t.syncInfo.mediaSequence+"]");this.trigger("syncinfoupdate");break}}};i.setDateTimeMappingForStart=function(e){this.timelineToDatetimeMappings={};if(e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0];var i=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-i}};i.saveSegmentTimingInfo=function(e){var t=e.segmentInfo,i=e.shouldSaveTimelineMapping;var r=this.calculateSegmentTimeMapping_(t,t.timingInfo,i);var n=t.segment;if(r){this.saveDiscontinuitySyncInfo_(t);if(!t.playlist.syncInfo)t.playlist.syncInfo={mediaSequence:t.playlist.mediaSequence+t.mediaIndex,time:n.start}}var a=n.dateTimeObject;if(n.discontinuity&&i&&a)this.timelineToDatetimeMappings[n.timeline]=-a.getTime()/1e3};i.timestampOffsetForTimeline=function(e){if("undefined"===typeof this.timelines[e])return null;return this.timelines[e].time};i.mappingForTimeline=function(e){if("undefined"===typeof this.timelines[e])return null;return this.timelines[e].mapping};i.calculateSegmentTimeMapping_=function(e,t,i){var r=e.segment;var n=e.part;var a=this.timelines[e.timeline];var s;var o;if("number"===typeof e.timestampOffset){a={time:e.startOfSegment,mapping:e.startOfSegment-t.start};if(i){this.timelines[e.timeline]=a;this.trigger("timestampoffset");this.logger_("time mapping for timeline "+e.timeline+": "+"[time: "+a.time+"] [mapping: "+a.mapping+"]")}s=e.startOfSegment;o=t.end+a.mapping}else if(a){s=t.start+a.mapping;o=t.end+a.mapping}else return false;if(n){n.start=s;n.end=o}if(!r.start||s<r.start)r.start=s;r.end=o;return true};i.saveDiscontinuitySyncInfo_=function(e){var t=e.playlist;var i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var r=0;r<t.discontinuityStarts.length;r++){var n=t.discontinuityStarts[r];var a=t.discontinuitySequence+r+1;var s=n-e.mediaIndex;var o=Math.abs(s);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>o){var u=void 0;if(s<0)u=i.start-os({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:n});else u=i.end+os({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:n});this.discontinuities[a]={time:u,accuracy:o}}}};i.dispose=function(){this.trigger("dispose");this.off()};return t}(Oa.EventTarget);var kl=function(e){(0,c.Z)(t,e);function t(){var t;t=e.call(this)||this;t.pendingTimelineChanges_={};t.lastTimelineChanges_={};return t}var i=t.prototype;i.clearPendingTimelineChange=function(e){this.pendingTimelineChanges_[e]=null;this.trigger("pendingtimelinechange")};i.pendingTimelineChange=function(e){var t=e.type,i=e.from,r=e.to;if("number"===typeof i&&"number"===typeof r){this.pendingTimelineChanges_[t]={type:t,from:i,to:r};this.trigger("pendingtimelinechange")}return this.pendingTimelineChanges_[t]};i.lastTimelineChange=function(e){var t=e.type,i=e.from,r=e.to;if("number"===typeof i&&"number"===typeof r){this.lastTimelineChanges_[t]={type:t,from:i,to:r};delete this.pendingTimelineChanges_[t];this.trigger("timelinechange")}return this.lastTimelineChanges_[t]};i.dispose=function(){this.trigger("dispose");this.pendingTimelineChanges_={};this.lastTimelineChanges_={};this.off()};return t}(Oa.EventTarget);var Cl=Lo(Oo((function(){var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof i.g?i.g:"undefined"!==typeof self?self:{};function t(e,t,i){return i={path:t,exports:{},require:function(e,t){return r(e,void 0===t||null===t?i.path:t)}},e(i,i.exports),i.exports}function r(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var n=t((function(e){function t(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function i(e,i,r){if(i)t(e.prototype,i);if(r)t(e,r);return e}e.exports=i;e.exports["default"]=e.exports,e.exports.__esModule=true}));var a=t((function(e){function t(i,r){e.exports=t=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};e.exports["default"]=e.exports,e.exports.__esModule=true;return t(i,r)}e.exports=t;e.exports["default"]=e.exports,e.exports.__esModule=true}));var s=t((function(e){function t(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;a(e,t)}e.exports=t;e.exports["default"]=e.exports,e.exports.__esModule=true}));var o=function(){function e(){this.listeners={}}var t=e.prototype;t.on=function(e,t){if(!this.listeners[e])this.listeners[e]=[];this.listeners[e].push(t)};t.off=function(e,t){if(!this.listeners[e])return false;var i=this.listeners[e].indexOf(t);this.listeners[e]=this.listeners[e].slice(0);this.listeners[e].splice(i,1);return i>-1};t.trigger=function(e){var t=this.listeners[e];if(!t)return;if(2===arguments.length){var i=t.length;for(var r=0;r<i;++r)t[r].call(this,arguments[1])}else{var n=Array.prototype.slice.call(arguments,1);var a=t.length;for(var s=0;s<a;++s)t[s].apply(this,n)}};t.dispose=function(){this.listeners={}};t.pipe=function(e){this.on("data",(function(t){e.push(t)}))};return e}();function u(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var l=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]];var t=e[0];var i=e[1];var r=t[4];var n=i[4];var a;var s;var o;var u=[];var l=[];var d;var c;var h;var f;var p;var m;for(a=0;a<256;a++)l[(u[a]=a<<1^283*(a>>7))^a]=a;for(s=o=0;!r[s];s^=d||1,o=l[o]||1){f=o^o<<1^o<<2^o<<3^o<<4;f=f>>8^255&f^99;r[s]=f;n[f]=s;h=u[c=u[d=u[s]]];m=16843009*h^65537*c^257*d^16843008*s;p=257*u[f]^16843008*f;for(a=0;a<4;a++){t[a][s]=p=p<<24^p>>>8;i[a][f]=m=m<<24^m>>>8}}for(a=0;a<5;a++){t[a]=t[a].slice(0);i[a]=i[a].slice(0)}return e};var d=null;var c=function(){function e(e){if(!d)d=l();this._tables=[[d[0][0].slice(),d[0][1].slice(),d[0][2].slice(),d[0][3].slice(),d[0][4].slice()],[d[1][0].slice(),d[1][1].slice(),d[1][2].slice(),d[1][3].slice(),d[1][4].slice()]];var t;var i;var r;var n=this._tables[0][4];var a=this._tables[1];var s=e.length;var o=1;if(4!==s&&6!==s&&8!==s)throw new Error("Invalid aes key size");var u=e.slice(0);var c=[];this._key=[u,c];for(t=s;t<4*s+28;t++){r=u[t-1];if(t%s===0||8===s&&t%s===4){r=n[r>>>24]<<24^n[r>>16&255]<<16^n[r>>8&255]<<8^n[255&r];if(t%s===0){r=r<<8^r>>>24^o<<24;o=o<<1^283*(o>>7)}}u[t]=u[t-s]^r}for(i=0;t;i++,t--){r=u[3&i?t:t-4];if(t<=4||i<4)c[i]=r;else c[i]=a[0][n[r>>>24]]^a[1][n[r>>16&255]]^a[2][n[r>>8&255]]^a[3][n[255&r]]}}var t=e.prototype;t.decrypt=function(e,t,i,r,n,a){var s=this._key[1];var o=e^s[0];var u=r^s[1];var l=i^s[2];var d=t^s[3];var c;var h;var f;var p=s.length/4-2;var m;var v=4;var g=this._tables[1];var _=g[0];var y=g[1];var T=g[2];var b=g[3];var S=g[4];for(m=0;m<p;m++){c=_[o>>>24]^y[u>>16&255]^T[l>>8&255]^b[255&d]^s[v];h=_[u>>>24]^y[l>>16&255]^T[d>>8&255]^b[255&o]^s[v+1];f=_[l>>>24]^y[d>>16&255]^T[o>>8&255]^b[255&u]^s[v+2];d=_[d>>>24]^y[o>>16&255]^T[u>>8&255]^b[255&l]^s[v+3];v+=4;o=c;u=h;l=f}for(m=0;m<4;m++){n[(3&-m)+a]=S[o>>>24]<<24^S[u>>16&255]<<16^S[l>>8&255]<<8^S[255&d]^s[v++];c=o;o=u;u=l;l=d;d=c}};return e}();var h=function(e){s(t,e);function t(){var t;t=e.call(this,o)||this;t.jobs=[];t.delay=1;t.timeout_=null;return t}var i=t.prototype;i.processJob_=function(){this.jobs.shift()();if(this.jobs.length)this.timeout_=setTimeout(this.processJob_.bind(this),this.delay);else this.timeout_=null};i.push=function(e){this.jobs.push(e);if(!this.timeout_)this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)};return t}(o);var f=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24};var p=function(e,t,i){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2);var n=new c(Array.prototype.slice.call(t));var a=new Uint8Array(e.byteLength);var s=new Int32Array(a.buffer);var o;var u;var l;var d;var h;var p;var m;var v;var g;o=i[0];u=i[1];l=i[2];d=i[3];for(g=0;g<r.length;g+=4){h=f(r[g]);p=f(r[g+1]);m=f(r[g+2]);v=f(r[g+3]);n.decrypt(h,p,m,v,s,g);s[g]=f(s[g]^o);s[g+1]=f(s[g+1]^u);s[g+2]=f(s[g+2]^l);s[g+3]=f(s[g+3]^d);o=h;u=p;l=m;d=v}return a};var m=function(){function e(t,i,r,n){var a=e.STEP;var s=new Int32Array(t.buffer);var o=new Uint8Array(t.byteLength);var l=0;this.asyncStream_=new h;this.asyncStream_.push(this.decryptChunk_(s.subarray(l,l+a),i,r,o));for(l=a;l<s.length;l+=a){r=new Uint32Array([f(s[l-4]),f(s[l-3]),f(s[l-2]),f(s[l-1])]);this.asyncStream_.push(this.decryptChunk_(s.subarray(l,l+a),i,r,o))}this.asyncStream_.push((function(){n(null,u(o))}))}var t=e.prototype;t.decryptChunk_=function(e,t,i,r){return function(){var n=p(e,t,i);r.set(n,e.byteOffset)}};n(e,null,[{key:"STEP",get:function(){return 32e3}}]);return e}();var v;if("undefined"!==typeof window)v=window;else if("undefined"!==typeof e)v=e;else if("undefined"!==typeof self)v=self;else v={};var g=v;var _=function(e){if("function"===ArrayBuffer.isView)return ArrayBuffer.isView(e);return e&&e.buffer instanceof ArrayBuffer};var y=g.BigInt||Number;[y("0x1"),y("0x100"),y("0x10000"),y("0x1000000"),y("0x100000000"),y("0x10000000000"),y("0x1000000000000"),y("0x100000000000000"),y("0x10000000000000000")];var T=function(e){var t={};Object.keys(e).forEach((function(i){var r=e[i];if(_(r))t[i]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength};else t[i]=r}));return t};self.onmessage=function(e){var t=e.data;var i=new Uint8Array(t.encrypted.bytes,t.encrypted.byteOffset,t.encrypted.byteLength);var r=new Uint32Array(t.key.bytes,t.key.byteOffset,t.key.byteLength/4);var n=new Uint32Array(t.iv.bytes,t.iv.byteOffset,t.iv.byteLength/4);new m(i,r,n,(function(e,i){self.postMessage(T({source:t.source,decrypted:i}),[i.buffer])}))}})));var El=Ao(Cl);var wl=function(e){var t=e["default"]?"main":"alternative";if(e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0)t="main-desc";return t};var Il=function(e,t){e.abort();e.pause();if(t&&t.activePlaylistLoader){t.activePlaylistLoader.pause();t.activePlaylistLoader=null}};var xl=function(e,t){t.activePlaylistLoader=e;e.load()};var Pl=function(e,t){return function(){var i=t.segmentLoaders,r=i[e],n=i.main,a=t.mediaTypes[e];var s=a.activeTrack();var o=a.getActiveGroup();var u=a.activePlaylistLoader;var l=a.lastGroup_;if(o&&l&&o.id===l.id)return;a.lastGroup_=o;a.lastTrack_=s;Il(r,a);if(!o||o.isMasterPlaylist)return;if(!o.playlistLoader){if(u)n.resetEverything();return}r.resyncLoader();xl(o.playlistLoader,a)}};var Al=function(e,t){return function(){var i=t.segmentLoaders[e],r=t.mediaTypes[e];r.lastGroup_=null;i.abort();i.pause()}};var Ll=function(e,t){return function(){var i=t.masterPlaylistLoader,r=t.segmentLoaders,n=r[e],a=r.main,s=t.mediaTypes[e];var o=s.activeTrack();var u=s.getActiveGroup();var l=s.activePlaylistLoader;var d=s.lastTrack_;if(d&&o&&d.id===o.id)return;s.lastGroup_=u;s.lastTrack_=o;Il(n,s);if(!u)return;if(u.isMasterPlaylist){if(!o||!d||o.id===d.id)return;var c=t.vhs.masterPlaylistController_;var h=c.selectPlaylist();if(c.media()===h)return;s.logger_("track change. Switching master audio from "+d.id+" to "+o.id);i.pause();a.resetEverything();c.fastQualityChange_(h);return}if("AUDIO"===e){if(!u.playlistLoader){a.setAudio(true);a.resetEverything();return}n.setAudio(true);a.setAudio(false)}if(l===u.playlistLoader){xl(u.playlistLoader,s);return}if(n.track)n.track(o);n.resetEverything();xl(u.playlistLoader,s)}};var Ol={AUDIO:function(e,t){return function(){var i=t.segmentLoaders[e],r=t.mediaTypes[e],n=t.blacklistCurrentPlaylist;Il(i,r);var a=r.activeTrack();var s=r.activeGroup();var o=(s.filter((function(e){return e["default"]}))[0]||s[0]).id;var u=r.tracks[o];if(a===u){n({message:"Problem encountered loading the default audio track."});return}Oa.log.warn("Problem encountered loading the alternate audio track."+"Switching back to default.");for(var l in r.tracks)r.tracks[l].enabled=r.tracks[l]===u;r.onTrackChanged()}},SUBTITLES:function(e,t){return function(){var i=t.segmentLoaders[e],r=t.mediaTypes[e];Oa.log.warn("Problem encountered loading the subtitle track."+"Disabling subtitle track.");Il(i,r);var n=r.activeTrack();if(n)n.mode="disabled";r.onTrackChanged()}}};var Dl={AUDIO:function(e,t,i){if(!t)return;var r=i.tech,n=i.requestOptions,a=i.segmentLoaders[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,n);if(!r.paused()||e.endList&&"none"!==r.preload())a.load()}));t.on("loadedplaylist",(function(){a.playlist(t.media(),n);if(!r.paused())a.load()}));t.on("error",Ol[e](e,i))},SUBTITLES:function(e,t,i){var r=i.tech,n=i.requestOptions,a=i.segmentLoaders[e],s=i.mediaTypes[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,n);a.track(s.activeTrack());if(!r.paused()||e.endList&&"none"!==r.preload())a.load()}));t.on("loadedplaylist",(function(){a.playlist(t.media(),n);if(!r.paused())a.load()}));t.on("error",Ol[e](e,i))}};var Ml={AUDIO:function(e,t){var i=t.vhs,r=t.sourceType,n=t.segmentLoaders[e],a=t.requestOptions,s=t.master.mediaGroups,o=t.mediaTypes[e],u=o.groups,l=o.tracks,d=o.logger_,c=t.masterPlaylistLoader;var h=bs(c.master);if(!s[e]||0===Object.keys(s[e]).length){s[e]={main:{default:{default:true}}};if(h)s[e].main["default"].playlists=c.master.playlists}for(var f in s[e]){if(!u[f])u[f]=[];for(var p in s[e][f]){var m=s[e][f][p];var v=void 0;if(h){d("AUDIO group '"+f+"' label '"+p+"' is a master playlist");m.isMasterPlaylist=true;v=null}else if("vhs-json"===r&&m.playlists)v=new qs(m.playlists[0],i,a);else if(m.resolvedUri)v=new qs(m.resolvedUri,i,a);else if(m.playlists&&"dash"===r)v=new Eo(m.playlists[0],i,a,c);else v=null;m=Oa.mergeOptions({id:p,playlistLoader:v},m);Dl[e](e,m.playlistLoader,t);u[f].push(m);if("undefined"===typeof l[p]){var g=new Oa.AudioTrack({id:p,kind:wl(m),enabled:false,language:m.language,default:m["default"],label:p});l[p]=g}}}n.on("error",Ol[e](e,t))},SUBTITLES:function(e,t){var i=t.tech,r=t.vhs,n=t.sourceType,a=t.segmentLoaders[e],s=t.requestOptions,o=t.master.mediaGroups,u=t.mediaTypes[e],l=u.groups,d=u.tracks,c=t.masterPlaylistLoader;for(var h in o[e]){if(!l[h])l[h]=[];for(var f in o[e][h]){if(o[e][h][f].forced)continue;var p=o[e][h][f];var m=void 0;if("hls"===n)m=new qs(p.resolvedUri,r,s);else if("dash"===n){var v=p.playlists.filter((function(e){return e.excludeUntil!==1/0}));if(!v.length)return;m=new Eo(p.playlists[0],r,s,c)}else if("vhs-json"===n)m=new qs(p.playlists?p.playlists[0]:p.resolvedUri,r,s);p=Oa.mergeOptions({id:f,playlistLoader:m},p);Dl[e](e,p.playlistLoader,t);l[h].push(p);if("undefined"===typeof d[f]){var g=i.addRemoteTextTrack({id:f,kind:"subtitles",default:p["default"]&&p.autoselect,language:p.language,label:f},false).track;d[f]=g}}}a.on("error",Ol[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var i=t.tech,r=t.master.mediaGroups,n=t.mediaTypes[e],a=n.groups,s=n.tracks;for(var o in r[e]){if(!a[o])a[o]=[];for(var u in r[e][o]){var l=r[e][o][u];if(!/^(?:CC|SERVICE)/.test(l.instreamId))continue;var d=i.options_.vhs&&i.options_.vhs.captionServices||{};var c={label:u,language:l.language,instreamId:l.instreamId,default:l["default"]&&l.autoselect};if(d[c.instreamId])c=Oa.mergeOptions(c,d[c.instreamId]);if(void 0===c["default"])delete c["default"];a[o].push(Oa.mergeOptions({id:u},l));if("undefined"===typeof s[u]){var h=i.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c["default"],language:c.language,label:c.label},false).track;s[u]=h}}}}};var Rl=function e(t,i){for(var r=0;r<t.length;r++){if(ys(i,t[r]))return true;if(t[r].playlists&&e(t[r].playlists,i))return true}return false};var Ul=function(e,t){return function(i){var r=t.masterPlaylistLoader,n=t.mediaTypes[e].groups;var a=r.media();if(!a)return null;var s=null;if(a.attributes[e])s=n[a.attributes[e]];var o=Object.keys(n);if(!s)if("AUDIO"===e&&o.length>1&&bs(t.master))for(var u=0;u<o.length;u++){var l=n[o[u]];if(Rl(l,a)){s=l;break}}else if(n.main)s=n.main;else if(1===o.length)s=n[o[0]];if("undefined"===typeof i)return s;if(null===i||!s)return null;return s.filter((function(e){return e.id===i.id}))[0]||null}};var Bl={AUDIO:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var r in i)if(i[r].enabled)return i[r];return null}},SUBTITLES:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var r in i)if("showing"===i[r].mode||"hidden"===i[r].mode)return i[r];return null}}};var Nl=function(e,t){var i=t.mediaTypes;return function(){var t=i[e].activeTrack();if(!t)return null;return i[e].activeGroup(t)}};var Fl=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){Ml[t](t,e)}));var t=e.mediaTypes,i=e.masterPlaylistLoader,r=e.tech,n=e.vhs,a=e.segmentLoaders,s=a["AUDIO"],o=a.main;["AUDIO","SUBTITLES"].forEach((function(i){t[i].activeGroup=Ul(i,e);t[i].activeTrack=Bl[i](i,e);t[i].onGroupChanged=Pl(i,e);t[i].onGroupChanging=Al(i,e);t[i].onTrackChanged=Ll(i,e);t[i].getActiveGroup=Nl(i,e)}));var u=t.AUDIO.activeGroup();if(u){var l=(u.filter((function(e){return e["default"]}))[0]||u[0]).id;t.AUDIO.tracks[l].enabled=true;t.AUDIO.onGroupChanged();t.AUDIO.onTrackChanged();var d=t.AUDIO.getActiveGroup();if(!d.playlistLoader)o.setAudio(true);else{o.setAudio(false);s.setAudio(true)}}i.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return t[e].onGroupChanged()}))}));i.on("mediachanging",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return t[e].onGroupChanging()}))}));var c=function(){t.AUDIO.onTrackChanged();r.trigger({type:"usage",name:"vhs-audio-change"});r.trigger({type:"usage",name:"hls-audio-change"})};r.audioTracks().addEventListener("change",c);r.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged);n.on("dispose",(function(){r.audioTracks().removeEventListener("change",c);r.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)}));r.clearTracks("audio");for(var h in t.AUDIO.tracks)r.audioTracks().addTrack(t.AUDIO.tracks[h])};var jl=function(){var e={};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:rl,activeTrack:rl,getActiveGroup:rl,onGroupChanged:rl,onTrackChanged:rl,lastTrack_:null,logger_:Ba("MediaGroups["+t+"]")}}));return e};var Hl=60*2;var ql;var Vl=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"];var Wl=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]};var zl=function(e){var t=e.currentPlaylist,i=e.buffered,r=e.currentTime,n=e.nextPlaylist,a=e.bufferLowWaterLine,s=e.bufferHighWaterLine,o=e.duration,u=e.experimentalBufferBasedABR,l=e.log;if(!n){Oa.log.warn("We received no playlist to switch to. Please check your stream.");return false}var d="allowing switch "+(t&&t.id||"null")+" -> "+n.id;if(!t){l(d+" as current playlist is not set");return true}if(n.id===t.id)return false;var c=Boolean(Ha(i,r).length);if(!t.endList){if(!c&&"number"===typeof t.partTargetDuration){l("not "+d+" as current playlist is live llhls, but currentTime isn't in buffered.");return false}l(d+" as current playlist is live");return true}var h=Xa(i,r);var f=u?wo.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:wo.MAX_BUFFER_LOW_WATER_LINE;if(o<f){l(d+" as duration < max low water line ("+o+" < "+f+")");return true}var p=n.attributes.BANDWIDTH;var m=t.attributes.BANDWIDTH;if(p<m&&(!u||h<s)){var v=d+" as next bandwidth < current bandwidth ("+p+" < "+m+")";if(u)v+=" and forwardBuffer < bufferHighWaterLine ("+h+" < "+s+")";l(v);return true}if((!u||p>m)&&h>=a){var g=d+" as forwardBuffer >= bufferLowWaterLine ("+h+" >= "+a+")";if(u)g+=" and next bandwidth > current bandwidth ("+p+" > "+m+")";l(g);return true}l("not "+d+" as no switching criteria met");return false};var Gl=function(e){(0,c.Z)(t,e);function t(t){var i;i=e.call(this)||this;var r=t.src,a=t.handleManifestRedirects,s=t.withCredentials,o=t.tech,u=t.bandwidth,l=t.externVhs,c=t.useCueTags,h=t.blacklistDuration,f=t.enableLowInitialPlaylist,p=t.sourceType,m=t.cacheEncryptionKeys,v=t.experimentalBufferBasedABR,g=t.experimentalLeastPixelDiffSelector,_=t.captionServices;if(!r)throw new Error("A non-empty playlist URL or JSON manifest string is required");var y=t.maxPlaylistRetries;if(null===y||"undefined"===typeof y)y=1/0;ql=l;i.experimentalBufferBasedABR=Boolean(v);i.experimentalLeastPixelDiffSelector=Boolean(g);i.withCredentials=s;i.tech_=o;i.vhs_=o.vhs;i.sourceType_=p;i.useCueTags_=c;i.blacklistDuration=h;i.maxPlaylistRetries=y;i.enableLowInitialPlaylist=f;if(i.useCueTags_){i.cueTagsTrack_=i.tech_.addTextTrack("metadata","ad-cues");i.cueTagsTrack_.inBandMetadataTrackDispatchType=""}i.requestOptions_={withCredentials:s,handleManifestRedirects:a,maxPlaylistRetries:y,timeout:null};i.on("error",i.pauseLoading);i.mediaTypes_=jl();i.mediaSource=new(n().MediaSource);i.handleDurationChange_=i.handleDurationChange_.bind((0,d.Z)(i));i.handleSourceOpen_=i.handleSourceOpen_.bind((0,d.Z)(i));i.handleSourceEnded_=i.handleSourceEnded_.bind((0,d.Z)(i));i.mediaSource.addEventListener("durationchange",i.handleDurationChange_);i.mediaSource.addEventListener("sourceopen",i.handleSourceOpen_);i.mediaSource.addEventListener("sourceended",i.handleSourceEnded_);i.seekable_=Oa.createTimeRanges();i.hasPlayed_=false;i.syncController_=new Sl(t);i.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},false).track;i.decrypter_=new El;i.sourceUpdater_=new pl(i.mediaSource);i.inbandTextTracks_={};i.timelineChangeController_=new kl;var T={vhs:i.vhs_,parse708captions:t.parse708captions,useDtsForTimestampOffset:t.useDtsForTimestampOffset,captionServices:_,mediaSource:i.mediaSource,currentTime:i.tech_.currentTime.bind(i.tech_),seekable:function(){return i.seekable()},seeking:function(){return i.tech_.seeking()},duration:function(){return i.duration()},hasPlayed:function(){return i.hasPlayed_},goalBufferLength:function(){return i.goalBufferLength()},bandwidth:u,syncController:i.syncController_,decrypter:i.decrypter_,sourceType:i.sourceType_,inbandTextTracks:i.inbandTextTracks_,cacheEncryptionKeys:m,sourceUpdater:i.sourceUpdater_,timelineChangeController:i.timelineChangeController_,experimentalExactManifestTimings:t.experimentalExactManifestTimings};i.masterPlaylistLoader_="dash"===i.sourceType_?new Eo(r,i.vhs_,i.requestOptions_):new qs(r,i.vhs_,i.requestOptions_);i.setupMasterPlaylistLoaderListeners_();i.mainSegmentLoader_=new il(Oa.mergeOptions(T,{segmentMetadataTrack:i.segmentMetadataTrack_,loaderType:"main"}),t);i.audioSegmentLoader_=new il(Oa.mergeOptions(T,{loaderType:"audio"}),t);i.subtitleSegmentLoader_=new gl(Oa.mergeOptions(T,{loaderType:"vtt",featuresNativeTextTracks:i.tech_.featuresNativeTextTracks}),t);i.setupSegmentLoaderListeners_();if(i.experimentalBufferBasedABR){i.masterPlaylistLoader_.one("loadedplaylist",(function(){return i.startABRTimer_()}));i.tech_.on("pause",(function(){return i.stopABRTimer_()}));i.tech_.on("play",(function(){return i.startABRTimer_()}))}Vl.forEach((function(e){i[e+"_"]=Wl.bind((0,d.Z)(i),e)}));i.logger_=Ba("MPC");i.triggeredFmp4Usage=false;if("none"===i.tech_.preload()){i.loadOnPlay_=function(){i.loadOnPlay_=null;i.masterPlaylistLoader_.load()};i.tech_.one("play",i.loadOnPlay_)}else i.masterPlaylistLoader_.load();i.timeToLoadedData__=-1;i.mainAppendsToLoadedData__=-1;i.audioAppendsToLoadedData__=-1;var b="none"===i.tech_.preload()?"play":"loadstart";i.tech_.one(b,(function(){var e=Date.now();i.tech_.one("loadeddata",(function(){i.timeToLoadedData__=Date.now()-e;i.mainAppendsToLoadedData__=i.mainSegmentLoader_.mediaAppends;i.audioAppendsToLoadedData__=i.audioSegmentLoader_.mediaAppends}))}));return i}var i=t.prototype;i.mainAppendsToLoadedData_=function(){return this.mainAppendsToLoadedData__};i.audioAppendsToLoadedData_=function(){return this.audioAppendsToLoadedData__};i.appendsToLoadedData_=function(){var e=this.mainAppendsToLoadedData_();var t=this.audioAppendsToLoadedData_();if(-1===e||-1===t)return-1;return e+t};i.timeToLoadedData_=function(){return this.timeToLoadedData__};i.checkABR_=function(){var e=this.selectPlaylist();if(e&&this.shouldSwitchToMedia_(e))this.switchMedia_(e,"abr")};i.switchMedia_=function(e,t,i){var r=this.media();var n=r&&(r.id||r.uri);var a=e.id||e.uri;if(n&&n!==a){this.logger_("switch media "+n+" -> "+a+" from "+t);this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+t})}this.masterPlaylistLoader_.media(e,i)};i.startABRTimer_=function(){var e=this;this.stopABRTimer_();this.abrTimer_=n().setInterval((function(){return e.checkABR_()}),250)};i.stopABRTimer_=function(){if(this.tech_.scrubbing&&this.tech_.scrubbing())return;n().clearInterval(this.abrTimer_);this.abrTimer_=null};i.getAudioTrackPlaylists_=function(){var e=this.master();var t=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return t;var i=e.mediaGroups.AUDIO;var r=Object.keys(i);var n;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)n=this.mediaTypes_.AUDIO.activeTrack();else{var a=i.main||r.length&&i[r[0]];for(var s in a)if(a[s]["default"]){n={label:s};break}}if(!n)return t;var o=[];for(var u in i)if(i[u][n.label]){var l=i[u][n.label];if(l.playlists&&l.playlists.length)o.push.apply(o,l.playlists);else if(l.uri)o.push(l);else if(e.playlists.length)for(var d=0;d<e.playlists.length;d++){var c=e.playlists[d];if(c.attributes&&c.attributes.AUDIO&&c.attributes.AUDIO===u)o.push(c)}}if(!o.length)return t;return o};i.setupMasterPlaylistLoaderListeners_=function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var t=e.masterPlaylistLoader_.media();var i=1.5*t.targetDuration*1e3;if(_s(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media()))e.requestOptions_.timeout=0;else e.requestOptions_.timeout=i;if(t.endList&&"none"!==e.tech_.preload()){e.mainSegmentLoader_.playlist(t,e.requestOptions_);e.mainSegmentLoader_.load()}Fl({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,vhs:e.vhs_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)});e.triggerPresenceUsage_(e.master(),t);e.setupFirstPlay();if(!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media())e.trigger("selectedinitialmedia");else e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){e.trigger("selectedinitialmedia")}))}));this.masterPlaylistLoader_.on("loadedplaylist",(function(){if(e.loadOnPlay_)e.tech_.off("play",e.loadOnPlay_);var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var i;if(e.enableLowInitialPlaylist)i=e.selectInitialPlaylist();if(!i)i=e.selectPlaylist();if(!i||!e.shouldSwitchToMedia_(i))return;e.initialMedia_=i;e.switchMedia_(e.initialMedia_,"initial");var r="vhs-json"===e.sourceType_&&e.initialMedia_.segments;if(!r)return;t=e.initialMedia_}e.handleUpdatedMediaPlaylist(t)}));this.masterPlaylistLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)}));this.masterPlaylistLoader_.on("mediachanging",(function(){e.mainSegmentLoader_.abort();e.mainSegmentLoader_.pause()}));this.masterPlaylistLoader_.on("mediachange",(function(){var t=e.masterPlaylistLoader_.media();var i=1.5*t.targetDuration*1e3;if(_s(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media()))e.requestOptions_.timeout=0;else e.requestOptions_.timeout=i;e.mainSegmentLoader_.playlist(t,e.requestOptions_);e.mainSegmentLoader_.load();e.tech_.trigger({type:"mediachange",bubbles:true})}));this.masterPlaylistLoader_.on("playlistunchanged",(function(){var t=e.masterPlaylistLoader_.media();if("playlist-unchanged"===t.lastExcludeReason_)return;var i=e.stuckAtPlaylistEnd_(t);if(i){e.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"});e.tech_.trigger("playliststuck")}}));this.masterPlaylistLoader_.on("renditiondisabled",(function(){e.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"});e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}));this.masterPlaylistLoader_.on("renditionenabled",(function(){e.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"});e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})}))};i.handleUpdatedMediaPlaylist=function(e){if(this.useCueTags_)this.updateAdCues_(e);this.mainSegmentLoader_.playlist(e,this.requestOptions_);this.updateDuration(!e.endList);if(!this.tech_.paused()){this.mainSegmentLoader_.load();if(this.audioSegmentLoader_)this.audioSegmentLoader_.load()}};i.triggerPresenceUsage_=function(e,t){var i=e.mediaGroups||{};var r=true;var n=Object.keys(i.AUDIO);for(var a in i.AUDIO)for(var s in i.AUDIO[a]){var o=i.AUDIO[a][s];if(!o.uri)r=false}if(r){this.tech_.trigger({type:"usage",name:"vhs-demuxed"});this.tech_.trigger({type:"usage",name:"hls-demuxed"})}if(Object.keys(i.SUBTITLES).length){this.tech_.trigger({type:"usage",name:"vhs-webvtt"});this.tech_.trigger({type:"usage",name:"hls-webvtt"})}if(ql.Playlist.isAes(t)){this.tech_.trigger({type:"usage",name:"vhs-aes"});this.tech_.trigger({type:"usage",name:"hls-aes"})}if(n.length&&Object.keys(i.AUDIO[n[0]]).length>1){this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"});this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})}if(this.useCueTags_){this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"});this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}};i.shouldSwitchToMedia_=function(e){var t=this.masterPlaylistLoader_.media()||this.masterPlaylistLoader_.pendingMedia_;var i=this.tech_.currentTime();var r=this.bufferLowWaterLine();var n=this.bufferHighWaterLine();var a=this.tech_.buffered();return zl({buffered:a,currentTime:i,currentPlaylist:t,nextPlaylist:e,bufferLowWaterLine:r,bufferHighWaterLine:n,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})};i.setupSegmentLoaderListeners_=function(){var e=this;if(!this.experimentalBufferBasedABR){this.mainSegmentLoader_.on("bandwidthupdate",(function(){var t=e.selectPlaylist();if(e.shouldSwitchToMedia_(t))e.switchMedia_(t,"bandwidthupdate");e.tech_.trigger("bandwidthupdate")}));this.mainSegmentLoader_.on("progress",(function(){e.trigger("progress")}))}this.mainSegmentLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())}));this.mainSegmentLoader_.on("appenderror",(function(){e.error=e.mainSegmentLoader_.error_;e.trigger("error")}));this.mainSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()}));this.mainSegmentLoader_.on("timestampoffset",(function(){e.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"});e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}));this.audioSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()}));this.audioSegmentLoader_.on("appenderror",(function(){e.error=e.audioSegmentLoader_.error_;e.trigger("error")}));this.mainSegmentLoader_.on("ended",(function(){e.logger_("main segment loader ended");e.onEndOfStream()}));this.mainSegmentLoader_.on("earlyabort",(function(t){if(e.experimentalBufferBasedABR)return;e.delegateLoaders_("all",["abort"]);e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the "+"request without rebuffering."},Hl)}));var t=function(){if(!e.sourceUpdater_.hasCreatedSourceBuffers())return e.tryToCreateSourceBuffers_();var t=e.getCodecsOrExclude_();if(!t)return;e.sourceUpdater_.addOrChangeSourceBuffers(t)};this.mainSegmentLoader_.on("trackinfo",t);this.audioSegmentLoader_.on("trackinfo",t);this.mainSegmentLoader_.on("fmp4",(function(){if(!e.triggeredFmp4Usage){e.tech_.trigger({type:"usage",name:"vhs-fmp4"});e.tech_.trigger({type:"usage",name:"hls-fmp4"});e.triggeredFmp4Usage=true}}));this.audioSegmentLoader_.on("fmp4",(function(){if(!e.triggeredFmp4Usage){e.tech_.trigger({type:"usage",name:"vhs-fmp4"});e.tech_.trigger({type:"usage",name:"hls-fmp4"});e.triggeredFmp4Usage=true}}));this.audioSegmentLoader_.on("ended",(function(){e.logger_("audioSegmentLoader ended");e.onEndOfStream()}))};i.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)};i.load=function(){this.mainSegmentLoader_.load();if(this.mediaTypes_.AUDIO.activePlaylistLoader)this.audioSegmentLoader_.load();if(this.mediaTypes_.SUBTITLES.activePlaylistLoader)this.subtitleSegmentLoader_.load()};i.smoothQualityChange_=function(e){if(void 0===e)e=this.selectPlaylist();this.fastQualityChange_(e)};i.fastQualityChange_=function(e){var t=this;if(void 0===e)e=this.selectPlaylist();if(e===this.masterPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality");this.mainSegmentLoader_.resetEverything((function(){if(Oa.browser.IE_VERSION||Oa.browser.IS_EDGE)t.tech_.setCurrentTime(t.tech_.currentTime()+.04);else t.tech_.setCurrentTime(t.tech_.currentTime())}))};i.play=function(){if(this.setupFirstPlay())return;if(this.tech_.ended())this.tech_.setCurrentTime(0);if(this.hasPlayed_)this.load();var e=this.tech_.seekable();if(this.tech_.duration()===1/0)if(this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))};i.setupFirstPlay=function(){var e=this;var t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return false;if(!t.endList){var i=this.seekable();if(!i.length)return false;if(Oa.browser.IE_VERSION&&0===this.tech_.readyState()){this.tech_.one("loadedmetadata",(function(){e.trigger("firstplay");e.tech_.setCurrentTime(i.end(0));e.hasPlayed_=true}));return false}this.trigger("firstplay");this.tech_.setCurrentTime(i.end(0))}this.hasPlayed_=true;this.load();return true};i.handleSourceOpen_=function(){this.tryToCreateSourceBuffers_();if(this.tech_.autoplay()){var e=this.tech_.play();if("undefined"!==typeof e&&"function"===typeof e.then)e.then(null,(function(e){}))}this.trigger("sourceopen")};i.handleSourceEnded_=function(){if(!this.inbandTextTracks_.metadataTrack_)return;var e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;var t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t};i.handleDurationChange_=function(){this.tech_.trigger("durationchange")};i.onEndOfStream=function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var t=this.mainSegmentLoader_.getCurrentMediaInfo_();if(!t||t.hasVideo)e=e&&this.audioSegmentLoader_.ended_;else e=this.audioSegmentLoader_.ended_}if(!e)return;this.stopABRTimer_();this.sourceUpdater_.endOfStream()};i.stuckAtPlaylistEnd_=function(e){var t=this.seekable();if(!t.length)return false;var i=this.syncController_.getExpiredTime(e,this.duration());if(null===i)return false;var r=ql.Playlist.playlistEnd(e,i);var n=this.tech_.currentTime();var a=this.tech_.buffered();if(!a.length)return r-n<=Fa;var s=a.end(a.length-1);return s-n<=Fa&&r-s<=Fa};i.blacklistCurrentPlaylist=function(e,t){if(void 0===e)e={};var i=e.playlist||this.masterPlaylistLoader_.media();t=t||e.blacklistDuration||this.blacklistDuration;if(!i){this.error=e;if("open"!==this.mediaSource.readyState)this.trigger("error");else this.sourceUpdater_.endOfStream("network");return}i.playlistErrors_++;var r=this.masterPlaylistLoader_.master.playlists;var n=r.filter(fs);var a=1===n.length&&n[0]===i;if(1===r.length&&t!==1/0){Oa.log.warn("Problem encountered with playlist "+i.id+". "+"Trying again since it is the only playlist.");this.tech_.trigger("retryplaylist");return this.masterPlaylistLoader_.load(a)}if(a){var s=false;r.forEach((function(e){if(e===i)return;var t=e.excludeUntil;if("undefined"!==typeof t&&t!==1/0){s=true;delete e.excludeUntil}}));if(s){Oa.log.warn("Removing other playlists from the exclusion list because the last "+"rendition is about to be excluded.");this.tech_.trigger("retryplaylist")}}var o;if(i.playlistErrors_>this.maxPlaylistRetries)o=1/0;else o=Date.now()+1e3*t;i.excludeUntil=o;if(e.reason)i.lastExcludeReason_=e.reason;this.tech_.trigger("blacklistplaylist");this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"});this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var u=this.selectPlaylist();if(!u){this.error="Playback cannot continue. No available working or supported playlists.";this.trigger("error");return}var l=e.internal?this.logger_:Oa.log.warn;var d=e.message?" "+e.message:"";l((e.internal?"Internal problem":"Problem")+" encountered with playlist "+i.id+"."+d+" Switching to playlist "+u.id+".");if(u.attributes.AUDIO!==i.attributes.AUDIO)this.delegateLoaders_("audio",["abort","pause"]);if(u.attributes.SUBTITLES!==i.attributes.SUBTITLES)this.delegateLoaders_("subtitle",["abort","pause"]);this.delegateLoaders_("main",["abort","pause"]);var c=u.targetDuration/2*1e3||5*1e3;var h="number"===typeof u.lastRequest&&Date.now()-u.lastRequest<=c;return this.switchMedia_(u,"exclude",a||h)};i.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]);this.stopABRTimer_()};i.delegateLoaders_=function(e,t){var i=this;var r=[];var n="all"===e;if(n||"main"===e)r.push(this.masterPlaylistLoader_);var a=[];if(n||"audio"===e)a.push("AUDIO");if(n||"subtitle"===e){a.push("CLOSED-CAPTIONS");a.push("SUBTITLES")}a.forEach((function(e){var t=i.mediaTypes_[e]&&i.mediaTypes_[e].activePlaylistLoader;if(t)r.push(t)}));["main","audio","subtitle"].forEach((function(t){var n=i[t+"SegmentLoader_"];if(n&&(e===t||"all"===e))r.push(n)}));r.forEach((function(e){return t.forEach((function(t){if("function"===typeof e[t])e[t]()}))}))};i.setCurrentTime=function(e){var t=Ha(this.tech_.buffered(),e);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()))return 0;if(!this.masterPlaylistLoader_.media().segments)return 0;if(t&&t.length)return e;this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.resetEverything();this.audioSegmentLoader_.abort()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.resetEverything();this.subtitleSegmentLoader_.abort()}this.load()};i.duration=function(){if(!this.masterPlaylistLoader_)return 0;var e=this.masterPlaylistLoader_.media();if(!e)return 0;if(!e.endList)return 1/0;if(this.mediaSource)return this.mediaSource.duration;return ql.Playlist.duration(e)};i.seekable=function(){return this.seekable_};i.onSyncInfoUpdate_=function(){var e;if(!this.masterPlaylistLoader_)return;var t=this.masterPlaylistLoader_.media();if(!t)return;var i=this.syncController_.getExpiredTime(t,this.duration());if(null===i)return;var r=this.masterPlaylistLoader_.master;var n=ql.Playlist.seekable(t,i,ql.Playlist.liveEdgeDelay(r,t));if(0===n.length)return;if(this.mediaTypes_.AUDIO.activePlaylistLoader){t=this.mediaTypes_.AUDIO.activePlaylistLoader.media();i=this.syncController_.getExpiredTime(t,this.duration());if(null===i)return;e=ql.Playlist.seekable(t,i,ql.Playlist.liveEdgeDelay(r,t));if(0===e.length)return}var a;var s;if(this.seekable_&&this.seekable_.length){a=this.seekable_.end(0);s=this.seekable_.start(0)}if(!e)this.seekable_=n;else if(e.start(0)>n.end(0)||n.start(0)>e.end(0))this.seekable_=n;else this.seekable_=Oa.createTimeRanges([[e.start(0)>n.start(0)?e.start(0):n.start(0),e.end(0)<n.end(0)?e.end(0):n.end(0)]]);if(this.seekable_&&this.seekable_.length)if(this.seekable_.end(0)===a&&this.seekable_.start(0)===s)return;this.logger_("seekable updated ["+za(this.seekable_)+"]");this.tech_.trigger("seekablechanged")};i.updateDuration=function(e){if(this.updateDuration_){this.mediaSource.removeEventListener("sourceopen",this.updateDuration_);this.updateDuration_=null}if("open"!==this.mediaSource.readyState){this.updateDuration_=this.updateDuration.bind(this,e);this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){var t=this.seekable();if(!t.length)return;if(isNaN(this.mediaSource.duration)||this.mediaSource.duration<t.end(t.length-1))this.sourceUpdater_.setDuration(t.end(t.length-1));return}var i=this.tech_.buffered();var r=ql.Playlist.duration(this.masterPlaylistLoader_.media());if(i.length>0)r=Math.max(r,i.end(i.length-1));if(this.mediaSource.duration!==r)this.sourceUpdater_.setDuration(r)};i.dispose=function(){var e=this;this.trigger("dispose");this.decrypter_.terminate();this.masterPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();if(this.loadOnPlay_)this.tech_.off("play",this.loadOnPlay_);["AUDIO","SUBTITLES"].forEach((function(t){var i=e.mediaTypes_[t].groups;for(var r in i)i[r].forEach((function(e){if(e.playlistLoader)e.playlistLoader.dispose()}))}));this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose();this.sourceUpdater_.dispose();this.timelineChangeController_.dispose();this.stopABRTimer_();if(this.updateDuration_)this.mediaSource.removeEventListener("sourceopen",this.updateDuration_);this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_);this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_);this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_);this.off()};i.master=function(){return this.masterPlaylistLoader_.master};i.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_};i.areMediaTypesKnown_=function(){var e=!!this.mediaTypes_.AUDIO.activePlaylistLoader;var t=!!this.mainSegmentLoader_.getCurrentMediaInfo_();var i=!e?true:!!this.audioSegmentLoader_.getCurrentMediaInfo_();if(!t||!i)return false;return true};i.getCodecsOrExclude_=function(){var e=this;var t={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}};t.video=t.main;var i=gu(this.master(),this.media());var r={};var n=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(t.main.hasVideo)r.video=i.video||t.main.videoCodec||S.xz;if(t.main.isMuxed)r.video+=","+(i.audio||t.main.audioCodec||S.lA);if(t.main.hasAudio&&!t.main.isMuxed||t.audio.hasAudio||n){r.audio=i.audio||t.main.audioCodec||t.audio.audioCodec||S.lA;t.audio.isFmp4=t.main.hasAudio&&!t.main.isMuxed?t.main.isFmp4:t.audio.isFmp4}if(!r.audio&&!r.video){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:1/0});return}var a=function(e,t){return e?(0,S.p7)(t):(0,S.Hi)(t)};var s={};var o;["video","audio"].forEach((function(e){if(r.hasOwnProperty(e)&&!a(t[e].isFmp4,r[e])){var i=t[e].isFmp4?"browser":"muxer";s[i]=s[i]||[];s[i].push(r[e]);if("audio"===e)o=i}}));if(n&&o&&this.media().attributes.AUDIO){var u=this.media().attributes.AUDIO;this.master().playlists.forEach((function(t){var i=t.attributes&&t.attributes.AUDIO;if(i===u&&t!==e.media())t.excludeUntil=1/0}));this.logger_("excluding audio group "+u+" as "+o+' does not support codec(s): "'+r.audio+'"')}if(Object.keys(s).length){var l=Object.keys(s).reduce((function(e,t){if(e)e+=", ";e+=t+' does not support codec(s): "'+s[t].join(",")+'"';return e}),"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:true,message:l,blacklistDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var d=[];["video","audio"].forEach((function(t){var i=((0,S.kS)(e.sourceUpdater_.codecs[t]||"")[0]||{}).type;var n=((0,S.kS)(r[t]||"")[0]||{}).type;if(i&&n&&i.toLowerCase()!==n.toLowerCase())d.push('"'+e.sourceUpdater_.codecs[t]+'" -> "'+r[t]+'"')}));if(d.length){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+d.join(", ")+".",blacklistDuration:1/0,internal:true});return}}return r};i.tryToCreateSourceBuffers_=function(){if("open"!==this.mediaSource.readyState||this.sourceUpdater_.hasCreatedSourceBuffers())return;if(!this.areMediaTypesKnown_())return;var e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);var t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)};i.excludeUnsupportedVariants_=function(){var e=this;var t=this.master().playlists;var i=[];Object.keys(t).forEach((function(r){var n=t[r];if(-1!==i.indexOf(n.id))return;i.push(n.id);var a=gu(e.master,n);var s=[];if(a.audio&&!(0,S.Hi)(a.audio)&&!(0,S.p7)(a.audio))s.push("audio codec "+a.audio);if(a.video&&!(0,S.Hi)(a.video)&&!(0,S.p7)(a.video))s.push("video codec "+a.video);if(a.text&&"stpp.ttml.im1t"===a.text)s.push("text codec "+a.text);if(s.length){n.excludeUntil=1/0;e.logger_("excluding "+n.id+" for unsupported: "+s.join(", "))}}))};i.excludeIncompatibleVariants_=function(e){var t=this;var i=[];var r=this.master().playlists;var n=mu((0,S.kS)(e));var a=vu(n);var s=n.video&&(0,S.kS)(n.video)[0]||null;var o=n.audio&&(0,S.kS)(n.audio)[0]||null;Object.keys(r).forEach((function(e){var n=r[e];if(-1!==i.indexOf(n.id)||n.excludeUntil===1/0)return;i.push(n.id);var u=[];var l=gu(t.masterPlaylistLoader_.master,n);var d=vu(l);if(!l.audio&&!l.video)return;if(d!==a)u.push('codec count "'+d+'" !== "'+a+'"');if(!t.sourceUpdater_.canChangeType()){var c=l.video&&(0,S.kS)(l.video)[0]||null;var h=l.audio&&(0,S.kS)(l.audio)[0]||null;if(c&&s&&c.type.toLowerCase()!==s.type.toLowerCase())u.push('video codec "'+c.type+'" !== "'+s.type+'"');if(h&&o&&h.type.toLowerCase()!==o.type.toLowerCase())u.push('audio codec "'+h.type+'" !== "'+o.type+'"')}if(u.length){n.excludeUntil=1/0;t.logger_("blacklisting "+n.id+": "+u.join(" && "))}}))};i.updateAdCues_=function(e){var t=0;var i=this.seekable();if(i.length)t=i.start(0);yl(e,this.cueTagsTrack_,t)};i.goalBufferLength=function(){var e=this.tech_.currentTime();var t=wo.GOAL_BUFFER_LENGTH;var i=wo.GOAL_BUFFER_LENGTH_RATE;var r=Math.max(t,wo.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,r)};i.bufferLowWaterLine=function(){var e=this.tech_.currentTime();var t=wo.BUFFER_LOW_WATER_LINE;var i=wo.BUFFER_LOW_WATER_LINE_RATE;var r=Math.max(t,wo.MAX_BUFFER_LOW_WATER_LINE);var n=Math.max(t,wo.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,this.experimentalBufferBasedABR?n:r)};i.bufferHighWaterLine=function(){return wo.BUFFER_HIGH_WATER_LINE};return t}(Oa.EventTarget);var Kl=function(e,t,i){return function(r){var n=e.master.playlists[t];var a=hs(n);var s=fs(n);if("undefined"===typeof r)return s;if(r)delete n.disabled;else n.disabled=true;if(r!==s&&!a){i();if(r)e.trigger("renditionenabled");else e.trigger("renditiondisabled")}return r}};var Zl=function(e,t,i){var r=e.masterPlaylistController_,n=e.options_.smoothQualityChange;var a=n?"smooth":"fast";var s=r[a+"QualityChange_"].bind(r);if(t.attributes){var o=t.attributes.RESOLUTION;this.width=o&&o.width;this.height=o&&o.height;this.bandwidth=t.attributes.BANDWIDTH}this.codecs=gu(r.master(),t);this.playlist=t;this.id=i;this.enabled=Kl(e.playlists,t.id,s)};var Ql=function(e){e.representations=function(){var t=e.masterPlaylistController_.master();var i=bs(t)?e.masterPlaylistController_.getAudioTrackPlaylists_():t.playlists;if(!i)return[];return i.filter((function(e){return!hs(e)})).map((function(t,i){return new Zl(e,t,t.id)}))}};var Xl=["seeking","seeked","pause","playing","error"];var Yl=function(){function e(e){var t=this;this.masterPlaylistController_=e.masterPlaylistController;this.tech_=e.tech;this.seekable=e.seekable;this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow;this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta;this.media=e.media;this.consecutiveUpdates=0;this.lastRecordedTime=null;this.timer_=null;this.checkCurrentTimeTimeout_=null;this.logger_=Ba("PlaybackWatcher");this.logger_("initialize");var i=function(){return t.monitorCurrentTime_()};var r=function(){return t.monitorCurrentTime_()};var a=function(){return t.techWaiting_()};var s=function(){return t.cancelTimer_()};var o=this.masterPlaylistController_;var u=["main","subtitle","audio"];var l={};u.forEach((function(e){l[e]={reset:function(){return t.resetSegmentDownloads_(e)},updateend:function(){return t.checkSegmentDownloads_(e)}};o[e+"SegmentLoader_"].on("appendsdone",l[e].updateend);o[e+"SegmentLoader_"].on("playlistupdate",l[e].reset);t.tech_.on(["seeked","seeking"],l[e].reset)}));var d=function(e){["main","audio"].forEach((function(i){o[i+"SegmentLoader_"][e]("appended",t.seekingAppendCheck_)}))};this.seekingAppendCheck_=function(){if(t.fixesBadSeeks_()){t.consecutiveUpdates=0;t.lastRecordedTime=t.tech_.currentTime();d("off")}};this.clearSeekingAppendCheck_=function(){return d("off")};this.watchForBadSeeking_=function(){t.clearSeekingAppendCheck_();d("on")};this.tech_.on("seeked",this.clearSeekingAppendCheck_);this.tech_.on("seeking",this.watchForBadSeeking_);this.tech_.on("waiting",a);this.tech_.on(Xl,s);this.tech_.on("canplay",r);this.tech_.one("play",i);this.dispose=function(){t.clearSeekingAppendCheck_();t.logger_("dispose");t.tech_.off("waiting",a);t.tech_.off(Xl,s);t.tech_.off("canplay",r);t.tech_.off("play",i);t.tech_.off("seeking",t.watchForBadSeeking_);t.tech_.off("seeked",t.clearSeekingAppendCheck_);u.forEach((function(e){o[e+"SegmentLoader_"].off("appendsdone",l[e].updateend);o[e+"SegmentLoader_"].off("playlistupdate",l[e].reset);t.tech_.off(["seeked","seeking"],l[e].reset)}));if(t.checkCurrentTimeTimeout_)n().clearTimeout(t.checkCurrentTimeTimeout_);t.cancelTimer_()}}var t=e.prototype;t.monitorCurrentTime_=function(){this.checkCurrentTime_();if(this.checkCurrentTimeTimeout_)n().clearTimeout(this.checkCurrentTimeTimeout_);this.checkCurrentTimeTimeout_=n().setTimeout(this.monitorCurrentTime_.bind(this),250)};t.resetSegmentDownloads_=function(e){var t=this.masterPlaylistController_[e+"SegmentLoader_"];if(this[e+"StalledDownloads_"]>0)this.logger_("resetting possible stalled download count for "+e+" loader");this[e+"StalledDownloads_"]=0;this[e+"Buffered_"]=t.buffered_()};t.checkSegmentDownloads_=function(e){var t=this.masterPlaylistController_;var i=t[e+"SegmentLoader_"];var r=i.buffered_();var n=Za(this[e+"Buffered_"],r);this[e+"Buffered_"]=r;if(n){this.resetSegmentDownloads_(e);return}this[e+"StalledDownloads_"]++;this.logger_("found #"+this[e+"StalledDownloads_"]+" "+e+" appends that did not increase buffer (possible stalled download)",{playlistId:i.playlist_&&i.playlist_.id,buffered:Ka(r)});if(this[e+"StalledDownloads_"]<10)return;this.logger_(e+" loader stalled download exclusion");this.resetSegmentDownloads_(e);this.tech_.trigger({type:"usage",name:"vhs-"+e+"-download-exclusion"});if("subtitle"===e)return;t.blacklistCurrentPlaylist({message:"Excessive "+e+" segment downloading detected."},1/0)};t.checkCurrentTime_=function(){if(this.tech_.paused()||this.tech_.seeking())return;var e=this.tech_.currentTime();var t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+Fa>=t.end(t.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&e===this.lastRecordedTime){this.consecutiveUpdates++;this.waiting_()}else if(e===this.lastRecordedTime)this.consecutiveUpdates++;else{this.consecutiveUpdates=0;this.lastRecordedTime=e}};t.cancelTimer_=function(){this.consecutiveUpdates=0;if(this.timer_){this.logger_("cancelTimer_");clearTimeout(this.timer_)}this.timer_=null};t.fixesBadSeeks_=function(){var e=this.tech_.seeking();if(!e)return false;var t=this.seekable();var i=this.tech_.currentTime();var r=this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow);var n;if(r){var a=t.end(t.length-1);n=a}if(this.beforeSeekableWindow_(t,i)){var s=t.start(0);n=s+(s===t.end(0)?0:Fa)}if("undefined"!==typeof n){this.logger_("Trying to seek outside of seekable at time "+i+" with "+"seekable range "+za(t)+". Seeking to "+n+".");this.tech_.setCurrentTime(n);return true}var o=this.masterPlaylistController_.sourceUpdater_;var u=this.tech_.buffered();var l=o.audioBuffer?o.audioBuffered():null;var d=o.videoBuffer?o.videoBuffered():null;var c=this.media();var h=c.partTargetDuration?c.partTargetDuration:2*(c.targetDuration-Na);var f=[l,d];for(var p=0;p<f.length;p++){if(!f[p])continue;var m=Xa(f[p],i);if(m<h)return false}var v=qa(u,i);if(0===v.length)return false;n=v.start(0)+Fa;this.logger_("Buffered region starts ("+v.start(0)+") "+" just beyond seek point ("+i+"). Seeking to "+n+".");this.tech_.setCurrentTime(n);return true};t.waiting_=function(){if(this.techWaiting_())return;var e=this.tech_.currentTime();var t=this.tech_.buffered();var i=Ha(t,e);if(i.length&&e+3<=i.end(0)){this.cancelTimer_();this.tech_.setCurrentTime(e);this.logger_("Stopped at "+e+" while inside a buffered region "+"["+i.start(0)+" -> "+i.end(0)+"]. Attempting to resume "+"playback by seeking to the current time.");this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}};t.techWaiting_=function(){var e=this.seekable();var t=this.tech_.currentTime();if(this.tech_.seeking()||null!==this.timer_)return true;if(this.beforeSeekableWindow_(e,t)){var i=e.end(e.length-1);this.logger_("Fell out of live window at time "+t+". Seeking to "+"live point (seekable end) "+i);this.cancelTimer_();this.tech_.setCurrentTime(i);this.tech_.trigger({type:"usage",name:"vhs-live-resync"});this.tech_.trigger({type:"usage",name:"hls-live-resync"});return true}var r=this.tech_.vhs.masterPlaylistController_.sourceUpdater_;var n=this.tech_.buffered();var a=this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:t});if(a){this.cancelTimer_();this.tech_.setCurrentTime(t);this.tech_.trigger({type:"usage",name:"vhs-video-underflow"});this.tech_.trigger({type:"usage",name:"hls-video-underflow"});return true}var s=qa(n,t);if(s.length>0){var o=s.start(0)-t;this.logger_("Stopped at "+t+", setting timer for "+o+", seeking "+"to "+s.start(0));this.cancelTimer_();this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*o,t);return true}return false};t.afterSeekableWindow_=function(e,t,i,r){if(void 0===r)r=false;if(!e.length)return false;var n=e.end(e.length-1)+Fa;var a=!i.endList;if(a&&r)n=e.end(e.length-1)+3*i.targetDuration;if(t>n)return true;return false};t.beforeSeekableWindow_=function(e,t){if(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)return true;return false};t.videoUnderflow_=function(e){var t=e.videoBuffered,i=e.audioBuffered,r=e.currentTime;if(!t)return;var n;if(t.length&&i.length){var a=Ha(t,r-3);var s=Ha(t,r);var o=Ha(i,r);if(o.length&&!s.length&&a.length)n={start:a.end(0),end:o.end(0)}}else{var u=qa(t,r);if(!u.length)n=this.gapFromVideoUnderflow_(t,r)}if(n){this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". "+"Seeking to current time "+r);return true}return false};t.skipTheGap_=function(e){var t=this.tech_.buffered();var i=this.tech_.currentTime();var r=qa(t,i);this.cancelTimer_();if(0===r.length||i!==e)return;this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",r.start(0));this.tech_.setCurrentTime(r.start(0)+Na);this.tech_.trigger({type:"usage",name:"vhs-gap-skip"});this.tech_.trigger({type:"usage",name:"hls-gap-skip"})};t.gapFromVideoUnderflow_=function(e,t){var i=Va(e);for(var r=0;r<i.length;r++){var n=i.start(r);var a=i.end(r);if(t-n<4&&t-n>2)return{start:n,end:a}}return null};return e}();var $l={errorInterval:30,getSource:function(e){var t=this.tech({IWillNotUseThisInPlugins:true});var i=t.currentSource_||this.currentSource();return e(i)}};var Jl=function e(t,i){var r=0;var n=0;var a=Oa.mergeOptions($l,i);t.ready((function(){t.trigger({type:"usage",name:"vhs-error-reload-initialized"});t.trigger({type:"usage",name:"hls-error-reload-initialized"})}));var s=function(){if(n)t.currentTime(n)};var o=function(e){if(null===e||void 0===e)return;n=t.duration()!==1/0&&t.currentTime()||0;t.one("loadedmetadata",s);t.src(e);t.trigger({type:"usage",name:"vhs-error-reload"});t.trigger({type:"usage",name:"hls-error-reload"});t.play()};var u=function(){if(Date.now()-r<1e3*a.errorInterval){t.trigger({type:"usage",name:"vhs-error-reload-canceled"});t.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!a.getSource||"function"!==typeof a.getSource){Oa.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}r=Date.now();return a.getSource.call(t,o)};var l=function e(){t.off("loadedmetadata",s);t.off("error",u);t.off("dispose",e)};var d=function(i){l();e(t,i)};t.on("error",u);t.on("dispose",l);t.reloadSourceOnError=d};var ed=function(e){Jl(this,e)};var td="2.14.2";var id="6.0.1";var rd="0.21.1";var nd="4.7.1";var ad="3.1.3";var sd={PlaylistLoader:qs,Playlist:Ss,utils:no,STANDARD_PLAYLIST_SELECTOR:Eu,INITIAL_PLAYLIST_SELECTOR:xu,lastBandwidthSelector:Eu,movingAverageBandwidthSelector:wu,comparePlaylistBandwidth:Su,comparePlaylistResolution:ku,xhr:Gs()};Object.keys(wo).forEach((function(e){Object.defineProperty(sd,e,{get:function(){Oa.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing");return wo[e]},set:function(t){Oa.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing");if("number"!==typeof t||t<0){Oa.log.warn("value of Vhs."+e+" must be greater than or equal to 0");return}wo[e]=t}})}));var od="videojs-vhs";var ud=function(e,t){var i=t.media();var r=-1;for(var n=0;n<e.length;n++)if(e[n].id===i.id){r=n;break}e.selectedIndex_=r;e.trigger({selectedIndex:r,type:"change"})};var ld=function(e,t){t.representations().forEach((function(t){e.addQualityLevel(t)}));ud(e,t.playlists)};sd.canPlaySource=function(){return Oa.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var dd=function(e,t,i){if(!e)return e;var r={};if(t&&t.attributes&&t.attributes.CODECS)r=mu((0,S.kS)(t.attributes.CODECS));if(i&&i.attributes&&i.attributes.CODECS)r.audio=i.attributes.CODECS;var n=(0,S._5)(r.video);var a=(0,S._5)(r.audio);var s={};for(var o in e){s[o]={};if(a)s[o].audioContentType=a;if(n)s[o].videoContentType=n;if(t.contentProtection&&t.contentProtection[o]&&t.contentProtection[o].pssh)s[o].pssh=t.contentProtection[o].pssh;if("string"===typeof e[o])s[o].url=e[o]}return Oa.mergeOptions(e,s)};var cd=function(e,t){return e.reduce((function(e,i){if(!i.contentProtection)return e;var r=t.reduce((function(e,t){var r=i.contentProtection[t];if(r&&r.pssh)e[t]={pssh:r.pssh};return e}),{});if(Object.keys(r).length)e.push(r);return e}),[])};var hd=function(e){var t=e.player,i=e.sourceKeySystems,r=e.audioMedia,n=e.mainPlaylists;if(!t.eme.initializeMediaKeys)return Promise.resolve();var a=r?n.concat([r]):n;var s=cd(a,Object.keys(i));var o=[];var u=[];s.forEach((function(e){u.push(new Promise((function(e,i){t.tech_.one("keysessioncreated",e)})));o.push(new Promise((function(i,r){t.eme.initializeMediaKeys({keySystems:e},(function(e){if(e){r(e);return}i()}))})))}));return Promise.race([Promise.all(o),Promise.race(u)])};var fd=function(e){var t=e.player,i=e.sourceKeySystems,r=e.media,n=e.audioMedia;var a=dd(i,r,n);if(!a)return false;t.currentSource().keySystems=a;if(a&&!t.eme){Oa.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin");return false}return true};var pd=function(){if(!n().localStorage)return null;var e=n().localStorage.getItem(od);if(!e)return null;try{return JSON.parse(e)}catch(t){return null}};var md=function(e){if(!n().localStorage)return false;var t=pd();t=t?Oa.mergeOptions(t,e):e;try{n().localStorage.setItem(od,JSON.stringify(t))}catch(i){return false}return t};var vd=function(e){if(0===e.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,"))return JSON.parse(e.substring(e.indexOf(",")+1));return e};sd.supportsNativeHls=function(){if(!s()||!s().createElement)return false;var e=s().createElement("video");if(!Oa.getTech("Html5").isSupported())return false;var t=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return t.some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}();sd.supportsNativeDash=function(){if(!s()||!s().createElement||!Oa.getTech("Html5").isSupported())return false;return/maybe|probably/i.test(s().createElement("video").canPlayType("application/dash+xml"))}();sd.supportsTypeNatively=function(e){if("hls"===e)return sd.supportsNativeHls;if("dash"===e)return sd.supportsNativeDash;return false};sd.isSupported=function(){return Oa.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var gd=Oa.getComponent("Component");var _d=function(e){(0,c.Z)(t,e);function t(t,i,r){var n;n=e.call(this,i,Oa.mergeOptions(r.hls,r.vhs))||this;if(r.hls&&Object.keys(r.hls).length)Oa.log.warn("Using hls options is deprecated. Please rename `hls` to `vhs` in your options object.");if("number"===typeof r.initialBandwidth)n.options_.bandwidth=r.initialBandwidth;n.logger_=Ba("VhsHandler");if(i.options_&&i.options_.playerId){var a=Oa(i.options_.playerId);if(!a.hasOwnProperty("hls"))Object.defineProperty(a,"hls",{get:function(){Oa.log.warn("player.hls is deprecated. Use player.tech().vhs instead.");i.trigger({type:"usage",name:"hls-player-access"});return(0,d.Z)(n)},configurable:true});if(!a.hasOwnProperty("vhs"))Object.defineProperty(a,"vhs",{get:function(){Oa.log.warn("player.vhs is deprecated. Use player.tech().vhs instead.");i.trigger({type:"usage",name:"vhs-player-access"});return(0,d.Z)(n)},configurable:true});if(!a.hasOwnProperty("dash"))Object.defineProperty(a,"dash",{get:function(){Oa.log.warn("player.dash is deprecated. Use player.tech().vhs instead.");return(0,d.Z)(n)},configurable:true});n.player_=a}n.tech_=i;n.source_=t;n.stats={};n.ignoreNextSeekingEvent_=false;n.setOptions_();if(n.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks){i.overrideNativeAudioTracks(true);i.overrideNativeVideoTracks(true)}else if(n.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. "+"See https://git.io/vMpjB");n.on(s(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var t=s().fullscreenElement||s().webkitFullscreenElement||s().mozFullScreenElement||s().msFullscreenElement;if(t&&t.contains(n.tech_.el()))n.masterPlaylistController_.fastQualityChange_();else n.masterPlaylistController_.checkABR_()}));n.on(n.tech_,"seeking",(function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=false;return}this.setCurrentTime(this.tech_.currentTime())}));n.on(n.tech_,"error",(function(){if(this.tech_.error()&&this.masterPlaylistController_)this.masterPlaylistController_.pauseLoading()}));n.on(n.tech_,"play",n.play);return n}var i=t.prototype;i.setOptions_=function(){var e=this;this.options_.withCredentials=this.options_.withCredentials||false;this.options_.handleManifestRedirects=false===this.options_.handleManifestRedirects?false:true;this.options_.limitRenditionByPlayerDimensions=false===this.options_.limitRenditionByPlayerDimensions?false:true;this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||false;this.options_.smoothQualityChange=this.options_.smoothQualityChange||false;this.options_.useBandwidthFromLocalStorage="undefined"!==typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||false;this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||false;this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||false;this.options_.customTagParsers=this.options_.customTagParsers||[];this.options_.customTagMappers=this.options_.customTagMappers||[];this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||false;if("number"!==typeof this.options_.blacklistDuration)this.options_.blacklistDuration=5*60;if("number"!==typeof this.options_.bandwidth)if(this.options_.useBandwidthFromLocalStorage){var t=pd();if(t&&t.bandwidth){this.options_.bandwidth=t.bandwidth;this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"});this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})}if(t&&t.throughput){this.options_.throughput=t.throughput;this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"});this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"})}}if("number"!==typeof this.options_.bandwidth)this.options_.bandwidth=wo.INITIAL_BANDWIDTH;this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===wo.INITIAL_BANDWIDTH;["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS","useNetworkInformationApi","useDtsForTimestampOffset","experimentalExactManifestTimings","experimentalLeastPixelDiffSelector"].forEach((function(t){if("undefined"!==typeof e.source_[t])e.options_[t]=e.source_[t]}));this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions;this.useDevicePixelRatio=this.options_.useDevicePixelRatio};i.src=function(e,t){var i=this;if(!e)return;this.setOptions_();this.options_.src=vd(this.source_.src);this.options_.tech=this.tech_;this.options_.externVhs=sd;this.options_.sourceType=(0,k.t)(t);this.options_.seekTo=function(e){i.tech_.setCurrentTime(e)};if(this.options_.smoothQualityChange)Oa.log.warn("smoothQualityChange is deprecated and will be removed in the next major version");this.masterPlaylistController_=new Gl(this.options_);var r=Oa.mergeOptions({liveRangeSafeTimeDelta:Fa},this.options_,{seekable:function(){return i.seekable()},media:function(){return i.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new Yl(r);this.masterPlaylistController_.on("error",(function(){var e=Oa.players[i.tech_.options_.playerId];var t=i.masterPlaylistController_.error;if("object"===typeof t&&!t.code)t.code=3;else if("string"===typeof t)t={message:t,code:3};e.error(t)}));var a=this.options_.experimentalBufferBasedABR?sd.movingAverageBandwidthSelector(.55):sd.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):a.bind(this);this.masterPlaylistController_.selectInitialPlaylist=sd.INITIAL_PLAYLIST_SELECTOR.bind(this);this.playlists=this.masterPlaylistController_.masterPlaylistLoader_;this.mediaSource=this.masterPlaylistController_.mediaSource;Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e;this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){var e=this.masterPlaylistController_.mainSegmentLoader_.bandwidth;var t=n().navigator.connection||n().navigator.mozConnection||n().navigator.webkitConnection;var i=1e7;if(this.options_.useNetworkInformationApi&&t){var r=1e3*t.downlink*1e3;if(r>=i&&e>=i)e=Math.max(e,r);else e=r}return e},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e;this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1);var t;if(this.throughput>0)t=1/this.throughput;else t=0;var i=Math.floor(1/(e+t));return i},set:function(){Oa.log.error('The "systemBandwidth" property is read-only')}}});if(this.options_.bandwidth)this.bandwidth=this.options_.bandwidth;if(this.options_.throughput)this.throughput=this.options_.throughput;Object.defineProperties(this.stats,{bandwidth:{get:function(){return i.bandwidth||0},enumerable:true},mediaRequests:{get:function(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:true},mediaRequestsAborted:{get:function(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:true},mediaRequestsTimedout:{get:function(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:true},mediaRequestsErrored:{get:function(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:true},mediaTransferDuration:{get:function(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:true},mediaBytesTransferred:{get:function(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:true},mediaSecondsLoaded:{get:function(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:true},mediaAppends:{get:function(){return i.masterPlaylistController_.mediaAppends_()||0},enumerable:true},mainAppendsToLoadedData:{get:function(){return i.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:true},audioAppendsToLoadedData:{get:function(){return i.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:true},appendsToLoadedData:{get:function(){return i.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:true},timeToLoadedData:{get:function(){return i.masterPlaylistController_.timeToLoadedData_()||0},enumerable:true},buffered:{get:function(){return Ka(i.tech_.buffered())},enumerable:true},currentTime:{get:function(){return i.tech_.currentTime()},enumerable:true},currentSource:{get:function(){return i.tech_.currentSource_},enumerable:true},currentTech:{get:function(){return i.tech_.name_},enumerable:true},duration:{get:function(){return i.tech_.duration()},enumerable:true},master:{get:function(){return i.playlists.master},enumerable:true},playerDimensions:{get:function(){return i.tech_.currentDimensions()},enumerable:true},seekable:{get:function(){return Ka(i.tech_.seekable())},enumerable:true},timestamp:{get:function(){return Date.now()},enumerable:true},videoPlaybackQuality:{get:function(){return i.tech_.getVideoPlaybackQuality()},enumerable:true}});this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));this.tech_.on("bandwidthupdate",(function(){if(i.options_.useBandwidthFromLocalStorage)md({bandwidth:i.bandwidth,throughput:Math.round(i.throughput)})}));this.masterPlaylistController_.on("selectedinitialmedia",(function(){Ql(i)}));this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",(function(){i.setupEme_()}));this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")}));this.on(this.masterPlaylistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=true}));this.setupQualityLevels_();if(!this.tech_.el())return;this.mediaSourceUrl_=n().URL.createObjectURL(this.masterPlaylistController_.mediaSource);this.tech_.src(this.mediaSourceUrl_)};i.createKeySessions_=function(){var e=this;var t=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation");hd({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:t&&t.media(),mainPlaylists:this.playlists.master.playlists}).then((function(){e.logger_("created EME key session");e.masterPlaylistController_.sourceUpdater_.initializedEme()}))["catch"]((function(t){e.logger_("error while creating EME key session",t);e.player_.error({message:"Failed to initialize media keys for EME",code:3})}))};i.handleWaitingForKey_=function(){this.logger_("waitingforkey fired, attempting to create any new key sessions");this.createKeySessions_()};i.setupEme_=function(){var e=this;var t=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;var i=fd({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:t&&t.media()});this.player_.tech_.on("keystatuschange",(function(t){if("output-restricted"===t.status)e.masterPlaylistController_.blacklistCurrentPlaylist({playlist:e.masterPlaylistController_.media(),message:"DRM keystatus changed to "+t.status+". Playlist will fail to play. Check for HDCP content.",blacklistDuration:1/0})}));this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this);this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_);if(11===Oa.browser.IE_VERSION||!i){this.masterPlaylistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()};i.setupQualityLevels_=function(){var e=this;var t=Oa.players[this.tech_.options_.playerId];if(!t||!t.qualityLevels||this.qualityLevels_)return;this.qualityLevels_=t.qualityLevels();this.masterPlaylistController_.on("selectedinitialmedia",(function(){ld(e.qualityLevels_,e)}));this.playlists.on("mediachange",(function(){ud(e.qualityLevels_,e.playlists)}))};t.version=function(){return{"@videojs/http-streaming":td,"mux.js":id,"mpd-parser":rd,"m3u8-parser":nd,"aes-decrypter":ad}};i.version=function(){return this.constructor.version()};i.canChangeType=function(){return pl.canChangeType()};i.play=function(){this.masterPlaylistController_.play()};i.setCurrentTime=function(e){this.masterPlaylistController_.setCurrentTime(e)};i.duration=function(){return this.masterPlaylistController_.duration()};i.seekable=function(){return this.masterPlaylistController_.seekable()};i.dispose=function(){if(this.playbackWatcher_)this.playbackWatcher_.dispose();if(this.masterPlaylistController_)this.masterPlaylistController_.dispose();if(this.qualityLevels_)this.qualityLevels_.dispose();if(this.player_){delete this.player_.vhs;delete this.player_.dash;delete this.player_.hls}if(this.tech_&&this.tech_.vhs)delete this.tech_.vhs;if(this.tech_)delete this.tech_.hls;if(this.mediaSourceUrl_&&n().URL.revokeObjectURL){n().URL.revokeObjectURL(this.mediaSourceUrl_);this.mediaSourceUrl_=null}if(this.tech_)this.tech_.off("waitingforkey",this.handleWaitingForKey_);e.prototype.dispose.call(this)};i.convertToProgramTime=function(e,t){return fo({playlist:this.masterPlaylistController_.media(),time:e,callback:t})};i.seekToProgramTime=function(e,t,i,r){if(void 0===i)i=true;if(void 0===r)r=2;return po({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:r,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})};return t}(gd);var yd={name:"videojs-http-streaming",VERSION:td,canHandleSource:function(e,t){if(void 0===t)t={};var i=Oa.mergeOptions(Oa.options,t);return yd.canPlayType(e.type,i)},handleSource:function(e,t,i){if(void 0===i)i={};var r=Oa.mergeOptions(Oa.options,i);t.vhs=new _d(e,t,r);if(!Oa.hasOwnProperty("hls"))Object.defineProperty(t,"hls",{get:function(){Oa.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead.");return t.vhs},configurable:true});t.vhs.xhr=Gs();t.vhs.src(e.src,e.type);return t.vhs},canPlayType:function(e,t){if(void 0===t)t={};var i=Oa.mergeOptions(Oa.options,t),r=i.vhs;r=void 0===r?{}:r;var n=r.overrideNative,a=void 0===n?!Oa.browser.IS_ANY_SAFARI:n,s=i.hls;s=void 0===s?{}:s;var o=s.overrideNative,u=void 0===o?false:o;var l=(0,k.t)(e);var d=l&&(!sd.supportsTypeNatively(l)||u||a);return d?"maybe":""}};var Td=function(){return(0,S.p7)("avc1.4d400d,mp4a.40.2")};if(Td())Oa.getTech("Html5").registerSourceHandler(yd,0);Oa.VhsHandler=_d;Object.defineProperty(Oa,"HlsHandler",{get:function(){Oa.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead.");return _d},configurable:true});Oa.VhsSourceHandler=yd;Object.defineProperty(Oa,"HlsSourceHandler",{get:function(){Oa.log.warn("videojs.HlsSourceHandler is deprecated. "+"Use videojs.VhsSourceHandler instead.");return yd},configurable:true});Oa.Vhs=sd;Object.defineProperty(Oa,"Hls",{get:function(){Oa.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead.");return sd},configurable:true});if(!Oa.use){Oa.registerComponent("Hls",sd);Oa.registerComponent("Vhs",sd)}Oa.options.vhs=Oa.options.vhs||{};Oa.options.hls=Oa.options.hls||{};if(!Oa.getPlugin||!Oa.getPlugin("reloadSourceOnError")){var bd=Oa.registerPlugin||Oa.plugin;bd("reloadSourceOnError",ed)}const Sd=Oa}}]);